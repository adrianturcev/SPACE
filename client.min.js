(()=>{var Qr=Object.create;var $e=Object.defineProperty;var jr=Object.getOwnPropertyDescriptor;var en=Object.getOwnPropertyNames;var tn=Object.getPrototypeOf,rn=Object.prototype.hasOwnProperty;var nn=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+i+'" is not supported')});var ln=(i,e)=>()=>(i&&(e=i(i=0)),e);var se=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),an=(i,e)=>{for(var n in e)$e(i,n,{get:e[n],enumerable:!0})},Mt=(i,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of en(e))!rn.call(i,r)&&r!==n&&$e(i,r,{get:()=>e[r],enumerable:!(t=jr(e,r))||t.enumerable});return i};var sn=(i,e,n)=>(n=i!=null?Qr(tn(i)):{},Mt(e||!i||!i.__esModule?$e(n,"default",{value:i,enumerable:!0}):n,i)),on=i=>Mt($e({},"__esModule",{value:!0}),i);var Ut=se((Bn,Pt)=>{Pt.exports={nil(i){return i===null||typeof i>"u"},hack(i,e,n){return i.slice(e,n+1)},pick(i,e){return i.filter(e)},prune(i,e){return i.filter(function(n){return!e(n)})},check(i,e){return i.every(e)},escape(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},html(i){let e=i[0],n=Math.max(i.length,arguments.length-1);for(let t=1;t<i.length;t++)e+=arguments[t],e+=i[t];return e},addDataState(i,e){let n=[];i.dataset.state&&i.dataset.state.indexOf(" ")>-1?n=i.dataset.state.split(" "):n=[i.dataset.state],n.indexOf(e)===-1&&(n.push(e),i.dataset.state=n.join(" "))},removeDataState(i,e){let n=[];i.dataset.state&&i.dataset.state.indexOf(" ")>-1?n=i.dataset.state.split(" "):n=[i.dataset.state],i.dataset.state=n.filter(t=>t!==e).join(" ")},replaceDataState(i,e,n){this.removeDataState(i,e),this.addDataState(i,n)},toggleDataState(i,e){i.dataset.state.split(" ").indexOf(e)==-1?this.addDataState(i,e):this.removeDataState(i,e)},ajaxGet(i,e,n,t){var r=new XMLHttpRequest;r.open("GET",i),r.addEventListener("load",function(){if(r.status>=200&&r.status<400)if(n){var s={};try{s=JSON.parse(r.responseText)}catch{console.error("Get request returned invalid JSON.")}t===void 0?e(s):e.apply(t,[s])}else t===void 0?e(r.responseText):e.apply(t,[r.responseText]);else console.error(r.status+" "+r.statusText+" "+i)}),r.addEventListener("error",function(){console.error("Network error trying to access: "+i)}),r.send(null)},ajaxPost(i,e,n,t,r,s,a){var f=new XMLHttpRequest;f.open("POST",i),f.addEventListener("load",function(){f.status>=200&&f.status<400?s===void 0?n(f):n.apply(s,[f]):(a===void 0?t(f):t.apply(a,[f]),console.error(f.status+" "+f.statusText+" "+i))}),f.addEventListener("error",function(){console.error("Network error trying to access: "+i)}),r&&(f.setRequestHeader("Content-Type","application/json"),e=JSON.stringify(e)),f.send(e)}}});var pr={};an(pr,{__addDisposableResource:()=>ur,__assign:()=>He,__asyncDelegator:()=>rr,__asyncGenerator:()=>tr,__asyncValues:()=>nr,__await:()=>ye,__awaiter:()=>Kt,__classPrivateFieldGet:()=>sr,__classPrivateFieldIn:()=>fr,__classPrivateFieldSet:()=>or,__createBinding:()=>Pe,__decorate:()=>Jt,__disposeResources:()=>cr,__esDecorate:()=>Gt,__exportStar:()=>Zt,__extends:()=>Ft,__generator:()=>Xt,__importDefault:()=>ar,__importStar:()=>lr,__makeTemplateObject:()=>ir,__metadata:()=>Yt,__param:()=>zt,__propKey:()=>Wt,__read:()=>tt,__rest:()=>Bt,__rewriteRelativeImportExtension:()=>dr,__runInitializers:()=>Vt,__setFunctionName:()=>qt,__spread:()=>Qt,__spreadArray:()=>er,__spreadArrays:()=>jt,__values:()=>Me,default:()=>cn});function Ft(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");je(i,e);function n(){this.constructor=i}i.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Bt(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n}function Jt(i,e,n,t){var r=arguments.length,s=r<3?e:t===null?t=Object.getOwnPropertyDescriptor(e,n):t,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,e,n,t);else for(var f=i.length-1;f>=0;f--)(a=i[f])&&(s=(r<3?a(s):r>3?a(e,n,s):a(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function zt(i,e){return function(n,t){e(n,t,i)}}function Gt(i,e,n,t,r,s){function a(A){if(A!==void 0&&typeof A!="function")throw new TypeError("Function expected");return A}for(var f=t.kind,c=f==="getter"?"get":f==="setter"?"set":"value",u=!e&&i?t.static?i:i.prototype:null,g=e||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),l,h=!1,p=n.length-1;p>=0;p--){var y={};for(var d in t)y[d]=d==="access"?{}:t[d];for(var d in t.access)y.access[d]=t.access[d];y.addInitializer=function(A){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(A||null))};var w=(0,n[p])(f==="accessor"?{get:g.get,set:g.set}:g[c],y);if(f==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(l=a(w.get))&&(g.get=l),(l=a(w.set))&&(g.set=l),(l=a(w.init))&&r.unshift(l)}else(l=a(w))&&(f==="field"?r.unshift(l):g[c]=l)}u&&Object.defineProperty(u,t.name,g),h=!0}function Vt(i,e,n){for(var t=arguments.length>2,r=0;r<e.length;r++)n=t?e[r].call(i,n):e[r].call(i);return t?n:void 0}function Wt(i){return typeof i=="symbol"?i:"".concat(i)}function qt(i,e,n){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(i,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function Yt(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Kt(i,e,n,t){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function f(g){try{u(t.next(g))}catch(l){a(l)}}function c(g){try{u(t.throw(g))}catch(l){a(l)}}function u(g){g.done?s(g.value):r(g.value).then(f,c)}u((t=t.apply(i,e||[])).next())})}function Xt(i,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},t,r,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=f(0),a.throw=f(1),a.return=f(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function f(u){return function(g){return c([u,g])}}function c(u){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(n=0)),n;)try{if(t=1,r&&(s=u[0]&2?r.return:u[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,u[1])).done)return s;switch(r=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,r=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(i,n)}catch(g){u=[6,g],r=0}finally{t=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Zt(i,e){for(var n in i)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Pe(e,i,n)}function Me(i){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&i[e],t=0;if(n)return n.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&t>=i.length&&(i=void 0),{value:i&&i[t++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tt(i,e){var n=typeof Symbol=="function"&&i[Symbol.iterator];if(!n)return i;var t=n.call(i),r,s=[],a;try{for(;(e===void 0||e-- >0)&&!(r=t.next()).done;)s.push(r.value)}catch(f){a={error:f}}finally{try{r&&!r.done&&(n=t.return)&&n.call(t)}finally{if(a)throw a.error}}return s}function Qt(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(tt(arguments[e]));return i}function jt(){for(var i=0,e=0,n=arguments.length;e<n;e++)i+=arguments[e].length;for(var t=Array(i),r=0,e=0;e<n;e++)for(var s=arguments[e],a=0,f=s.length;a<f;a++,r++)t[r]=s[a];return t}function er(i,e,n){if(n||arguments.length===2)for(var t=0,r=e.length,s;t<r;t++)(s||!(t in e))&&(s||(s=Array.prototype.slice.call(e,0,t)),s[t]=e[t]);return i.concat(s||Array.prototype.slice.call(e))}function ye(i){return this instanceof ye?(this.v=i,this):new ye(i)}function tr(i,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=n.apply(i,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(p){return function(y){return Promise.resolve(y).then(p,l)}}function f(p,y){t[p]&&(r[p]=function(d){return new Promise(function(w,A){s.push([p,d,w,A])>1||c(p,d)})},y&&(r[p]=y(r[p])))}function c(p,y){try{u(t[p](y))}catch(d){h(s[0][3],d)}}function u(p){p.value instanceof ye?Promise.resolve(p.value.v).then(g,l):h(s[0][2],p)}function g(p){c("next",p)}function l(p){c("throw",p)}function h(p,y){p(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function rr(i){var e,n;return e={},t("next"),t("throw",function(r){throw r}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(r,s){e[r]=i[r]?function(a){return(n=!n)?{value:ye(i[r](a)),done:!1}:s?s(a):a}:s}}function nr(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],n;return e?e.call(i):(i=typeof Me=="function"?Me(i):i[Symbol.iterator](),n={},t("next"),t("throw"),t("return"),n[Symbol.asyncIterator]=function(){return this},n);function t(s){n[s]=i[s]&&function(a){return new Promise(function(f,c){a=i[s](a),r(f,c,a.done,a.value)})}}function r(s,a,f,c){Promise.resolve(c).then(function(u){s({value:u,done:f})},a)}}function ir(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function lr(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var n=et(i),t=0;t<n.length;t++)n[t]!=="default"&&Pe(e,i,n[t]);return fn(e,i),e}function ar(i){return i&&i.__esModule?i:{default:i}}function sr(i,e,n,t){if(n==="a"&&!t)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!t:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?t:n==="a"?t.call(i):t?t.value:e.get(i)}function or(i,e,n,t,r){if(t==="m")throw new TypeError("Private method is not writable");if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!r:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t==="a"?r.call(i,n):r?r.value=n:e.set(i,n),n}function fr(i,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof i=="function"?e===i:i.has(e)}function ur(i,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var t,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=e[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=e[Symbol.dispose],n&&(r=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");r&&(t=function(){try{r.call(this)}catch(s){return Promise.reject(s)}}),i.stack.push({value:e,dispose:t,async:n})}else n&&i.stack.push({async:!0});return e}function cr(i){function e(s){i.error=i.hasError?new un(s,i.error,"An error was suppressed during disposal."):s,i.hasError=!0}var n,t=0;function r(){for(;n=i.stack.pop();)try{if(!n.async&&t===1)return t=0,i.stack.push(n),Promise.resolve().then(r);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return t|=2,Promise.resolve(s).then(r,function(a){return e(a),r()})}else t|=1}catch(a){e(a)}if(t===1)return i.hasError?Promise.reject(i.error):Promise.resolve();if(i.hasError)throw i.error}return r()}function dr(i,e){return typeof i=="string"&&/^\.\.?\//.test(i)?i.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,t,r,s,a){return t?e?".jsx":".js":r&&(!s||!a)?n:r+s+"."+a.toLowerCase()+"js"}):i}var je,He,Pe,fn,et,un,cn,hr=ln(()=>{je=function(i,e){return je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])},je(i,e)};He=function(){return He=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},He.apply(this,arguments)};Pe=Object.create?function(i,e,n,t){t===void 0&&(t=n);var r=Object.getOwnPropertyDescriptor(e,n);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(i,t,r)}:function(i,e,n,t){t===void 0&&(t=n),i[t]=e[n]};fn=Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e},et=function(i){return et=Object.getOwnPropertyNames||function(e){var n=[];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[n.length]=t);return n},et(i)};un=typeof SuppressedError=="function"?SuppressedError:function(i,e,n){var t=new Error(n);return t.name="SuppressedError",t.error=i,t.suppressed=e,t};cn={__extends:Ft,__assign:He,__rest:Bt,__decorate:Jt,__param:zt,__esDecorate:Gt,__runInitializers:Vt,__propKey:Wt,__setFunctionName:qt,__metadata:Yt,__awaiter:Kt,__generator:Xt,__createBinding:Pe,__exportStar:Zt,__values:Me,__read:tt,__spread:Qt,__spreadArrays:jt,__spreadArray:er,__await:ye,__asyncGenerator:tr,__asyncDelegator:rr,__asyncValues:nr,__makeTemplateObject:ir,__importStar:lr,__importDefault:ar,__classPrivateFieldGet:sr,__classPrivateFieldSet:or,__classPrivateFieldIn:fr,__addDisposableResource:ur,__disposeResources:cr,__rewriteRelativeImportExtension:dr}});var mr=se(rt=>{(function(i){"use strict";var e=typeof process=="object"&&process.env?process.env:self;i.parser=function(m){return new l(m)},i.CParser=l,i.CStream=p,i.createStream=h,i.MAX_BUFFER_LENGTH=64*1024,i.DEBUG=e.CDEBUG==="debug",i.INFO=e.CDEBUG==="debug"||e.CDEBUG==="info",i.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var n={textNode:void 0,numberNode:""},t=i.EVENTS.filter(function(m){return m!=="error"&&m!=="end"}),r=0,s;i.STATE={BEGIN:r++,VALUE:r++,OPEN_OBJECT:r++,CLOSE_OBJECT:r++,OPEN_ARRAY:r++,CLOSE_ARRAY:r++,TEXT_ESCAPE:r++,STRING:r++,BACKSLASH:r++,END:r++,OPEN_KEY:r++,CLOSE_KEY:r++,TRUE:r++,TRUE2:r++,TRUE3:r++,FALSE:r++,FALSE2:r++,FALSE3:r++,FALSE4:r++,NULL:r++,NULL2:r++,NULL3:r++,NUMBER_DECIMAL_POINT:r++,NUMBER_DIGIT:r++};for(var a in i.STATE)i.STATE[i.STATE[a]]=a;r=i.STATE;let f={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(m){function o(){this.__proto__=m}return o.prototype=m,new o}),Object.getPrototypeOf||(Object.getPrototypeOf=function(m){return m.__proto__}),Object.keys||(Object.keys=function(m){var o=[];for(var L in m)m.hasOwnProperty(L)&&o.push(L);return o});function c(m){var o=Math.max(i.MAX_BUFFER_LENGTH,10),L=0;for(var S in n){var _=m[S]===void 0?0:m[S].length;if(_>o)switch(S){case"text":closeText(m);break;default:E(m,"Max buffer length exceeded: "+S)}L=Math.max(L,_)}m.bufferCheckPosition=i.MAX_BUFFER_LENGTH-L+m.position}function u(m){for(var o in n)m[o]=n[o]}var g=/[\\"\n]/g;function l(m){if(!(this instanceof l))return new l(m);var o=this;u(o),o.bufferCheckPosition=i.MAX_BUFFER_LENGTH,o.q=o.c=o.p="",o.opt=m||{},o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.state=r.BEGIN,o.stack=new Array,o.position=o.column=0,o.line=1,o.slashed=!1,o.unicodeI=0,o.unicodeS=null,o.depth=0,y(o,"onready")}l.prototype={end:function(){x(this)},write:T,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{s=nn("stream").Stream}catch{s=function(){}}function h(m){return new p(m)}function p(m){if(!(this instanceof p))return new p(m);this._parser=new l(m),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var o=this;s.apply(o),this._parser.onend=function(){o.emit("end")},this._parser.onerror=function(L){o.emit("error",L),o._parser.error=null},t.forEach(function(L){Object.defineProperty(o,"on"+L,{get:function(){return o._parser["on"+L]},set:function(S){if(!S)return o.removeAllListeners(L),o._parser["on"+L]=S,S;o.on(L,S)},enumerable:!0,configurable:!1})})}p.prototype=Object.create(s.prototype,{constructor:{value:p}}),p.prototype.write=function(m){m=new Buffer(m);for(var o=0;o<m.length;o++){var L=m[o];if(this.bytes_remaining>0){for(var S=0;S<this.bytes_remaining;S++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+S]=m[S];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,o=o+S-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&L>=128)if(L>=194&&L<=223&&(this.bytes_in_sequence=2),L>=224&&L<=239&&(this.bytes_in_sequence=3),L>=240&&L<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+o>m.length){for(var _=0;_<=m.length-1-o;_++)this.temp_buffs[this.bytes_in_sequence][_]=m[o+_];return this.bytes_remaining=o+this.bytes_in_sequence-m.length,!0}else{this.string=m.slice(o,o+this.bytes_in_sequence).toString(),o=o+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var D=o;D<m.length&&!(m[D]>=128);D++);this.string=m.slice(o,D).toString(),this._parser.write(this.string),this.emit("data",this.string),o=D-1}},p.prototype.end=function(m){return m&&m.length&&this._parser.write(m.toString()),this._parser.end(),!0},p.prototype.on=function(m,o){var L=this;return!L._parser["on"+m]&&t.indexOf(m)!==-1&&(L._parser["on"+m]=function(){var S=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);S.splice(0,0,m),L.emit.apply(L,S)}),s.prototype.on.call(L,m,o)},p.prototype.destroy=function(){u(this._parser),this.emit("close")};function y(m,o,L){i.INFO&&console.log("-- emit",o,L),m[o]&&m[o](L)}function d(m,o,L){w(m),y(m,o,L)}function w(m,o){m.textNode=N(m.opt,m.textNode),m.textNode!==void 0&&y(m,o||"onvalue",m.textNode),m.textNode=void 0}function A(m){m.numberNode&&y(m,"onvalue",parseFloat(m.numberNode)),m.numberNode=""}function N(m,o){return o===void 0||(m.trim&&(o=o.trim()),m.normalize&&(o=o.replace(/\s+/g," "))),o}function E(m,o){return w(m),o+=`
Line: `+m.line+`
Column: `+m.column+`
Char: `+m.c,o=new Error(o),m.error=o,y(m,"onerror",o),m}function x(m){return(m.state!==r.VALUE||m.depth!==0)&&E(m,"Unexpected end"),w(m),m.c="",m.closed=!0,y(m,"onend"),l.call(m,m.opt),m}function C(m){return m===f.carriageReturn||m===f.lineFeed||m===f.space||m===f.tab}function T(m){var o=this;if(this.error)throw this.error;if(o.closed)return E(o,"Cannot write after close. Assign an onready handler.");if(m===null)return x(o);var L=0,S=m.charCodeAt(0),_=o.p,D=!1;for(i.DEBUG&&console.log("write -> ["+m+"]");S&&(_=S,o.c=S=m.charCodeAt(L++),_!==S?o.p=_:_=o.p,!!S);)switch(i.DEBUG&&console.log(L,S,i.STATE[o.state]),D?D=!1:(o.position++,S===f.lineFeed?(o.line++,o.column=0):o.column++),o.state){case r.BEGIN:S===f.openBrace?o.state=r.OPEN_OBJECT:S===f.openBracket?o.state=r.OPEN_ARRAY:C(S)||E(o,"Non-whitespace before {[.");continue;case r.OPEN_KEY:case r.OPEN_OBJECT:if(C(S))continue;if(o.state===r.OPEN_KEY)o.stack.push(r.CLOSE_KEY);else if(S===f.closeBrace){y(o,"onopenobject"),this.depth++,y(o,"oncloseobject"),this.depth--,o.state=o.stack.pop()||r.VALUE;continue}else o.stack.push(r.CLOSE_OBJECT);S===f.doubleQuote?o.state=r.STRING:E(o,'Malformed object key should start with "');continue;case r.CLOSE_KEY:case r.CLOSE_OBJECT:if(C(S))continue;var k=o.state===r.CLOSE_KEY?"key":"object";S===f.colon?(o.state===r.CLOSE_OBJECT?(o.stack.push(r.CLOSE_OBJECT),w(o,"onopenobject"),this.depth++):w(o,"onkey"),o.state=r.VALUE):S===f.closeBrace?(d(o,"oncloseobject"),this.depth--,o.state=o.stack.pop()||r.VALUE):S===f.comma?(o.state===r.CLOSE_OBJECT&&o.stack.push(r.CLOSE_OBJECT),w(o),o.state=r.OPEN_KEY):E(o,"Bad object");continue;case r.OPEN_ARRAY:case r.VALUE:if(C(S))continue;if(o.state===r.OPEN_ARRAY)if(y(o,"onopenarray"),this.depth++,o.state=r.VALUE,S===f.closeBracket){y(o,"onclosearray"),this.depth--,o.state=o.stack.pop()||r.VALUE;continue}else o.stack.push(r.CLOSE_ARRAY);S===f.doubleQuote?o.state=r.STRING:S===f.openBrace?o.state=r.OPEN_OBJECT:S===f.openBracket?o.state=r.OPEN_ARRAY:S===f.t?o.state=r.TRUE:S===f.f?o.state=r.FALSE:S===f.n?o.state=r.NULL:S===f.minus?o.numberNode+="-":f._0<=S&&S<=f._9?(o.numberNode+=String.fromCharCode(S),o.state=r.NUMBER_DIGIT):E(o,"Bad value");continue;case r.CLOSE_ARRAY:if(S===f.comma)o.stack.push(r.CLOSE_ARRAY),w(o,"onvalue"),o.state=r.VALUE;else if(S===f.closeBracket)d(o,"onclosearray"),this.depth--,o.state=o.stack.pop()||r.VALUE;else{if(C(S))continue;E(o,"Bad array")}continue;case r.STRING:o.textNode===void 0&&(o.textNode="");var I=L-1,$=o.slashed,M=o.unicodeI;e:for(;;){for(i.DEBUG&&console.log(L,S,i.STATE[o.state],$);M>0;)if(o.unicodeS+=String.fromCharCode(S),S=m.charCodeAt(L++),o.position++,M===4?(o.textNode+=String.fromCharCode(parseInt(o.unicodeS,16)),M=0,I=L-1):M++,!S)break e;if(S===f.doubleQuote&&!$){o.state=o.stack.pop()||r.VALUE,o.textNode+=m.substring(I,L-1),o.position+=L-1-I;break}if(S===f.backslash&&!$&&($=!0,o.textNode+=m.substring(I,L-1),o.position+=L-1-I,S=m.charCodeAt(L++),o.position++,!S))break;if($){if($=!1,S===f.n?o.textNode+=`
`:S===f.r?o.textNode+="\r":S===f.t?o.textNode+="	":S===f.f?o.textNode+="\f":S===f.b?o.textNode+="\b":S===f.u?(M=1,o.unicodeS=""):o.textNode+=String.fromCharCode(S),S=m.charCodeAt(L++),o.position++,I=L-1,S)continue;break}g.lastIndex=L;var U=g.exec(m);if(U===null){L=m.length+1,o.textNode+=m.substring(I,L-1),o.position+=L-1-I;break}if(L=U.index+1,S=m.charCodeAt(U.index),!S){o.textNode+=m.substring(I,L-1),o.position+=L-1-I;break}}o.slashed=$,o.unicodeI=M;continue;case r.TRUE:S===f.r?o.state=r.TRUE2:E(o,"Invalid true started with t"+S);continue;case r.TRUE2:S===f.u?o.state=r.TRUE3:E(o,"Invalid true started with tr"+S);continue;case r.TRUE3:S===f.e?(y(o,"onvalue",!0),o.state=o.stack.pop()||r.VALUE):E(o,"Invalid true started with tru"+S);continue;case r.FALSE:S===f.a?o.state=r.FALSE2:E(o,"Invalid false started with f"+S);continue;case r.FALSE2:S===f.l?o.state=r.FALSE3:E(o,"Invalid false started with fa"+S);continue;case r.FALSE3:S===f.s?o.state=r.FALSE4:E(o,"Invalid false started with fal"+S);continue;case r.FALSE4:S===f.e?(y(o,"onvalue",!1),o.state=o.stack.pop()||r.VALUE):E(o,"Invalid false started with fals"+S);continue;case r.NULL:S===f.u?o.state=r.NULL2:E(o,"Invalid null started with n"+S);continue;case r.NULL2:S===f.l?o.state=r.NULL3:E(o,"Invalid null started with nu"+S);continue;case r.NULL3:S===f.l?(y(o,"onvalue",null),o.state=o.stack.pop()||r.VALUE):E(o,"Invalid null started with nul"+S);continue;case r.NUMBER_DECIMAL_POINT:S===f.period?(o.numberNode+=".",o.state=r.NUMBER_DIGIT):E(o,"Leading zero not followed by .");continue;case r.NUMBER_DIGIT:f._0<=S&&S<=f._9?o.numberNode+=String.fromCharCode(S):S===f.period?(o.numberNode.indexOf(".")!==-1&&E(o,"Invalid number has two dots"),o.numberNode+="."):S===f.e||S===f.E?((o.numberNode.indexOf("e")!==-1||o.numberNode.indexOf("E")!==-1)&&E(o,"Invalid number has two exponential"),o.numberNode+="e"):S===f.plus||S===f.minus?(_===f.e||_===f.E||E(o,"Invalid symbol in number"),o.numberNode+=String.fromCharCode(S)):(A(o),L--,D=!0,o.state=o.stack.pop()||r.VALUE);continue;default:E(o,"Unknown state: "+o.state)}return o.position>=o.bufferCheckPosition&&c(o),o}})(typeof rt>"u"?clarinet={}:rt)});var yr=se(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.stringify=xe.parse=void 0;var dn=(hr(),on(pr)),pn=dn.__importDefault(mr());function hn(i){let e=it(),n,t;function r(a){try{let f=e.next(a);f.done&&(n=f.value)}catch(f){t=f}}let s=pn.default.parser();if(s.onopenobject=a=>r({type:"openobject",key:a}),s.onopenarray=()=>r({type:"openarray"}),s.onkey=a=>r({type:"key",key:a}),s.onvalue=a=>r({type:"value",value:a}),s.oncloseobject=()=>r({type:"closeobject"}),s.onclosearray=()=>r({type:"closearray"}),s.onerror=a=>r({type:"error",err:a}),e.next(),s.write(i).close(),t)throw t;return n}xe.parse=hn;function nt(i){return Array.isArray(i)?`[${i.map(nt).join(",")}]`:i instanceof Map?`{${[...i].map(([e,n])=>JSON.stringify(e)+":"+nt(n)).join(",")}}`:JSON.stringify(i)}xe.stringify=nt;var gr=Symbol();function*it(){let i=yield;switch(i.type){case"value":return i.value;case"openobject":let e=new Map,n=i.key;for(n===void 0&&(yield);n!==void 0;)e.set(n,yield*it()),n=(yield).key;return e;case"openarray":let t=[],r;for(;;){if(r=yield*it(),r===gr)return t;t.push(r)}case"closearray":return gr;case"error":throw i.err;default:throw Error(`Unexpected ParseEvent ${i.type}`)}}});var Nr=se((Vn,Er)=>{var xr=yr().parse;Er.exports=class{constructor(e=!1){let n=this;if(this.indentation=4,[!0,!1,void 0].indexOf(e)==-1)throw new Error("@param {Boolean} pedantic");this.pedantic=e}template(e){let n=this;var t=e.raw[0];for(let s=1;s<e.raw.length;s++)typeof arguments[s]=="string"?t+='"'+arguments[s]+'"':t+=arguments[s],t+=e.raw[s];return n._treeToMap(n._damonToTree(t))}damonToMap(e){let n=this,t=n._damonToTree(e);return t===!0||t===!1||t===null||typeof t=="string"||typeof t=="number"?t:n._treeToMap(n._damonToTree(e))}damonToJSON(e){let n=this;return n.mapToJSON(n.damonToMap(e))}jsonToDamon(e){let n=this;return n.mapToDamon(n.jsonToMap(e),!1)}jsonToMap(e){var t=this._getLines(e,"JSON");if(t=t.filter(r=>!/^ *\/\//.test(r)),t=t.filter(r=>r!=""),t=t.filter(r=>!/^[ \t]+$/.test(r)),t.length==1){if(["true","false","null"].indexOf(t[0].trim())>-1)return JSON.parse(t[0]);if(/^".*"$/.test(t[0].trim()))try{return JSON.parse(t[0].trim())}catch(r){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),r.line=1,r.language="JSON",r.type="string",r}else if(isFinite(t[0])&&!isNaN(parseFloat(t[0]))&&Number.isFinite(t[0]*1)&&!Number.isNaN(t[0]*1)){if(t[0].indexOf(0)==0&&t[0].length>1&&t[0].indexOf(".")!==1){let r=new Error("Error line number 1: leading 0");throw r.line=1,r.language="DAMON",r}try{return JSON.parse(t[0]*1)}catch(r){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),r.line=1,r.language="JSON",r.type="number",r}}else if(t[0]*1===1/0)try{JSON.parse(t[0]*1)}catch(r){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),r.line=1,r.language="JSON",r.type="infinity",r}else return xr(e)}else return xr(e)}_getLines(e,n="DAMON"){if(["DAMON","JSON"].indexOf(n)==-1)throw new Error("Bad language argument, expected 'DAMON' or 'JSON'");if(e===""){let s=new Error("Error line 1: empty string");throw s.line=1,s.language=n,s}if(/[\s]/.test(e)&&e.match(new RegExp(/[\s]/))[0].length==e.length){let s=new Error("Error line 1: string only contains whitespace");throw s.line=1,s.language=n,s}var t=/\r\n/.test(e)?`\r
`:`
`,r=e.split(t);if(/\\*\n/.test(e)&&t==`
`){if(/[^\\]\\(\\\\)*\n/.test(e)){let f=e.split(/[^\\]\\(\\\\)*\n/)[0].split(`
`).length,c=new Error("Error line "+f+": oddly escaped newline");throw c.line=f,c.language=n,c}r=e.split("").reverse().join("").split(/\n/).map(f=>f.split("").reverse().join("")).reverse()}return r}_damonToTree(e){let n=this,t=n._getLines(e),r=t.slice(0);if(t=t.filter(d=>!/^ *\/\//.test(d)),t=t.filter(d=>d!=""),t=t.filter(d=>!/^[ \t]+$/.test(d)),t.length==1){if(["true","false","null"].indexOf(t[0].trim())>-1)return JSON.parse(t[0]);if(/^".*"$/.test(t[0].trim()))try{return JSON.parse(t[0].trim())}catch(d){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),d.line=1,d.language="JSON",d.type="string",d}else if(isFinite(t[0])&&!isNaN(parseFloat(t[0]))&&Number.isFinite(t[0]*1)&&!Number.isNaN(t[0]*1)){if(t[0].indexOf(0)==0&&t[0].length>1&&t[0].indexOf(".")!==1){let d=new Error("Error line number 1: leading 0");throw d.line=1,d.language="DAMON",d}try{return JSON.parse(t[0]*1)}catch(d){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),d.line=1,d.language="JSON",d.type="number",d}}else if(t[0]*1===1/0)try{JSON.parse(t[0]*1)}catch(d){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),d.line=1,d.language="JSON",d.type="infinity",d}}let s=0,a=[];for(let d=0,w=r.length;d<w;d++)t.slice(s).indexOf(r[d])>-1?a[d]=t.slice(s).indexOf(r[d]):a[d]=null;let f=new RegExp("^(\\t)+");for(let d=0,w=t.length;d<w;d++){if(f.test(t[d])){let A=t[d].match(f)[0].length;for(let N=0,E=A;N<E;N++)t[d]=t[d].replace("	"," ".repeat(n.indentation))}if(!/^ *- $/.test(t[d])&&/[ \t]+$/.test(t[d])){let A=new Error("Error line "+(a.indexOf(d)+1)+": trailing whitespace");throw A.line=a.indexOf(d)+1,A.language="DAMON",A}}let c=new RegExp("^("+" ".repeat(n.indentation)+")+");if(c.test(t[0])){let d=t[0].match(c)[0].length,w=!0;for(let A=0,N=t.length;A<N;A++)c.test(t[A])&&t[A].match(c)[0].length>=d?t[A]=t[A].slice(d):w=!1;if(!w){let A=new Error("Error line 1: bad formatting");throw A.line=1,A.language="DAMON",A}}else if(c.test(t[1])&&t[1].match(c)[0].length>n.indentation){let d=t[1].match(c)[0].length-n.indentation,w=!0;for(let A=1,N=t.length;A<N;A++)c.test(t[A])&&t[A].match(c)[0].length>=d?t[A]=t[A].slice(d):w=!1;if(!w){let A=new Error("Error line 2: bad formatting");throw A.line=2,A.language="DAMON",A}}let u=!1;if(t.length>1)for(let d=0,w=t.length;d<w;d++)d!==0&&/^- /.test(t[d])&&(u=!0);if(!/^- \{\}$/.test(t[0])&&!/^- \[\]$/.test(t[0])&&(u=!0),u){for(let d=0,w=t.length;d<w;d++)t[d]=" ".repeat(n.indentation)+t[d];t.unshift("- {}")}var g={content:t[0],level:0,id:0,children:[],headless:u,damonOriginalLinesMapping:a},l=g;if(!/^- /.test(t[0].trimStart())||/^ +/.test(t[0])&&(t[0].match(/^ +/)[0].length%n.indentation!=0||t[0].match(/^ +/)[0].length!=n.indentation)){let d=new Error("Error line "+(u*1+1)+": bad formatting");throw d.line=u*1+1,d.language="DAMON",d}t.shift();for(let d=0,w=t.length;d<w;d++){if(!/^- /.test(t[d].trimStart())||/^ +/.test(t[d])&&(t[d].match(/^ +/)[0].length%n.indentation!=0||d==0&&t[d].match(/^ +/)[0].length!=n.indentation||d!=0&&/^- /.test(t[d-1])&&t[d].match(/^ +/)[0].length!=n.indentation||d!=0&&!/^- /.test(t[d-1])&&t[d].match(/^ +/)[0].length>t[d-1].match(/^ +/)[0].length+n.indentation)){let N=new Error("Error line "+(a.indexOf(d)+1)+": bad formatting");throw N.line=a.indexOf(d)+1,N.language="DAMON",N}let A={content:t[d].trimStart().slice(2),level:1+t[d].match(/^ +/)[0].length/n.indentation,id:"",children:[]};if(l===g)A.id=g.children.length+1,g.children.push(A);else if(l.level===A.level){var h=n._findListItemCommonDirectParent(l,g);h.level==0?A.id=h.children.length+1:A.id=h.id+"-"+(h.children.length+1),h.children.push(A)}else if(l.level>A.level){var p=n._findListItemCommonAncestor(l,g,A.level);p.level==0?A.id=p.children.length+1:A.id=p.id+"-"+(p.children.length+1),p.children.push(A)}else if(l.level<A.level){var y=n._findListItemCommonDirectParent(l,g);let N=y.children.indexOf(l),E=y.children[N].id,x=y.children[N].children.length+1;A.id=E+"-"+x,y.children[N].children.push(A)}l=A}return g}_findListItemCommonDirectParent(e,n){let t=this;if(n.children.indexOf(e)>-1)return n;var r;for(let s=n.children.length-1,a=0;s>=a;s--)if(r=t._findListItemCommonDirectParent(e,n.children[s]),r)return r}_findListItemCommonAncestor(e,n,t){let r=this;var s=r._findListItemCommonDirectParent(e,n);return s.level<t?s:r._findListItemCommonAncestor(s,n,t)}_treeToMap(e){let n=this;var t=0;if(e.content=="- {}"){let f=new Map;return f.damonOriginalLinesMapping=e.damonOriginalLinesMapping,e.headless&&(f.headless=!0),r(e,f)}else if(e.content=="- []"){let f=[];return f.damonOriginalLinesMapping=e.damonOriginalLinesMapping,r(e,f)}function r(f,c){if(typeof f!="object"||f==null||Array.isArray(f)){let u=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,g=new Error("Error line number "+u+": @param { {} } tree");throw g.line=u,g.language="DAMON",g}if(typeof c=="object"&&c!==null&&!Array.isArray(c)&&c instanceof Map&&c.constructor===Map)s(f,c);else if(Array.isArray(c))a(f,c);else{let u=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,g=new Error("Error line number "+u+": @param { {} | [] } jsonMap");throw g.line=u,g.language="DAMON",g}return c}function s(f,c){for(let u=0,g=f.children.length;u<g;u++)if(t++,f.children[u].content.length==0){let l="";f.children[u].children.length>0?(l="implicit map key",c.set("",new Map),c.implicitMaps===void 0&&(c.implicitMaps=[]),c.implicitMaps.push(""),r(f.children[u],c.get(""))):(l="implicit null key",c.set("",null),c.implicitNulls===void 0&&(c.implicitNulls=[]),c.implicitNulls.push(""))}else{let l=f.children[u].content,h="key";try{if(/^.*: +\[/.test(l)&&l[l.length-1]=="]")if(/: +\[ *\]$/.test(l)){let p=JSON.parse(`["${l.slice(0,-1*l.match(/: +\[ *\]$/)[0].length)}"]`)[0];c.set(p,[]),f.children[u].children.length>0&&r(f.children[u],c.get(p))}else{let p=new RegExp(/: +\[/g),y=l.slice(0,-1).split(p),d=l.match(p).concat([""]),w=y.map((x,C)=>x+d[C]),A="",N=[];for(let x=0,C=y.length;x<C;x++)try{let T;if(x==0?T=y[0]:T=w.slice(0,x).join("")+y[x],A=JSON.parse(`["${T}"]`)[0],h="list",N=JSON.parse(`[${w.slice(x+1).join("")}]`),Array.isArray(N))break}catch{if(x==C-2){let m=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,o=new Error("Error line number "+m+": invalid inline list");throw o.line=m,o.language="DAMON",o}}if(N.every(function(x){return x===!0||x===!1||x===null||typeof x=="string"?!0:!!(isFinite(x)&&!isNaN(parseFloat(x))&&Number.isFinite(x*1)&&!Number.isNaN(x*1))}))c.set(A,N),c.damonInlineArrays===void 0&&(c.damonInlineArrays=[]),c.damonInlineArrays.push(A);else{let x=+(e.headless*-1)+e.damonOriginalLinesMapping.indexOf(t-1)+2,C=new Error("Error line number "+x+": no nesting in inline lists");throw C.line=x,C.language="DAMON",C}if(f.children[u].children.length>0){let x=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+3,C=new Error("Error line number "+x+": inline lists can't have children");throw C.line=x,C.language="DAMON",C}}else if(/: +\{ *\}$/.test(l)){let p=JSON.parse(`["${l.slice(0,-1*l.match(/: +\{ *\}$/)[0].length)}"]`)[0];c.set(p,new Map),r(f.children[u],c.get(p))}else{let p=!1;if(/^.*: /.test(l)&&l.split(new RegExp(/: +/))[l.split(new RegExp(/: +/)).length-1]==="true"){let y=l.match(new RegExp(/: +/g))[l.match(new RegExp(/: +/g)).length-1],d=JSON.parse(`["${l.slice(0,-1*y.length-4)}"]`)[0];c.set(d,!0)}else if(/^.*: /.test(l)&&l.split(new RegExp(/: +/))[l.split(new RegExp(/: +/)).length-1]==="false"){let y=l.match(new RegExp(/: +/g))[l.match(new RegExp(/: +/g)).length-1],d=JSON.parse(`["${l.slice(0,-1*y.length-5)}"]`)[0];c.set(d,!1)}else if(/^.*: /.test(l)&&l.split(new RegExp(/: +/))[l.split(new RegExp(/: +/)).length-1]==="null"){let y=l.match(new RegExp(/: +/g))[l.match(new RegExp(/: +/g)).length-1],d=JSON.parse(`["${l.slice(0,-1*y.length-4)}"]`)[0];c.set(d,null)}else if(/^.*: +"/.test(l)&&l[l.length-1]=='"'){let y=l.match(new RegExp(/: +"/g));if(y.length==1){let d=JSON.parse(`["${l.split(y[0])[0]}"]`)[0];h="string";let w=JSON.parse(`["${l.split(y[0]).slice(1).join("").slice(0,-1)}"]`)[0];c.set(d,w)}else if(y.length==2&&/: +"$/.test(l)){let d=JSON.parse(`["${l.split(y[0])[0]}"]`)[0];h="string";let w=JSON.parse(`["${l.split(y[0]).slice(1).join("")+": "}"]`)[0];c.set(d,w)}else{let d=+(e.headless*-1)+e.damonOriginalLinesMapping.indexOf(t-1)+2,w=new Error("Error line number "+d+": unescaped double quote");throw w.line=d,w.language="DAMON",w}}else if(/^.*: /.test(l)&&isFinite(l.split(": ")[l.split(": ").length-1])&&!isNaN(parseFloat(l.split(": ")[l.split(": ").length-1]))&&Number.isFinite(l.split(": ")[l.split(": ").length-1]*1)&&!Number.isNaN(l.split(": ")[l.split(": ").length-1]*1)){let y=JSON.parse(`["${l.split(": ").slice(0,-1).join(": ")}"]`)[0];h="number";let d=l.match(new RegExp(/: +/g)),w=d[d.length-1],A=l.split(w)[l.split(w).length-1];if(A.indexOf(0)==0&&A.length>1&&A.indexOf(".")!==1){let E=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,x=new Error("Error line number "+E+": leading 0");throw x.line=E,x.language="DAMON",x}let N=JSON.parse(`[${l.split(": ")[l.split(": ").length-1]*1}]`)[0];c.set(y,N)}else if(/^.*: /.test(l)&&l.split(new RegExp(/: +/))[l.split(new RegExp(/: +/)).length-1]*1===1/0){let y=JSON.parse(`["${l.split(": ").slice(0,-1).join(": ")}"]`)[0];h="infinity";let d=JSON.parse(`[${l.split(": ")[l.split(": ").length-1]*1}]`)}else{let y=!1,d=0;if(/\[ *\]$/.test(l)&&(y=!0,d=l.match(new RegExp(/\[ *\]$/g))[0].length),/\{ *\}$/.test(l)&&(y=!0,d=l.match(new RegExp(/\{ *\}$/g))[0].length),/true$/.test(l)&&(y=!0,d=4),/false$/.test(l)&&(y=!0,d=5),/null$/.test(l)&&(y=!0,d=4),/".*"$/.test(l)&&(y=!0,d=l.match(new RegExp(/".*"$/g))[0].length),!y){let w="";for(let A=l.length-1;A>-1&&(w=l[A].concat(w),isFinite(w)&&!isNaN(parseFloat(w))&&Number.isFinite(w*1)&&!Number.isNaN(w*1));A--){if(!/[ \t]/.test(l[A]))break;y=!0,d=w.length}}if(y)if(JSON.parse(`["${l.slice(0,-1*d)}"]`)[0],n.pedantic){let w=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t),A=new Error("Error line number "+w+": missing separator");throw A.line=w,A.language="DAMON",A.errorType="pedantic",A}else if(p=!0,f.children[u].children.length>0){h="implicit map key";let w=JSON.parse(`["${l}"]`)[0];c.set(w,new Map),c.implicitMaps===void 0&&(c.implicitMaps=[]),c.implicitMaps.push(w),r(f.children[u],c.get(w))}else{h="implicit null key";let w=JSON.parse(`["${l}"]`)[0];c.set(w,null),c.implicitNulls===void 0&&(c.implicitNulls=[]),c.implicitNulls.push(w)}else{let w=JSON.parse(`["${l.slice(0,-1*d)}"]`)[0];if(n.pedantic)if(/: +$/.test(w)){let A=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t),N=new Error("Error line number "+A+": bad value");throw N.line=A,N.language="DAMON",N.errorType="pedantic",N}else{let A=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t),N=new Error("Error line number "+A+": missing separator");throw N.line=A,N.language="DAMON",N.errorType="pedantic",N}else if(p=!0,f.children[u].children.length>0){h="implicit map key";let A=JSON.parse(`["${l}"]`)[0];c.set(A,new Map),c.implicitMaps===void 0&&(c.implicitMaps=[]),c.implicitMaps.push(A),r(f.children[u],c.get(A))}else{h="implicit null key";let A=JSON.parse(`["${l}"]`)[0];c.set(A,null),c.implicitNulls===void 0&&(c.implicitNulls=[]),c.implicitNulls.push(A)}}}if(!p&&f.children[u].children.length>0){let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+3,d=new Error("Error line number "+y+": missing container or excess indentation");throw d.line=y,d.language="DAMON",d}}}catch(p){if(p.language===void 0){let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;console.error("Error line number "+y+": not JSON-compliant, detailed error follows"),p.line=y,p.language="JSON",p.type=h}throw p}}}function a(f,c){for(let u=0,g=f.children.length;u<g;u++)if(t++,f.children[u].content.length){let l=f.children[u].content;if(/^[ \t]*\[/.test(l)&&l[l.length-1]=="]")if(/^[ \t]*\[ *\]$/.test(l))c.push([]),r(f.children[u],c[c.length-1]);else{let h;try{h=JSON.parse(l)}catch{let d=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,w=new Error("Error line number "+d+": invalid inline lists");throw w.line=d,w.language="JSON",w.type="list",w}if(h.every(function(y){return y===!0||y===!1||y===null||typeof y=="string"?!0:!!(isFinite(y)&&!isNaN(parseFloat(y))&&Number.isFinite(y*1)&&!Number.isNaN(y*1))}))c.push(h),c.damonInlineArrays===void 0&&(c.damonInlineArrays=[]),c.damonInlineArrays.push(u);else{let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,d=new Error("Error line number "+y+": no nesting in inline lists");throw d.line=y,d.language="DAMON",d}if(f.children[u].children.length>0){let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+3,d=new Error("Error line number "+y+": inline lists can't have children");throw d.line=y,d.language="DAMON",d}}else if(/^[ \t]*\{\}$/.test(l))c.push(new Map),r(f.children[u],c[c.length-1]);else if(/^[ \t]*true$/.test(l))c.push(!0);else if(/^[ \t]*false$/.test(l))c.push(!1);else if(/^[ \t]*null$/.test(l))c.push(null);else if(/^[ \t]*".*"$/.test(l))try{c.push(JSON.parse(`[${l.trimStart()}]`)[0])}catch(h){let p=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;throw console.error("Error line number "+p+": not JSON-compliant, detailed error follows"),h.line=p,h.language="JSON",h.type="string",h}else if(isFinite(l)&&!isNaN(parseFloat(l))&&Number.isFinite(l*1)&&!Number.isNaN(l*1)){if(l.indexOf(0)==0&&l.length>1&&l.indexOf(".")!==1){let h=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,p=new Error("Error line number "+h+": leading 0");throw p.line=h,p.language="DAMON",p}try{c.push(JSON.parse(`[${l*1}]`)[0])}catch(h){let p=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;throw console.error("Error line number "+p+": not JSON-compliant, detailed error follows"),h.line=p,h.language="JSON",h.type="number",h}}else if(l*1===1/0)try{JSON.parse(l*1)}catch(h){let p=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;throw console.error("Error line number "+p+": not JSON-compliant, detailed error follows"),h.line=p,h.language="JSON",h.type="infinity",h}else{let h=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,p=new Error("Error line number "+h+": list items can't have a key");throw p.line=h,p.language="DAMON",p}}else{let l=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,h=new Error("Error line number "+l+": empty list node");throw h.line=l,h.language="DAMON",h}}}mapToDamon(e,n){let t=this;var r="";if(Array.isArray(e))r+=`- []
`;else if(typeof e=="object"&&e!==null&&e instanceof Map&&e.constructor===Map)r+=`- {}
`;else return typeof e=="string"&&(e='"'+e+'"'),JSON.parse(e),e;return s(e),t.damonToMap(r.slice(0,-1)),r.slice(0,-1);function s(a,f=1){if(typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map){let g=Array.from(a.keys()),l=!1;a.implicitNulls!==void 0&&a.implicitNulls.length===g.length&&(l=!0);for(let[h,p]of a)if(typeof p=="object"&&p!==null)if(Array.isArray(p)){let y=0,d=p.filter(function(w){return w===!0||w===!1?!0:w===null?(y++,!0):typeof w=="string"?!0:!!(isFinite(w)&&!isNaN(parseFloat(w))&&Number.isFinite(w*1)&&!Number.isNaN(w*1))});if(p.length==d.length&&f*4+2+p.join(", ").length+y*4<=80||n&&a.damonInlineArrays!==void 0&&a.damonInlineArrays.indexOf(h)>-1){let w="["+p.map(function(A){return typeof A=="string"&&(A=JSON.stringify(A)),A}).join(", ")+"]";r+="    ".repeat(f)+"- "+JSON.stringify(h).slice(1,-1)+": "+w+`
`}else r+="    ".repeat(f)+"- "+JSON.stringify(h).slice(1,-1)+`: []
`,s(p,f+1)}else r+="    ".repeat(f)+"- "+JSON.stringify(h).slice(1,-1)+`: {}
`,s(p,f+1);else l?r+="    ".repeat(f)+"- "+JSON.stringify(h).slice(1,-1)+`
`:(r+="    ".repeat(f)+"- "+JSON.stringify(h).slice(1,-1)+": ",p===!0?r+=`true
`:p===!1?r+=`false
`:p===null?r+=`null
`:Number.isFinite(p)&&!Number.isNaN(p)?r+=p+`
`:r+=JSON.stringify(p)+`
`)}else if(Array.isArray(a))for(var c=0,u=a.length;c<u;c++)if(typeof a[c]=="object"&&a[c]!==null)if(Array.isArray(a[c])){let g=0,l=a[c].filter(function(h){return h===!0||h===!1?!0:h===null?(g++,!0):typeof h=="string"?!0:!!(isFinite(h)&&!isNaN(parseFloat(h))&&Number.isFinite(h*1)&&!Number.isNaN(h*1))});if(a[c].length==l.length&&f*4+2+a[c].join(", ").length+g*4<=80||n&&a.damonInlineArrays!==void 0&&a.damonInlineArrays.indexOf(c)>-1){let h="["+a[c].map(function(p){return typeof p=="string"&&(p=JSON.stringify(p)),p}).join(", ")+"]";r+="    ".repeat(f)+"- "+h+`
`}else r+="    ".repeat(f)+`- []
`,s(a[c],f+1)}else r+="    ".repeat(f)+`- {}
`,s(a[c],f+1);else a[c]===!0?r+="    ".repeat(f)+`- true
`:a[c]===!1?r+="    ".repeat(f)+`- false
`:a[c]===null?r+="    ".repeat(f)+`- null
`:Number.isFinite(a[c])&&!Number.isNaN(a[c])?r+="    ".repeat(f)+"- "+a[c]+`
`:r+="    ".repeat(f)+"- "+JSON.stringify(a[c])+`
`}}mapToJSON(e){let n=this;var t="";if(Array.isArray(e))return t+=`[\r
`,r(e),t+="]",JSON.parse(t),t;return typeof e=="object"&&e!==null&&e instanceof Map&&e.constructor===Map?(t+=`{\r
`,r(e),t+="}",JSON.parse(t),t):(typeof e=="string"&&(e=JSON.stringify(e)),JSON.parse(e),e);function r(s,a=1){if(typeof s=="object"&&s!==null&&!Array.isArray(s)&&s instanceof Map&&s.constructor===Map)for(let[u,g]of s)typeof g=="object"&&g!==null?Array.isArray(g)?g.length>0?(t+="    ".repeat(a)+`${JSON.stringify(u)}: [\r
`,r(g,a+1),t+="    ".repeat(a)+"]"):t+="    ".repeat(a)+`${JSON.stringify(u)}: []`:Array.from(g.keys()).length>0?(t+="    ".repeat(a)+`${JSON.stringify(u)}: {\r
`,r(g,a+1),t+="    ".repeat(a)+"}"):t+="    ".repeat(a)+`${JSON.stringify(u)}: {}`:g===!0?t+="    ".repeat(a)+`${JSON.stringify(u)}: true`:g===!1?t+="    ".repeat(a)+`${JSON.stringify(u)}: false`:g===null?t+="    ".repeat(a)+`${JSON.stringify(u)}: null`:Number.isFinite(g)&&!Number.isNaN(g)?t+="    ".repeat(a)+`${JSON.stringify(u)}: `+g:t+="    ".repeat(a)+`${JSON.stringify(u)}: `+JSON.stringify(g),u!=Array.from(s.keys())[Array.from(s.keys()).length-1]?t+=`,\r
`:t+=`\r
`;else if(Array.isArray(s))for(var f=0,c=s.length;f<c;f++)typeof s[f]=="object"&&s[f]!==null?Array.isArray(s[f])?s[f].length>0?(t+="    ".repeat(a)+`[\r
`,r(s[f],a+1),t+="    ".repeat(a)+"]"):t+="    ".repeat(a)+"[]":Array.from(s[f].keys()).length>0?(t+="    ".repeat(a)+`{\r
`,r(s[f],a+1),t+="    ".repeat(a)+"}"):t+="    ".repeat(a)+"{}":s[f]===!0?t+="    ".repeat(a)+"true":s[f]===!1?t+="    ".repeat(a)+"false":s[f]===null?t+="    ".repeat(a)+"null":Number.isFinite(s[f])&&!Number.isNaN(s[f])?t+="    ".repeat(a)+s[f]:t+="    ".repeat(a)+JSON.stringify(s[f]),f!=c-1?t+=`,\r
`:t+=`\r
`}}getPathsList(e){let t=this.damonToMap(e),r=[];return s(t),r;function s(a,f=[]){if(typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map)for(let[c,u]of a)typeof u=="object"&&u!==null&&!Array.isArray(u)&&u instanceof Map&&u.constructor===Map&&Array.from(u.keys()).length?(r.push(f.concat(c)),s(u,f.concat([c]))):Array.isArray(u)&&(a.damonInlineArrays==null||a.damonInlineArrays.indexOf(c)===-1)&&u.length?(r.push(f.concat(c)),s(u,f.concat([c]))):r.push(f.concat(c).concat(u));else for(let c=0,u=a.length;c<u;c++)typeof a[c]=="object"&&a[c]!==null&&!Array.isArray(a[c])&&a[c]instanceof Map&&a[c].constructor===Map&&Array.from(a[c].keys()).length?(r.push(f.concat(c)),s(a[c],f.concat([c]))):Array.isArray(a[c])&&(a.damonInlineArrays==null||a.damonInlineArrays.indexOf(c)===-1)&&a[c].length?(r.push(f.concat(c)),s(a[c],f.concat([c]))):r.push(f.concat(a[c]))}}getRangeFromPath(e,n){let t=this,r=t.damonToMap(e),s=-1,a=!1;h(r,n),r.headless&&(s-=1);let f=0,c=0;for(let p=0,y=r.damonOriginalLinesMapping.length;p<y;p++)if(r.damonOriginalLinesMapping[p]!==null&&c++,c==s){f=p+1;break}let u=t._getLines(e)[f],g=0,l=u.length;if(n.length==1)typeof n[n.length-1]=="string"?g=u.length-u.trimStart().slice(2+n[n.length-1].length+2).trimStart().length:g=u.length-u.trimStart().slice(2).length;else if(typeof n[n.length-2]=="string")if(typeof n[n.length-1]=="string")g=u.length-u.trimStart().slice(2+n[n.length-1].length+2).trimStart().length;else if(u[u.length-1]=="]"&&!/\[ *\]$/.test(u)){let p=u.trimStart().slice(2+n[n.length-2].length+2),y=JSON.parse(p),d=y.slice(0,n[n.length-1].length).reduce((N,E)=>N+(E===y[n[n.length-1]]),0),w=0,A=y[n[n.length-1]];typeof A=="string"&&(A='"'+A+'"');for(let N=0,E=d+1;N<E;N++)w=p.indexOf(A,w);g=u.length-p.length+w,l=g+A.length}else g=u.length-u.trimStart().slice(2).length;else if(typeof n[n.length-1]=="string")g=u.length-u.trimStart().slice(2+n[n.length-1].length+2).trimStart().length;else if(u[u.length-1]=="]"&&!/\[ *\]$/.test(u)){let p=u.trimStart().slice(2),y=JSON.parse(p),d=y.slice(0,n[n.length-1]).reduce((N,E)=>N+(E===y[n[n.length-1]]),0),w=0,A=y[n[n.length-1]];typeof A=="string"&&(A='"'+A+'"');for(let N=0,E=d+1;N<E;N++)w=p.indexOf(A,w);g=u.length-p.length+w,l=g+A.length}else g=u.length-u.trimStart().slice(2).length;return[[f,g],[f,l]];function h(p,y,d=[]){if(s+=1,typeof p=="object"&&p!==null&&!Array.isArray(p)&&p instanceof Map&&p.constructor===Map)for(let[w,A]of p){if(a==!0)return;if(s+=1,JSON.stringify(y)===JSON.stringify(d.concat([w]))){a=!0;return}if(typeof A=="object"&&A!==null&&!Array.isArray(A)&&A instanceof Map&&A.constructor===Map&&Array.from(A.keys()).length)s-=1,h(A,y,d.concat([w]));else if(Array.isArray(A)&&A.length){if(p.damonInlineArrays==null||p.damonInlineArrays.indexOf(w)===-1)s-=1,h(A,y,d.concat([w]));else if(JSON.stringify(y.slice(0,-1))===JSON.stringify(d.concat([w]))){a=!0;return}}}else for(let w=0,A=p.length;w<A;w++){if(a==!0)return;if(s+=1,JSON.stringify(y)===JSON.stringify(d.concat([w]))){a=!0;return}if(typeof p[w]=="object"&&p[w]!==null&&!Array.isArray(p[w])&&p[w]instanceof Map&&p[w].constructor===Map&&Array.from(p[w].keys()).length)s-=1,h(p[w],y,d.concat([w]));else if(Array.isArray(p[w])&&p[w].length){if(p.damonInlineArrays==null||p.damonInlineArrays.indexOf(w)===-1)s-=1,h(p[w],y,d.concat([w]));else if(JSON.stringify(y.slice(0,-1))===JSON.stringify(d.concat([w]))){a=!0;return}}}}}getTokenFromCoordinates(e,n){let t=this,r={},s=t._getLines(e).slice(0,n[0]);if(s[n[0]-1]=="")return r.type="newline",r.path=null,r.range=[n,n],r;if(/^[ \t]+$/.test(s[n[0]-1]))return r.type="indentation",r.path=null,r.range=[[n[0],1],[n[0],s[s.length-1].length]],r;if(/^[ \t]+/.test(s[n[0]-1].slice(0,n[1]-1))&&(r.type="indentation",r.range=[[n[0],1],[n[0],s[n[0]-1].match(/^[ \t]+/)[0].length]]),/^ *\/\//.test(s[n[0]-1]))return r.type=="indentation"?(r.path=null,r):(r.type="comment",r.path=null,r.range=[[[n[0],s[n[0]-1].split("//")[0].length]],[[n[0],s[n[0]-1].length]]],r);if(s.length==1)try{let g=JSON.parse(e);if(g===!0||g===!1||g===null||typeof g=="string"||typeof g=="number"){let l=e.match(/^ */)[0].length,h=e.match(/ *$/)[0].length;return r.type="null",typeof g!="object"&&(r.type=typeof g),r.path=null,r.range=[[0,l],[0,e.length-h]],r}}catch{}let a=t.damonToMap(s.join(`
`)),f=Array.from(a.keys()),c=[];for(;f.length;){let g=f[f.length-1];if(c.push(g),typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map?a=a.get(g):Array.isArray(a)&&(a=a[g]),a===!0||a===!1||a===null||typeof a=="string"||typeof a=="number")break;f=Array.from(a.keys())}r.path=c;let u=t.getRangeFromPath(e,c);if(typeof c[c.length-1]=="string")if(n[1]<u[0][1]){let g=s[n[0]-1].slice(0,-1*(u[1][1]-u[0][1])-1).length;if(n[1]<g){let l=s[n[0]-1].match(/^[ \t]+/)[0].length+3;n[1]>=l?(r.type="property",r.range=[[n[0],l],[n[0],g]]):(r.type="hyphen",r.range=[[n[0],l-2],[n[0],l-1]])}else r.type="separator",r.range=[[n[0],g+1],[n[0],u[0][1]-1]]}else r.type="?",r.range=u;else if(n[1]<u[0][1]){r.type="hyphen";let g=s[n[0]-1].match(/^[ \t]+/)[0].length+1;r.range=[[n[0],g],[n[0],g+1]]}else r.type="?",r.range=u;return r}}});var lt=se((qn,br)=>{br.exports=class{constructor(e){let n=this;this.parent=e,this.itemHeight=parseFloat(getComputedStyle(this.parent.editor).getPropertyValue("--fontSize"))*parseFloat(getComputedStyle(this.parent.editor).getPropertyValue("--lineHeight")),this.viewportHeight=this.parent.editor.getBoundingClientRect().height,this.viewable=Math.ceil(n.viewportHeight/n.itemHeight),this.maxCounter=this.parent.textarea.value.split(`
`).length,this.buffer=n.viewable*2,this.visibleNodesCount=n.viewable+n.buffer,this.lastScrollTop=void 0,this.lastStart=void 0,this.active=!1}inputHandler(e){let n=this;n.parent.textarea.value.split(`
`).length<=n.visibleNodesCount?(n.parent.gutter.innerHTML="",n.init(0)):(n.parent.gutter.innerHTML="",n.init(n.getStartNode(n.parent.textarea.value.split(`
`).length)))}scrollHandler(){let e=this;e.maxCounter<e.visibleNodesCount?e.lastScrollTop!==e.parent.editor.scrollTop?(e.parent.gutter.innerHTML="",e.parent.editor.style.setProperty("--scrollbarPadding","0px"),e.init(0)):(e.parent.editor.style.setProperty("--scrollbarPadding","0px"),e.parent.gutter.style.transform="translate("+e.parent.editor.scrollLeft+"px, "+0*e.itemHeight+"px)",e.parent.overlay.firstElementChild.style.transform="translate(0px, "+0*e.itemHeight+"px)"):e.lastScrollTop!==e.parent.editor.scrollTop?(e.active=!0,e.parent.editor.style.setProperty("--scrollbarPadding","var(--textareaPadding) * 4"),e.update(e.getStartNode(e.maxCounter))):(e.parent.gutter.style.transform="translate("+e.parent.editor.scrollLeft+"px, "+e.getStartNode(e.maxCounter)*e.itemHeight+"px)",e.parent.overlay.firstElementChild.style.transform="translate(0px, "+e.getStartNode(e.maxCounter)*e.itemHeight+"px)")}init(e){let n=this;n.parent.textarea.style.height=(n.parent.textarea.value.split(`
`).length+1)*n.itemHeight+"px",n.resetProperties(),e>n.maxCounter-n.visibleNodesCount&&(n.maxCounter-n.visibleNodesCount>0?e=n.maxCounter-n.visibleNodesCount:e=0);let t=Math.max(1,Math.min(n.maxCounter-e,n.visibleNodesCount));for(let c=e;c<e+t;c++){let u=document.createElement("div"),g=document.createElement("span"),l=(n.maxCounter+"").length,h=(c+1+"").length,p=l-h;g.textContent=" ".repeat(p)+(c+1),u.appendChild(g),n.parent.gutter.appendChild(u)}n.parent.gutter.style.transform="translate("+n.parent.editor.scrollLeft+"px, "+e*n.itemHeight+"px)",n.parent.overlay.firstElementChild.style.transform="translate(0px, "+e*n.itemHeight+"px)",n.lastStart=e,n.lastScrollTop=n.parent.editor.scrollTop,n.maxCounter>=n.visibleNodesCount&&(n.active=!0),n.setGutterWidth(),n.parent.updateCurrentLine(!0);let r=n.parent.textarea.value.split(`
`);n.parent.textarea.rows=r.length+1,n.parent.textarea.cols=r.map(c=>c.length).reduce(function(c,u){return Math.max(c,u)});let s=n.parent.textarea.value.replaceAll(/&amp;/g,"&").replaceAll(/&lt;/g,"<").replaceAll(/&gt;/g,">"),a=[`<span class="token lf">
</span>`],f=n.parent.lastTextareaValue.split(`
`);s!=""&&(a=n.parent.prism.highlight(s+`
`,n.parent.prism.languages.damon,"damon").replace(/<span>\n<\/span>$/,"").split(`
`).map(c=>c.replace(/^<\/span>/,"")+`
</span>`));for(let c=e,u=e+t;c<u;c++){let g=document.createElement("span"),l=0;g.classList.add("space-line"),g.innerHTML=a[c];for(let h=0,p=g.children.length;h<p&&g.children[h].textContent==" ";h++)l++,l==4&&(l=0,g.children[h-3].classList.add("indent-guide"));(!n.parent.initialized||f[c]==null||f[c]!=r[c]||n.parent.overlay.firstElementChild.children[c-e]!=null&&g.innerHTML!=n.parent.overlay.firstElementChild.children[c-e].innerHTML)&&(f[c]==null||!n.parent.initialized?(n.parent.overlay.firstElementChild.appendChild(g),n.parent.overlay.firstElementChild.children.length>t+1&&n.parent.overlay.firstElementChild.firstElementChild.remove()):n.parent.overlay.firstElementChild.replaceChild(g,n.parent.overlay.firstElementChild.children[c-e]))}if(n.parent.overlay.firstElementChild.children.length>t)for(let c=t,u=n.parent.overlay.firstElementChild.children.length;c<u;c++)n.parent.overlay.firstElementChild.lastElementChild.remove()}getStartNode(e){let n=this,t=Math.floor(n.parent.editor.scrollTop/n.itemHeight)-n.viewable;return t=Math.min(Math.max(0,t),Math.max(0,e-n.buffer)),t}resetProperties(){let e=this;e.viewportHeight=e.parent.editor.getBoundingClientRect().height,e.viewable=Math.ceil(e.viewportHeight/e.itemHeight),e.maxCounter=e.parent.textarea.value.split(`
`).length,e.buffer=e.viewable*2,e.visibleNodesCount=e.viewable+e.buffer,e.active=!1}update(e){let n=this;if(n.resetProperties(),n.parent.gutter.firstElementChild)if(n.lastScrollTop!=n.parent.editor.scrollTop)e>n.maxCounter-n.visibleNodesCount&&(n.maxCounter-n.visibleNodesCount>0?e=n.maxCounter-n.visibleNodesCount:e=0),n.diffItems(e,n.visibleNodesCount),n.parent.gutter.style.transform="translate("+n.parent.editor.scrollLeft+"px, "+e*n.itemHeight+"px)",n.parent.overlay.firstElementChild.style.transform="translate(0px, "+e*n.itemHeight+"px)",n.lastScrollTop=n.parent.editor.scrollTop;else if(/^translate\(.+px, .+px\)$/.test(n.parent.gutter.style.transform))n.parent.gutter.style.transform="translate("+n.parent.editor.scrollLeft+"px, "+n.parent.gutter.style.transform.split(", ")[1];else throw new Error("You need to update this regex.");n.setGutterWidth(),n.parent.updateCurrentLine(!0)}diffItems(e,n){let t=this;if(t.lastStart!=e){if(t.lastStart<e){let r=Math.min(n,Math.abs(e-t.lastStart));for(let u=0,g=r;u<g;u++)t.parent.gutter.firstElementChild.remove();for(let u=e+n-r;u<e+n;u++){let g=document.createElement("div"),l=document.createElement("span"),h=(t.maxCounter+"").length,p=(u+1+"").length,y=h-p;l.textContent=" ".repeat(y)+(u+1),g.appendChild(l),t.parent.gutter.appendChild(g)}let s=t.parent.textarea.value.split(`
`);t.parent.textarea.rows=s.length+1,t.parent.textarea.cols=s.map(u=>u.length).reduce(function(u,g){return Math.max(u,g)});let a=t.parent.textarea.value.replaceAll(/&amp;/g,"&").replaceAll(/&lt;/g,"<").replaceAll(/&gt;/g,">"),f=t.parent.prism.highlight(a+`
`,t.parent.prism.languages.damon,"damon").replace(/<span>\n<\/span>$/,"").split(`
`).map(u=>u.replace(/^<\/span>/,"")+`
</span>`),c=t.parent.lastTextareaValue.split(`
`);for(let u=0,g=r;u<g;u++)t.parent.overlay.firstElementChild.firstElementChild.remove();for(let u=e+n-r;u<e+n;u++){let g=document.createElement("span"),l=0;g.classList.add("space-line"),g.innerHTML=f[u];for(let h=0,p=g.children.length;h<p&&g.children[h].textContent==" ";h++)l++,l==4&&(l=0,g.children[h-3].classList.add("indent-guide"));t.parent.overlay.firstElementChild.appendChild(g)}}else{let r=Math.min(n,Math.abs(t.lastStart-e));for(let l=0,h=r;l<h;l++)t.parent.gutter.lastElementChild.remove();let s=document.createDocumentFragment();for(let l=e;l<e+r;l++){let h=document.createElement("div"),p=document.createElement("span"),y=(t.maxCounter+"").length,d=(l+1+"").length,w=y-d;p.textContent=" ".repeat(w)+(l+1),h.appendChild(p),s.appendChild(h)}t.parent.gutter.insertBefore(s,t.parent.gutter.firstElementChild);let a=t.parent.textarea.value.split(`
`);t.parent.textarea.rows=a.length+1,t.parent.textarea.cols=a.map(l=>l.length).reduce(function(l,h){return Math.max(l,h)});let f=t.parent.textarea.value.replaceAll(/&amp;/g,"&").replaceAll(/&lt;/g,"<").replaceAll(/&gt;/g,">"),c=t.parent.prism.highlight(f+`
`,t.parent.prism.languages.damon,"damon").replace(/<span>\n<\/span>$/,"").split(`
`).map(l=>l.replace(/^<\/span>/,"")+`
</span>`),u=t.parent.lastTextareaValue.split(`
`);for(let l=0,h=r;l<h;l++)t.parent.overlay.firstElementChild.lastElementChild.remove();let g=document.createDocumentFragment();for(let l=e;l<e+r;l++){let h=document.createElement("span"),p=0;h.classList.add("space-line"),h.innerHTML=c[l];for(let y=0,d=h.children.length;y<d&&h.children[y].textContent==" ";y++)p++,p==4&&(p=0,h.children[y-3].classList.add("indent-guide"));g.appendChild(h)}t.parent.overlay.firstElementChild.insertBefore(g,t.parent.overlay.firstElementChild.firstElementChild)}t.lastStart=e}}setGutterWidth(){let e=this,n=e.parent.gutter.children[0].children[0].getBoundingClientRect().width,t=parseFloat(getComputedStyle(e.parent.editor).getPropertyValue("--gutterWidth"));n>t?(e.parent.gutter.style.width=n+"px",e.parent.container.style.left=n+"px"):(e.parent.gutter.style.width="",e.parent.container.style.left="")}}});var Mr=se((Yn,Hr)=>{"use strict";var{entries:Rr,setPrototypeOf:Ar,isFrozen:mn,getPrototypeOf:gn,getOwnPropertyDescriptor:yn}=Object,{freeze:Z,seal:ee,create:Dr}=Object,{apply:ct,construct:dt}=typeof Reflect<"u"&&Reflect;Z||(Z=function(e){return e});ee||(ee=function(e){return e});ct||(ct=function(e,n,t){return e.apply(n,t)});dt||(dt=function(e,n){return new e(...n)});var Ue=Q(Array.prototype.forEach),xn=Q(Array.prototype.lastIndexOf),Sr=Q(Array.prototype.pop),Se=Q(Array.prototype.push),En=Q(Array.prototype.splice),Be=Q(String.prototype.toLowerCase),at=Q(String.prototype.toString),wr=Q(String.prototype.match),we=Q(String.prototype.replace),Nn=Q(String.prototype.indexOf),bn=Q(String.prototype.trim),te=Q(Object.prototype.hasOwnProperty),X=Q(RegExp.prototype.test),Ce=An(TypeError);function Q(i){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return ct(i,e,t)}}function An(i){return function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return dt(i,n)}}function H(i,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Be;Ar&&Ar(i,null);let t=e.length;for(;t--;){let r=e[t];if(typeof r=="string"){let s=n(r);s!==r&&(mn(e)||(e[t]=s),r=s)}i[r]=!0}return i}function Sn(i){for(let e=0;e<i.length;e++)te(i,e)||(i[e]=null);return i}function oe(i){let e=Dr(null);for(let[n,t]of Rr(i))te(i,n)&&(Array.isArray(t)?e[n]=Sn(t):t&&typeof t=="object"&&t.constructor===Object?e[n]=oe(t):e[n]=t);return e}function Te(i,e){for(;i!==null;){let t=yn(i,e);if(t){if(t.get)return Q(t.get);if(typeof t.value=="function")return Q(t.value)}i=gn(i)}function n(){return null}return n}var Cr=Z(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),st=Z(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ot=Z(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),wn=Z(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ft=Z(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Cn=Z(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Tr=Z(["#text"]),Lr=Z(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ut=Z(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Or=Z(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Fe=Z(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Tn=ee(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ln=ee(/<%[\w\W]*|[\w\W]*%>/gm),On=ee(/\$\{[\w\W]*/gm),_n=ee(/^data-[\-\w.\u00B7-\uFFFF]+$/),vn=ee(/^aria-[\-\w]+$/),kr=ee(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Rn=ee(/^(?:\w+script|data):/i),Dn=ee(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ir=ee(/^html$/i),kn=ee(/^[a-z][.\w]*(-[.\w]+)+$/i),_r=Object.freeze({__proto__:null,ARIA_ATTR:vn,ATTR_WHITESPACE:Dn,CUSTOM_ELEMENT:kn,DATA_ATTR:_n,DOCTYPE_NAME:Ir,ERB_EXPR:Ln,IS_ALLOWED_URI:kr,IS_SCRIPT_OR_DATA:Rn,MUSTACHE_EXPR:Tn,TMPLIT_EXPR:On}),Le={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},In=function(){return typeof window>"u"?null:window},$n=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let t=null,r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(t=n.getAttribute(r));let s="dompurify"+(t?"#"+t:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},vr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function $r(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:In(),e=R=>$r(R);if(e.version="3.2.6",e.removed=[],!i||!i.document||i.document.nodeType!==Le.document||!i.Element)return e.isSupported=!1,e;let{document:n}=i,t=n,r=t.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:f,Element:c,NodeFilter:u,NamedNodeMap:g=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:l,DOMParser:h,trustedTypes:p}=i,y=c.prototype,d=Te(y,"cloneNode"),w=Te(y,"remove"),A=Te(y,"nextSibling"),N=Te(y,"childNodes"),E=Te(y,"parentNode");if(typeof a=="function"){let R=n.createElement("template");R.content&&R.content.ownerDocument&&(n=R.content.ownerDocument)}let x,C="",{implementation:T,createNodeIterator:m,createDocumentFragment:o,getElementsByTagName:L}=n,{importNode:S}=t,_=vr();e.isSupported=typeof Rr=="function"&&typeof E=="function"&&T&&T.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:D,ERB_EXPR:k,TMPLIT_EXPR:I,DATA_ATTR:$,ARIA_ATTR:M,IS_SCRIPT_OR_DATA:U,ATTR_WHITESPACE:F,CUSTOM_ELEMENT:G}=_r,{IS_ALLOWED_URI:re}=_r,V=null,ht=H({},[...Cr,...st,...ot,...ft,...Tr]),q=null,mt=H({},[...Lr,...ut,...Or,...Fe]),J=Object.seal(Dr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ee=null,Je=null,gt=!0,ze=!0,yt=!1,xt=!0,ue=!1,Oe=!0,fe=!1,Ge=!1,Ve=!1,ce=!1,_e=!1,ve=!1,Et=!0,Nt=!1,Gr="user-content-",We=!0,Ne=!1,de={},pe=null,bt=H({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),At=null,St=H({},["audio","video","img","source","image","track"]),qe=null,wt=H({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Re="http://www.w3.org/1998/Math/MathML",De="http://www.w3.org/2000/svg",ie="http://www.w3.org/1999/xhtml",he=ie,Ye=!1,Ke=null,Vr=H({},[Re,De,ie],at),ke=H({},["mi","mo","mn","ms","mtext"]),Ie=H({},["annotation-xml"]),Wr=H({},["title","style","font","a","script"]),be=null,qr=["application/xhtml+xml","text/html"],Yr="text/html",W=null,me=null,Kr=n.createElement("form"),Ct=function(b){return b instanceof RegExp||b instanceof Function},Xe=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(me&&me===b)){if((!b||typeof b!="object")&&(b={}),b=oe(b),be=qr.indexOf(b.PARSER_MEDIA_TYPE)===-1?Yr:b.PARSER_MEDIA_TYPE,W=be==="application/xhtml+xml"?at:Be,V=te(b,"ALLOWED_TAGS")?H({},b.ALLOWED_TAGS,W):ht,q=te(b,"ALLOWED_ATTR")?H({},b.ALLOWED_ATTR,W):mt,Ke=te(b,"ALLOWED_NAMESPACES")?H({},b.ALLOWED_NAMESPACES,at):Vr,qe=te(b,"ADD_URI_SAFE_ATTR")?H(oe(wt),b.ADD_URI_SAFE_ATTR,W):wt,At=te(b,"ADD_DATA_URI_TAGS")?H(oe(St),b.ADD_DATA_URI_TAGS,W):St,pe=te(b,"FORBID_CONTENTS")?H({},b.FORBID_CONTENTS,W):bt,Ee=te(b,"FORBID_TAGS")?H({},b.FORBID_TAGS,W):oe({}),Je=te(b,"FORBID_ATTR")?H({},b.FORBID_ATTR,W):oe({}),de=te(b,"USE_PROFILES")?b.USE_PROFILES:!1,gt=b.ALLOW_ARIA_ATTR!==!1,ze=b.ALLOW_DATA_ATTR!==!1,yt=b.ALLOW_UNKNOWN_PROTOCOLS||!1,xt=b.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ue=b.SAFE_FOR_TEMPLATES||!1,Oe=b.SAFE_FOR_XML!==!1,fe=b.WHOLE_DOCUMENT||!1,ce=b.RETURN_DOM||!1,_e=b.RETURN_DOM_FRAGMENT||!1,ve=b.RETURN_TRUSTED_TYPE||!1,Ve=b.FORCE_BODY||!1,Et=b.SANITIZE_DOM!==!1,Nt=b.SANITIZE_NAMED_PROPS||!1,We=b.KEEP_CONTENT!==!1,Ne=b.IN_PLACE||!1,re=b.ALLOWED_URI_REGEXP||kr,he=b.NAMESPACE||ie,ke=b.MATHML_TEXT_INTEGRATION_POINTS||ke,Ie=b.HTML_INTEGRATION_POINTS||Ie,J=b.CUSTOM_ELEMENT_HANDLING||{},b.CUSTOM_ELEMENT_HANDLING&&Ct(b.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(J.tagNameCheck=b.CUSTOM_ELEMENT_HANDLING.tagNameCheck),b.CUSTOM_ELEMENT_HANDLING&&Ct(b.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(J.attributeNameCheck=b.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),b.CUSTOM_ELEMENT_HANDLING&&typeof b.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(J.allowCustomizedBuiltInElements=b.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ue&&(ze=!1),_e&&(ce=!0),de&&(V=H({},Tr),q=[],de.html===!0&&(H(V,Cr),H(q,Lr)),de.svg===!0&&(H(V,st),H(q,ut),H(q,Fe)),de.svgFilters===!0&&(H(V,ot),H(q,ut),H(q,Fe)),de.mathMl===!0&&(H(V,ft),H(q,Or),H(q,Fe))),b.ADD_TAGS&&(V===ht&&(V=oe(V)),H(V,b.ADD_TAGS,W)),b.ADD_ATTR&&(q===mt&&(q=oe(q)),H(q,b.ADD_ATTR,W)),b.ADD_URI_SAFE_ATTR&&H(qe,b.ADD_URI_SAFE_ATTR,W),b.FORBID_CONTENTS&&(pe===bt&&(pe=oe(pe)),H(pe,b.FORBID_CONTENTS,W)),We&&(V["#text"]=!0),fe&&H(V,["html","head","body"]),V.table&&(H(V,["tbody"]),delete Ee.tbody),b.TRUSTED_TYPES_POLICY){if(typeof b.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ce('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof b.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ce('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=b.TRUSTED_TYPES_POLICY,C=x.createHTML("")}else x===void 0&&(x=$n(p,r)),x!==null&&typeof C=="string"&&(C=x.createHTML(""));Z&&Z(b),me=b}},Tt=H({},[...st,...ot,...wn]),Lt=H({},[...ft,...Cn]),Xr=function(b){let O=E(b);(!O||!O.tagName)&&(O={namespaceURI:he,tagName:"template"});let v=Be(b.tagName),B=Be(O.tagName);return Ke[b.namespaceURI]?b.namespaceURI===De?O.namespaceURI===ie?v==="svg":O.namespaceURI===Re?v==="svg"&&(B==="annotation-xml"||ke[B]):!!Tt[v]:b.namespaceURI===Re?O.namespaceURI===ie?v==="math":O.namespaceURI===De?v==="math"&&Ie[B]:!!Lt[v]:b.namespaceURI===ie?O.namespaceURI===De&&!Ie[B]||O.namespaceURI===Re&&!ke[B]?!1:!Lt[v]&&(Wr[v]||!Tt[v]):!!(be==="application/xhtml+xml"&&Ke[b.namespaceURI]):!1},ne=function(b){Se(e.removed,{element:b});try{E(b).removeChild(b)}catch{w(b)}},ge=function(b,O){try{Se(e.removed,{attribute:O.getAttributeNode(b),from:O})}catch{Se(e.removed,{attribute:null,from:O})}if(O.removeAttribute(b),b==="is")if(ce||_e)try{ne(O)}catch{}else try{O.setAttribute(b,"")}catch{}},Ot=function(b){let O=null,v=null;if(Ve)b="<remove></remove>"+b;else{let z=wr(b,/^[\r\n\t ]+/);v=z&&z[0]}be==="application/xhtml+xml"&&he===ie&&(b='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+b+"</body></html>");let B=x?x.createHTML(b):b;if(he===ie)try{O=new h().parseFromString(B,be)}catch{}if(!O||!O.documentElement){O=T.createDocument(he,"template",null);try{O.documentElement.innerHTML=Ye?C:B}catch{}}let Y=O.body||O.documentElement;return b&&v&&Y.insertBefore(n.createTextNode(v),Y.childNodes[0]||null),he===ie?L.call(O,fe?"html":"body")[0]:fe?O.documentElement:Y},_t=function(b){return m.call(b.ownerDocument||b,b,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Ze=function(b){return b instanceof l&&(typeof b.nodeName!="string"||typeof b.textContent!="string"||typeof b.removeChild!="function"||!(b.attributes instanceof g)||typeof b.removeAttribute!="function"||typeof b.setAttribute!="function"||typeof b.namespaceURI!="string"||typeof b.insertBefore!="function"||typeof b.hasChildNodes!="function")},vt=function(b){return typeof f=="function"&&b instanceof f};function le(R,b,O){Ue(R,v=>{v.call(e,b,O,me)})}let Rt=function(b){let O=null;if(le(_.beforeSanitizeElements,b,null),Ze(b))return ne(b),!0;let v=W(b.nodeName);if(le(_.uponSanitizeElement,b,{tagName:v,allowedTags:V}),Oe&&b.hasChildNodes()&&!vt(b.firstElementChild)&&X(/<[/\w!]/g,b.innerHTML)&&X(/<[/\w!]/g,b.textContent)||b.nodeType===Le.progressingInstruction||Oe&&b.nodeType===Le.comment&&X(/<[/\w]/g,b.data))return ne(b),!0;if(!V[v]||Ee[v]){if(!Ee[v]&&kt(v)&&(J.tagNameCheck instanceof RegExp&&X(J.tagNameCheck,v)||J.tagNameCheck instanceof Function&&J.tagNameCheck(v)))return!1;if(We&&!pe[v]){let B=E(b)||b.parentNode,Y=N(b)||b.childNodes;if(Y&&B){let z=Y.length;for(let j=z-1;j>=0;--j){let ae=d(Y[j],!0);ae.__removalCount=(b.__removalCount||0)+1,B.insertBefore(ae,A(b))}}}return ne(b),!0}return b instanceof c&&!Xr(b)||(v==="noscript"||v==="noembed"||v==="noframes")&&X(/<\/no(script|embed|frames)/i,b.innerHTML)?(ne(b),!0):(ue&&b.nodeType===Le.text&&(O=b.textContent,Ue([D,k,I],B=>{O=we(O,B," ")}),b.textContent!==O&&(Se(e.removed,{element:b.cloneNode()}),b.textContent=O)),le(_.afterSanitizeElements,b,null),!1)},Dt=function(b,O,v){if(Et&&(O==="id"||O==="name")&&(v in n||v in Kr))return!1;if(!(ze&&!Je[O]&&X($,O))){if(!(gt&&X(M,O))){if(!q[O]||Je[O]){if(!(kt(b)&&(J.tagNameCheck instanceof RegExp&&X(J.tagNameCheck,b)||J.tagNameCheck instanceof Function&&J.tagNameCheck(b))&&(J.attributeNameCheck instanceof RegExp&&X(J.attributeNameCheck,O)||J.attributeNameCheck instanceof Function&&J.attributeNameCheck(O))||O==="is"&&J.allowCustomizedBuiltInElements&&(J.tagNameCheck instanceof RegExp&&X(J.tagNameCheck,v)||J.tagNameCheck instanceof Function&&J.tagNameCheck(v))))return!1}else if(!qe[O]){if(!X(re,we(v,F,""))){if(!((O==="src"||O==="xlink:href"||O==="href")&&b!=="script"&&Nn(v,"data:")===0&&At[b])){if(!(yt&&!X(U,we(v,F,"")))){if(v)return!1}}}}}}return!0},kt=function(b){return b!=="annotation-xml"&&wr(b,G)},It=function(b){le(_.beforeSanitizeAttributes,b,null);let{attributes:O}=b;if(!O||Ze(b))return;let v={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q,forceKeepAttr:void 0},B=O.length;for(;B--;){let Y=O[B],{name:z,namespaceURI:j,value:ae}=Y,Ae=W(z),Qe=ae,K=z==="value"?Qe:bn(Qe);if(v.attrName=Ae,v.attrValue=K,v.keepAttr=!0,v.forceKeepAttr=void 0,le(_.uponSanitizeAttribute,b,v),K=v.attrValue,Nt&&(Ae==="id"||Ae==="name")&&(ge(z,b),K=Gr+K),Oe&&X(/((--!?|])>)|<\/(style|title)/i,K)){ge(z,b);continue}if(v.forceKeepAttr)continue;if(!v.keepAttr){ge(z,b);continue}if(!xt&&X(/\/>/i,K)){ge(z,b);continue}ue&&Ue([D,k,I],Ht=>{K=we(K,Ht," ")});let $t=W(b.nodeName);if(!Dt($t,Ae,K)){ge(z,b);continue}if(x&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!j)switch(p.getAttributeType($t,Ae)){case"TrustedHTML":{K=x.createHTML(K);break}case"TrustedScriptURL":{K=x.createScriptURL(K);break}}if(K!==Qe)try{j?b.setAttributeNS(j,z,K):b.setAttribute(z,K),Ze(b)?ne(b):Sr(e.removed)}catch{ge(z,b)}}le(_.afterSanitizeAttributes,b,null)},Zr=function R(b){let O=null,v=_t(b);for(le(_.beforeSanitizeShadowDOM,b,null);O=v.nextNode();)le(_.uponSanitizeShadowNode,O,null),Rt(O),It(O),O.content instanceof s&&R(O.content);le(_.afterSanitizeShadowDOM,b,null)};return e.sanitize=function(R){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=null,v=null,B=null,Y=null;if(Ye=!R,Ye&&(R="<!-->"),typeof R!="string"&&!vt(R))if(typeof R.toString=="function"){if(R=R.toString(),typeof R!="string")throw Ce("dirty is not a string, aborting")}else throw Ce("toString is not a function");if(!e.isSupported)return R;if(Ge||Xe(b),e.removed=[],typeof R=="string"&&(Ne=!1),Ne){if(R.nodeName){let ae=W(R.nodeName);if(!V[ae]||Ee[ae])throw Ce("root node is forbidden and cannot be sanitized in-place")}}else if(R instanceof f)O=Ot("<!---->"),v=O.ownerDocument.importNode(R,!0),v.nodeType===Le.element&&v.nodeName==="BODY"||v.nodeName==="HTML"?O=v:O.appendChild(v);else{if(!ce&&!ue&&!fe&&R.indexOf("<")===-1)return x&&ve?x.createHTML(R):R;if(O=Ot(R),!O)return ce?null:ve?C:""}O&&Ve&&ne(O.firstChild);let z=_t(Ne?R:O);for(;B=z.nextNode();)Rt(B),It(B),B.content instanceof s&&Zr(B.content);if(Ne)return R;if(ce){if(_e)for(Y=o.call(O.ownerDocument);O.firstChild;)Y.appendChild(O.firstChild);else Y=O;return(q.shadowroot||q.shadowrootmode)&&(Y=S.call(t,Y,!0)),Y}let j=fe?O.outerHTML:O.innerHTML;return fe&&V["!doctype"]&&O.ownerDocument&&O.ownerDocument.doctype&&O.ownerDocument.doctype.name&&X(Ir,O.ownerDocument.doctype.name)&&(j="<!DOCTYPE "+O.ownerDocument.doctype.name+`>
`+j),ue&&Ue([D,k,I],ae=>{j=we(j,ae," ")}),x&&ve?x.createHTML(j):j},e.setConfig=function(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xe(R),Ge=!0},e.clearConfig=function(){me=null,Ge=!1},e.isValidAttribute=function(R,b,O){me||Xe({});let v=W(R),B=W(b);return Dt(v,B,O)},e.addHook=function(R,b){typeof b=="function"&&Se(_[R],b)},e.removeHook=function(R,b){if(b!==void 0){let O=xn(_[R],b);return O===-1?void 0:En(_[R],O,1)[0]}return Sr(_[R])},e.removeHooks=function(R){_[R]=[]},e.removeAllHooks=function(){_=vr()},e}var Hn=$r();Hr.exports=Hn});var Ur=se((Xn,Pr)=>{var P=Mr();Pr.exports=class{constructor(e){let n=this;n.damon=e,n.websiteRegex=/^(https?:\/\/)?[-a-zA-Z0-9]*[a-zA-Z0-9]+(\.[-a-zA-Z0-9]*[a-zA-Z0-9]+)+/,n.httpRegex=/^https?:\/\//}damonToSExpression(e){let n=this;return n.implicitMapToSExpression(n.damon.damonToMap(e))}escape(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}mapToHtmlList(e,n=!1,t=void 0){let r=this;try{r.damon.mapToJSON(e)}catch(u){throw console.log(u),new Error("Provided map value doesn't passes JSON.parse()")}var s=0,a=document.createElement("ul"),f;return t!==void 0&&(f=JSON.parse(t)),a.className="DAMON-List",c(e,a),a;function c(u,g,l=[]){if(typeof g!="object"||g==null||Array.isArray(g))throw new Error("Error List Item number "+s+": @param { {} } list");if(typeof u=="object"&&u!==null&&!Array.isArray(u)&&u instanceof Map&&u.constructor===Map){if(g.tagName=="UL")for(let[y,d]of u){let w=document.createElement("ul"),A=document.createElement("code"),N=document.createElement("span"),E=document.createElement("li");if(E.dataset.graphArbo=Array.from(u.keys()).indexOf(y),l.length>0&&(E.dataset.graphArbo=l.join("-")+"-"+Array.from(u.keys()).indexOf(y)),N.className="type-key",r.websiteRegex.test(y)){let x=y;r.httpRegex.test(y)||(x="https://"+y);let C=P.sanitize(`<a href="${x}">${x}</a>`);N.innerHTML=C}else t!==void 0&&y in f["@context"]?N.innerHTML=P.sanitize(`<a href="${f["@context"][y]["@id"]}">${y}</a>`):N.textContent=y;if(typeof d=="object"&&d!==null)if(Array.isArray(d))if(u.damonInlineArrays!==void 0&&u.damonInlineArrays.indexOf(y)>-1){A.innerHTML=N.outerHTML+": [";for(let x=0,C=d.length;x<C;x++){let T=document.createElement("span"),m=d[x];if(m===!0)T.textContent="true",T.className="type-boolean";else if(m===!1)T.textContent="false",T.className="type-boolean";else if(m===null)T.textContent="null",T.className="type-null";else if(Number.isFinite(m)&&!Number.isNaN(m))T.textContent=m+"",T.className="type-number";else{if(n)if(r.websiteRegex.test(m)){let o=m;r.httpRegex.test(m)||(o="https://"+m),T.innerHTML=P.sanitize(`<a href="${o}">"${o}"</a>`)}else T.innerHTML=`"${m}"`;else if(r.websiteRegex.test(m)){let o=m;r.httpRegex.test(m)||(o="https://"+m),T.innerHTML=P.sanitize(`<a href="${o}">"${o}"</a>`)}else T.textContent=`"${m}"`;T.className="type-string"}x!==0&&(A.innerHTML+=", "),A.appendChild(T)}A.innerHTML+="]",E.appendChild(A),E.appendChild(w),g.appendChild(E)}else A.innerHTML=N.outerHTML+": []",E.appendChild(A),E.appendChild(w),g.appendChild(E),c(d,w,l.concat([Array.from(u.keys()).indexOf(y)]));else u.implicitMaps!==void 0&&u.implicitMaps.indexOf(y)>-1?A.innerHTML=N.outerHTML:A.innerHTML=N.outerHTML+": {}",E.appendChild(A),E.appendChild(w),g.appendChild(E),c(d,w,l.concat([Array.from(u.keys()).indexOf(y)]));else{s++,A.innerHTML=N.outerHTML+": ";let x=document.createElement("span"),C=d;if(C===!0)x.textContent="true",x.className="type-boolean";else if(C===!1)x.textContent="false",x.className="type-boolean";else if(C===null)x.textContent="null",x.className="type-null";else if(Number.isFinite(C)&&!Number.isNaN(C))x.textContent=C+"",x.className="type-number";else{if(n)if(r.websiteRegex.test(C)){let T=C;r.httpRegex.test(C)||(T="https://"+C),x.innerHTML=P.sanitize(`<a href="${T}">"${T}"</a>`)}else x.innerHTML=`"${C}"`;else if(r.websiteRegex.test(C)){let T=C;r.httpRegex.test(C)||(T="https://"+C),x.innerHTML=P.sanitize(`<a href="${T}">"${T}"</a>`)}else x.textContent=`"${C}"`;x.className="type-string"}u.implicitNulls===void 0||u.implicitNulls.indexOf(y)==-1?A.appendChild(x):A.innerHTML=A.innerHTML.slice(0,-2),E.appendChild(A),g.appendChild(E)}}}else if(Array.isArray(u))for(var h=0,p=u.length;h<p;h++){let y=document.createElement("ul"),d=document.createElement("code"),w=document.createElement("li");if(w.dataset.graphArbo=h,l.length>0&&(w.dataset.graphArbo=l.join("-")+"-"+h),typeof u[h]=="object"&&u[h]!==null)if(Array.isArray(u[h]))if(u.damonInlineArrays!==void 0&&u.damonInlineArrays.indexOf(h)>-1){d.innerHTML+="[";for(let A=0,N=u[h].length;A<N;A++){let E=document.createElement("span"),x=u[h][A];if(x===!0)E.textContent="true",E.className="type-boolean";else if(x===!1)E.textContent="false",E.className="type-boolean";else if(x===null)E.textContent="null",E.className="type-null";else if(Number.isFinite(x)&&!Number.isNaN(x))E.textContent=x+"",E.className="type-number";else{if(n)if(r.websiteRegex.test(x)){let C=x;r.httpRegex.test(x)||(C="https://"+x),E.innerHTML=P.sanitize(`<a href="${C}">"${C}"</a>`)}else E.innerHTML=`"${x}"`;else if(r.websiteRegex.test(x)){let C=x;r.httpRegex.test(x)||(C="https://"+x),E.innerHTML=P.sanitize(`<a href="${C}">"${C}"</a>`)}else E.textContent=`"${x}"`;E.className="type-string"}A!==0&&(d.innerHTML+=", "),d.appendChild(E)}d.innerHTML+="]",w.appendChild(d),w.appendChild(y),g.appendChild(w)}else d.textContent="[]",w.appendChild(d),w.appendChild(y),g.appendChild(w),c(u[h],y,l.concat(h));else d.textContent="{}",w.appendChild(d),w.appendChild(y),g.appendChild(w),c(u[h],y,l.concat(h));else{s++;let A=u[h];if(A===!0)d.textContent="true",d.className="type-boolean";else if(A===!1)d.textContent="false",d.className="type-boolean";else if(A===null)d.textContent="null",d.className="type-null";else if(Number.isFinite(A)&&!Number.isNaN(A))d.textContent=A+"",d.className="type-number";else{if(n)if(r.websiteRegex.test(A)){let N=A;r.httpRegex.test(A)||(N="https://"+A),d.innerHTML=P.sanitize(`<a href="${N}">"${N}"</a>`)}else d.innerHTML=`"${A}"`;else if(r.websiteRegex.test(A)){let N=A;r.httpRegex.test(A)||(N="https://"+A),d.innerHTML=P.sanitize(`<a href="${N}">"${N}"</a>`)}else d.textContent=`"${A}"`;d.className="type-string"}w.appendChild(d),w.appendChild(y),g.appendChild(w)}}}}mapToHtmlTable(e,n=!1){let t=this;try{t.damon.mapToJSON(e)}catch{throw new Error("Provided map value doesn't passes JSON.parse()")}var r=0,s=document.createElement("table"),a=document.createElement("thead"),f=document.createElement("tbody"),c=!1,u=0;if(s.className="DAMON-Table",typeof e!="object"||e==null||Array.isArray(e)||!(e instanceof Map)||e.constructor!==Map)throw new Error("Error List Item number "+r+": @param { {} } list");for(let[g,l]of e){if(typeof l=="object"&&l!==null&&!Array.isArray(l)&&l instanceof Map&&l.constructor===Map)if(g=="0"&&!c){let h=document.createElement("tr");u=l.length;for(let[p,y]of l)if(y===null){let d=document.createElement("th");n?t.websiteRegex.test(p)?d.innerHTML=P.sanitize(`<a href="${p}">${p}</a>`):d.innerHTML=`${p}`:t.websiteRegex.test(p)?d.innerHTML=P.sanitize(`<a href="${p}">${p}</a>`):d.textContent=`${p}`,h.appendChild(d)}else throw new Error("Expected implicit null property, saw otherwise");a.appendChild(h),c=!0}else{if(u==0&&(u=l.length),l.length!=u)throw new Error("Error List Item number "+r+": @param { {} } list");let h=document.createElement("tr");for(let[p,y]of l)if(y===null){let d=document.createElement("td");n?t.websiteRegex.test(p)?d.innerHTML=P.sanitize(`<a href="${p}">${p}</a>`):d.innerHTML=`${p}`:t.websiteRegex.test(p)?d.innerHTML=P.sanitize(`<a href="${p}">${p}</a>`):d.textContent=`${p}`,h.appendChild(d)}else throw new Error("Expected implicit null property, saw otherwise");f.appendChild(h)}else if(typeof l!="object"&&g=="00"){let h=document.createElement("caption");n?h.innerHTML=l:h.textContent=l,s.appendChild(h)}else throw new Error("Error List Item number "+r+": @param { {} } list");r++}return c&&s.appendChild(a),s.appendChild(f),s}mapTreeLeavesToHtmlTable(e,n=!1){let t=this;try{t.damon.mapToJSON(e)}catch{throw new Error("Provided map value doesn't passes JSON.parse()")}var r=0,s=0,a=document.createElement("table"),f=document.createElement("thead"),c=document.createElement("tbody"),u=!1;if(a.className="DAMON-LeavesToTable",typeof e!="object"||e==null||Array.isArray(e)||!(e instanceof Map)||e.constructor!==Map)throw new Error("Error List Item number "+r+": @param { {} } list");for(let[l,h]of e){if(typeof h=="object"&&!Array.isArray(h)){if(l=="head"&&!u){try{g(h,f)}catch{return}u=!0}else if(l=="body")try{g(h,c)}catch{return}}else if(typeof h!="object"&&l=="caption"){let p=document.createElement("caption");n?p.innerHTML=h:p.textContent=h,a.appendChild(p)}else throw new Error("Error List Item number "+r+": @param { {} } list");r++}return u&&a.appendChild(f),a.appendChild(c),a;function g(l,h,p=0,y=[]){if(typeof h!="object"||h==null)throw new Error("Error List Item number "+r+": @param { {} } list");if(typeof l=="object"&&l!==null&&!Array.isArray(l)&&l instanceof Map&&l.constructor===Map){if(h.tagName=="THEAD")if(Array.from(l.keys()).length==1)if(typeof l.get(Array.from(l.keys())[0])=="object"&&l.get(Array.from(l.keys())[0])!==null)r++,g(l.get(Array.from(l.keys())[0]),h,p+1,y.concat([Array.from(l.keys())[0]]));else throw new Error("Error List Item number "+r+": @param { {} } list");else throw new Error("Error List Item number "+r+": @param { {} } list");else if(h.tagName=="TBODY"){if(Array.from(l.keys()).length==0)throw new Error("Error List Item number "+r+": @param { {} } list");for(let[d,w]of l)if(typeof w=="object"&&w!==null)r++,g(w,h,p+1,y.concat([d]));else throw new Error("Error List Item number "+r+": @param { {} } list")}}else if(Array.isArray(l)){if(h.tagName=="THEAD")if(l.length==1){r++,s=p;let d=document.createElement("tr");y.push(l[0]);for(let w=0,A=y.length;w<A;w++){let N=document.createElement("th");n?N.innerHTML=y[w]:N.textContent=y[w],d.appendChild(N)}h.appendChild(d)}else throw new Error("Error List Item number "+r+": @param { {} } list");else if(h.tagName=="TBODY")if(p==s){if(l.length==0)throw new Error("Error List Item number "+r+": @param { {} } list");for(let d=0,w=l.length;d<w;d++){r++;let A=document.createElement("tr");for(let E=0,x=y.length;E<x;E++){let C=document.createElement("td");n?C.innerHTML=y[E]:C.textContent=y[E],A.appendChild(C)}let N=document.createElement("td");n?N.innerHTML=l[d]:N.textContent=l[d],N.textContent=l[d],A.appendChild(N),h.appendChild(A)}}else throw new Error("Error List Item number "+r+": @param { {} } list")}}}htmlToJSON(e){let n=this;var t=0;if(e.firstElementChild.textContent=="{}")return n._mapToJSON(r(e,new Map));if(e.firstElementChild.textContent=="[]")return n._mapToJSON(r(e,[]));function r(s,a){if(typeof s!="object"||s==null||Array.isArray(s))throw new Error("Error List Item number "+t+": @param { {} } list");if(typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map){for(let f=0,c=s.children.length;f<c;f++)if(t++,s.children[f].tagName=="LI")if(s.children[f].firstElementChild.tagName=="CODE")if(s.children[f].firstElementChild.innerHTML.length){let u=s.children[f].firstElementChild.innerHTML.trim();if(u[u.length-1]==":"&&u.length>1){let g=s.children[f].children[1];if(g.tagName=="UL"&&g.firstElementChild.tagName=="LI"&&g.children.length==1&&g.firstElementChild.firstElementChild.tagName=="CODE"){t++;let l=g.firstElementChild.firstElementChild.textContent.trim();l=="true"?a.set(u.slice(0,-1),!0):l=="false"?a.set(u.slice(0,-1),!1):l=="null"?a.set(u.slice(0,-1),null):isFinite(l)&&!isNaN(parseFloat(l))?a.set(u.slice(0,-1),l*1):a.set(u.slice(0,-1),l)}else throw new Error("Error List Item number "+t+": not DAMON-compliant.")}else if(u[u.length-4]==":"&&u.length>4){if(u.slice(-3)==" []")if(a.set(u.slice(0,-4),[]),s.children[f].children[1].tagName=="UL")r(s.children[f].children[1],a.get(u.slice(0,-4)));else throw new Error("Error List Item number "+t+": not DAMON-compliant.");else if(u.slice(-3)==" {}")if(a.set(u.slice(0,-4),new Map),s.children[f].children[1].tagName=="UL")r(s.children[f].children[1],a.get(u.slice(0,-4)));else throw new Error("Error List Item number "+t+": not DAMON-compliant.")}else throw new Error("Error List Item number "+t+": map items need a key")}else throw new Error("Error List Item number "+t+": empty node.");else throw new Error("Error List Item number "+t+": not DAMON-compliant.")}else if(Array.isArray(a)){for(let f=0,c=s.children.length;f<c;f++)if(t++,s.children[f].tagName=="LI")if(s.children[f].firstElementChild.tagName=="CODE")if(s.children[f].firstElementChild.innerHTML.length){let u=s.children[f].firstElementChild.innerHTML.trim();if(u[u.length-1]==":"&&u.length>1)throw new Error("Error List Item number "+t+": lists can't have keys.");if(u[u.length-4]==":"&&u.length>4)throw new Error("Error List Item number "+t+": not DAMON-compliant.");if(u=="[]")if(a.push([]),s.children[f].children[1]&&s.children[f].children[1].tagName=="UL")r(s.children[f].children[1],a[a.length-1]);else throw new Error("Error List Item number "+t+": not DAMON-compliant.");else if(u=="{}")if(a.push({}),s.children[f].children[1]&&s.children[f].children[1].tagName=="UL")r(s.children[f].children[1],a[a.length-1]);else throw new Error("Error List Item number "+t+": not DAMON-compliant.");else u=="true"?a.push(!0):u=="false"?a.push(!1):u=="null"?a.push(null):isFinite(u)&&!isNaN(parseFloat(u))?a.push(u*1):a.push(u)}else throw new Error("Error List Item number "+t+": empty node.");else throw new Error("Error List Item number "+t+": not DAMON-compliant.")}else throw new Error("Error List Item number "+t+": @param { {} | [] } jsonMap");return a}}implicitMapToSExpression(e){let n=this;var t="";if(typeof e=="object"&&e!==null&&e instanceof Map&&e.constructor===Map)return t+=`[\r
`,r(e),t+="]",JSON.parse(t),t;return typeof e=="string"&&(e='"'+e+'"'),JSON.parse(e),e;function r(s,a=1){if(typeof s=="object"&&s!==null&&!Array.isArray(s)&&s instanceof Map&&s.constructor===Map){let u=-1;for(let[g,l]of s){if(u++,typeof l=="object"&&l!==null)if(Array.isArray(l))l.length>0?(t+="    ".repeat(a)+`${JSON.stringify(g)}, [\r
`,r(l,a+1),t+="    ".repeat(a)+"]"):t+="    ".repeat(a)+`${JSON.stringify(g)}, []`;else if(Array.from(l.keys()).length>0){if(a==1)if(u==0)t="";else throw new Error("Multiple S-Expression roots");t+="    ".repeat(a)+`[${JSON.stringify(g)}, \r
`,r(l,a+1),a!=1&&(t+="    ".repeat(a)+"]")}else t+="    ".repeat(a)+`${JSON.stringify(g)}, []`;else{if(l===!0)throw new Error("Booleans require quotes");if(l===!1)throw new Error("Booleans require quotes");l===null?t+="    ".repeat(a)+`${JSON.stringify(g)}`:Number.isFinite(l)&&!Number.isNaN(l)?t+="    ".repeat(a)+`${JSON.stringify(g)}, `+l:t+="    ".repeat(a)+`${JSON.stringify(g)}, "${l}"`}g!=Array.from(s.keys())[Array.from(s.keys()).length-1]?t+=`,\r
`:t+=`\r
`}}else if(Array.isArray(s))for(var f=0,c=s.length;f<c;f++){if(typeof s[f]=="object"&&s[f]!==null)Array.isArray(s[f])?s[f].length>0?(t+="    ".repeat(a)+`[\r
`,r(s[f],a+1),t+="    ".repeat(a)+"]"):t+="    ".repeat(a)+"[]":Array.from(s[f].keys()).length>0?(t+="    ".repeat(a)+`[\r
`,r(s[f],a+1),t+="    ".repeat(a)+"]"):t+="    ".repeat(a)+"[]";else{if(s[f]===!0)throw new Error("Booleans require quotes");if(s[f]===!1)throw new Error("Booleans require quotes");if(s[f]===null)throw new Error("Array-nulls require quotes");Number.isFinite(s[f])&&!Number.isNaN(s[f])?t+="    ".repeat(a)+s[f]:t+="    ".repeat(a)+JSON.stringify(s[f])}f!=c-1?t+=`,\r
`:t+=`\r
`}}}damonToMathJs(e){let n=this,t="",r=n.damon.damonToMap(e);if(Array.isArray(r))return t+=`(\r
`,a(r),t+=")",t;return typeof r=="object"&&r!==null&&r instanceof Map&&r.constructor===Map?(t+=`(\r
`,a(r),t+=")",t):(typeof r=="string"&&(r=JSON.stringify(r)),JSON.parse(r),r);function s(f){return f[0].toLowerCase+f.slice(1)}function a(f,c=1){if(typeof f=="object"&&f!==null&&!Array.isArray(f)&&f instanceof Map&&f.constructor===Map)for(let[l,h]of f)typeof h=="object"&&h!==null?Array.isArray(h)?h.length>0?(t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"(\r
`,a(h,c+1),t+="    ".repeat(c)+")"):t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"()`:Array.from(h.keys()).length>0?(t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"(\r
`,a(h,c+1),t+="    ".repeat(c)+")"):t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"()`:h===!0?t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"(true)`:h===!1?t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"(false)`:h===null?t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"(null)`:Number.isFinite(h)&&!Number.isNaN(h)?t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"(`+h+")":t+="    ".repeat(c)+`"${JSON.stringify(s(l))}"("`+JSON.stringify(h)+'")',l!=Array.from(f.keys())[Array.from(f.keys()).length-1]?t+=`,\r
`:t+=`\r
`;else if(Array.isArray(f))for(var u=0,g=f.length;u<g;u++)typeof f[u]=="object"&&f[u]!==null?Array.isArray(f[u])?f[u].length>0?f.damonInlineArrays!==void 0&&f.damonInlineArrays.indexOf(u)>-1?t+="    ".repeat(c)+JSON.stringify(f[u]):(t+="    ".repeat(c)+`(\r
`,a(f[u],c+1),t+="    ".repeat(c)+")"):t+="    ".repeat(c)+"()":Array.from(f[u].keys()).length>0?(t+="    ".repeat(c)+`(\r
`,a(f[u],c+1),t+="    ".repeat(c)+")"):t+="    ".repeat(c)+"()":f[u]===!0?t+="    ".repeat(c)+"true":f[u]===!1?t+="    ".repeat(c)+"false":f[u]===null?t+="    ".repeat(c)+"null":Number.isFinite(f[u])&&!Number.isNaN(f[u])?t+="    ".repeat(c)+f[u]:t+="    ".repeat(c)+`"${JSON.stringify(s(f[u]))}"`,u!=g-1?t+=`,\r
`:t+=`\r
`}}_mapsDiff(e,n){let t=this;try{t.damon.mapToJSON(e),t.damon.mapToJSON(n)}catch{throw new Error("Provided map value doesn't passes JSON.parse()")}if(typeof e!=typeof n||typeof e=="object"&&e!==null&&!Array.isArray(e)&&e instanceof Map&&e.constructor===Map&&(n==null||Array.isArray(n)||!(n instanceof Map)||n.constructor!==Map))throw new Error("Different root types.");var r;if(typeof e=="object"&&e!==null&&!Array.isArray(e)&&e instanceof Map&&e.constructor===Map)return r=new Map,s(e),r;if(Array.isArray(e))return r=[],s(e),r;function s(a,f=[]){if(typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map){let c="",u=null,g=n;for(let p=0,y=f.length;p<y;p++)typeof g=="object"&&g!==null&&!Array.isArray(g)&&g instanceof Map&&g.constructor===Map?g=g.get(Array.from(g.keys())[f[p]]):g=g[f[p]];let l=r;for(let p=0,y=f.length;p<y;p++)typeof l=="object"&&l!==null&&!Array.isArray(l)&&l instanceof Map&&l.constructor===Map&&Array.from(l.keys()).length?l=l.get(Array.from(l.keys())[f[p]]):l=l[f[p]];let h=0;for(let[p,y]of a)h>Array.from(g.keys()).length-1?typeof y=="object"&&y!==null&&!Array.isArray(y)&&y instanceof Map&&y.constructor===Map?Array.from(g.keys()).indexOf(p)!==-1&&typeof g.get(p)=="object"&&g.get(p)!==null&&!Array.isArray(g.get(p))&&g.get(p)instanceof Map&&g.get(p).constructor===Map?l.set(h+"-yellow",null):l.set(h+"-red",null):Array.isArray(y)?Array.from(g.keys()).indexOf(p)!==-1&&Array.isArray(g.get(p))?l.set(h+"-yellow",null):l.set(h+"-red",null):Array.from(g.keys()).indexOf(p)!==-1&&y===g.get(p)?l.set(h+"-yellow",null):l.set(h+"-red",null):(c=Array.from(g.keys())[h],u=g.get(c),typeof y=="object"&&y!==null&&!Array.isArray(y)&&y instanceof Map&&y.constructor===Map?typeof u=="object"&&u!==null&&!Array.isArray(u)&&u instanceof Map&&u.constructor===Map&&p===c?(l.set(h+"-green",new Map),Array.from(y.keys()).length>0&&s(y,f.concat([h]))):l.set(h+"-red",null):Array.isArray(y)?Array.isArray(u)&&p===c?(l.set(h+"-green",[]),y.length>0&&s(y,f.concat([h]))):l.set(h+"-red",null):y===u&&p===c?l.set(h+"-green","green"):l.set(h+"-red",null)),h++;if(Array.from(a.keys()).length<Array.from(g.keys()).length){let p=0;for(let[y,d]of g){if(p<=h-1){p++;continue}typeof d=="object"&&d!==null&&!Array.isArray(d)&&d instanceof Map&&d.constructor===Map?Array.from(a.keys()).indexOf(y)!==-1&&typeof a.get(y)=="object"&&a.get(y)!==null&&!Array.isArray(a.get(y))&&a.get(y)instanceof Map&&a.get(y).constructor===Map?l.set(h+"-yellow",null):l.set(h+"-red",null):Array.isArray(d)?Array.from(a.keys()).indexOf(y)!==-1&&Array.isArray(a.get(y))?l.set(h+"-yellow",null):l.set(h+"-red",null):Array.from(a.keys()).indexOf(y)!==-1&&d===a.get(y)?l.set(h+"-yellow",null):l.set(h+"-red",null),p++}}}else{let c=null,u=n;for(let l=0,h=f.length;l<h;l++)typeof u=="object"&&u!==null&&!Array.isArray(u)&&u instanceof Map&&u.constructor===Map&&Array.from(u.keys()).length?u=u.get(Array.from(u.keys())[f[l]]):u=u[f[l]];let g=r;for(let l=0,h=f.length;l<h;l++)typeof g=="object"&&g!==null&&!Array.isArray(g)&&g instanceof Map&&g.constructor===Map&&Array.from(g.keys()).length?g=g.get(Array.from(g.keys())[f[l]]):g=g[f[l]];for(let l=0,h=a.length;l<h;l++)l>u.length-1?g[l]="red":(c=u[l],typeof a[l]=="object"&&a[l]!==null&&!Array.isArray(a[l])&&a[l]instanceof Map&&a[l].constructor===Map?typeof c=="object"&&c!==null&&!Array.isArray(c)&&c instanceof Map&&c.constructor===Map?(g[l]=new Map,Array.from(a[l].keys()).length>0&&s(a[l],f.concat([l]))):g[l]="red":Array.isArray(a[l])?Array.isArray(c)?(g[l]=[],a[l].length>0&&s(a[l],f.concat([l]))):g[l]="red":a[l]===c?g[l]="green":g[l]="red");if(a.length<u.length)for(let l=0,h=u.length;l<h;l++)l<=a.length-1||(g[l]="red")}}}sortMap(e,n){let t=this,r=Array.from(e.keys()),s=Array.from(n.keys()),a=new Map;for(let f=0,c=r.length;f<c;f++)n.get(r[f])!==void 0&&a.set(r[f],n.get(r[f]));for(let f=0,c=s.length;f<c;f++)r.indexOf(s[f])==-1&&a.set(s[f],n.get(s[f]));return a}renderDiff(e,n,t=!1){let r=this,s=document.createElement("div"),a=document.createElement("div"),f=document.createElement("ul"),c=r._mapsDiff(e,n);return s.className="DAMON-Diff",a.className="DAMON-Diff-legend",f.className="DAMON-List",a.innerHTML='<span id="damonDiffRed"><span>Red</span>: Difference</span>; <span id="damonDiffBlue"><span>Blue</span>: Addition</span>; <span id="damonDiffGreen"><span>Green</span>: Displacement</span>',u(c,f),s.appendChild(a),s.appendChild(f),s;function u(l,h,p=[],y="green"){if(y==="green"){if(typeof h!="object"||h==null||Array.isArray(h))throw new Error("Error List Item "+p.concat("-")+": @param { {} } list");if(typeof l=="object"&&l!==null&&!Array.isArray(l)&&l instanceof Map&&l.constructor===Map){if(h.tagName=="UL"){let A="",N=null,E=e;for(let o=0,L=p.length;o<L;o++)typeof E=="object"&&E!==null&&!Array.isArray(E)&&E instanceof Map&&E.constructor===Map?E=E.get(Array.from(E.keys())[p[o]]):E=E[p[o]];let x="",C=null,T=n;for(let o=0,L=p.length;o<L;o++)typeof T=="object"&&T!==null&&!Array.isArray(T)&&T instanceof Map&&T.constructor===Map?T=T.get(Array.from(T.keys())[p[o]]):T=T[p[o]];let m=0;for(let[o,L]of l){let S=Array.from(l.keys())[m].split("-")[1],_=l.get(Array.from(l.keys())[m]),D=document.createElement("ul"),k=document.createElement("code"),I=document.createElement("span"),$=document.createElement("li");if(I.className="type-key",$.className=S+"-diff",$.className==="red-diff"&&m<=Array.from(E.keys()).length-1?m>Array.from(T.keys()).length-1?(o="",L=""):(m>Array.from(E.keys()).length-1&&($.className="blue-diff",$.setAttribute("aria-describedby","damonDiffBlue")),x=Array.from(T.keys())[m],C=T.get(x),o=x,L=C):$.className==="green-diff"?($.dataset.graphArbo=m,p.length>0&&($.dataset.graphArbo=p.join("-")+"-"+m),$.className="",A=Array.from(T.keys())[m],N=T.get(A),o=A,L=N):$.className==="yellow-diff"?m>Array.from(E.keys()).length-1?($.className="green-diff",$.setAttribute("aria-describedby","damonDiffGreen"),A=Array.from(T.keys())[m],N=T.get(A),o=A,L=N):(o="",L="",$.className="red-diff",$.setAttribute("aria-describedby","damonDiffRed")):($.className="blue-diff",$.setAttribute("aria-describedby","damonDiffBlue"),A=Array.from(T.keys())[m],N=T.get(A),o=A,L=N),$.className==="red-diff"&&$.setAttribute("aria-describedby","damonDiffRed"),r.websiteRegex.test(o)){let M=o;r.httpRegex.test(o)||(M="https://"+o);let U=P.sanitize(`<a href="${M}">${M}</a>`);I.innerHTML=U}else I.textContent=o;if(typeof L=="object"&&L!==null)if(Array.isArray(L))if(e.damonInlineArrays!==void 0&&e.damonInlineArrays.indexOf(o)>-1){k.innerHTML=I.outerHTML+": [";for(let M=0,U=L.length;M<U;M++){let F=document.createElement("span"),G=L[M];if(G===!0)F.textContent="true",F.className="type-boolean";else if(G===!1)F.textContent="false",F.className="type-boolean";else if(G===null)F.textContent="null",F.className="type-null";else if(Number.isFinite(G)&&!Number.isNaN(G))F.textContent=G+"",F.className="type-number";else{if(t)if(r.websiteRegex.test(G)){let re=G;r.httpRegex.test(G)||(re="https://"+G),F.innerHTML=P.sanitize(`<a href="${re}">"${re}"</a>`)}else F.innerHTML=`"${G}"`;else if(r.websiteRegex.test(G)){let re=G;r.httpRegex.test(G)||(re="https://"+G),F.innerHTML=P.sanitize(`<a href="${re}">"${re}"</a>`)}else F.textContent=`"${G}"`;F.className="type-string"}M!==0&&(k.innerHTML+=", "),k.appendChild(F)}k.innerHTML+="]",$.appendChild(k),$.appendChild(D),h.appendChild($)}else k.innerHTML=I.outerHTML+": []",$.appendChild(k),$.appendChild(D),h.appendChild($),S=="green"?u(_,D,p.concat([m]),S):u(_,D,p.concat([m]),S);else e.implicitMaps!==void 0&&e.implicitMaps.indexOf(o)>-1?k.innerHTML=I.outerHTML:k.innerHTML=I.outerHTML+": {}",$.appendChild(k),$.appendChild(D),h.appendChild($),S=="green"?u(_,D,p.concat([m]),S):u(_,D,p.concat([m]),S);else{k.innerHTML=I.outerHTML+": ";let M=document.createElement("span"),U=L;if(U===!0)M.textContent="true",M.className="type-boolean";else if(U===!1)M.textContent="false",M.className="type-boolean";else if(U===null)M.textContent="null",M.className="type-null";else if(Number.isFinite(U)&&!Number.isNaN(U))M.textContent=U+"",M.className="type-number";else{if(t)if(r.websiteRegex.test(U)){let F=U;r.httpRegex.test(U)||(F="https://"+U),M.innerHTML=P.sanitize(`<a href="${F}">"${F}"</a>`)}else M.innerHTML=`"${U}"`;else if(r.websiteRegex.test(U)){let F=U;r.httpRegex.test(U)||(F="https://"+U),M.innerHTML=P.sanitize(`<a href="${F}">"${F}"</a>`)}else M.textContent=`"${U}"`;M.className="type-string"}e.implicitNulls===void 0||e.implicitNulls.indexOf(o)==-1?k.appendChild(M):k.innerHTML=k.innerHTML.slice(0,-2),$.appendChild(k),h.appendChild($)}m++}}}else if(Array.isArray(l)){let A=null,N=e;for(let C=0,T=p.length;C<T;C++)typeof N=="object"&&N!==null&&!Array.isArray(N)&&N instanceof Map&&N.constructor===Map&&Array.from(N.keys()).length?N=N.get(Array.from(N.keys())[p[C]]):N=N[p[C]];let E=null,x=n;for(let C=0,T=p.length;C<T;C++)typeof x=="object"&&x!==null&&!Array.isArray(x)&&x instanceof Map&&x.constructor===Map&&Array.from(x.keys()).length?x=x.get(Array.from(x.keys())[p[C]]):x=x[p[C]];for(var d=0,w=l.length;d<w;d++){let C=l[d].split("-")[1],T=document.createElement("ul"),m=document.createElement("code"),o=document.createElement("li"),L;if(o.className=l[d].split("-")[1]+"-diff",o.className==="red-diff"&&d<=N.length-1?d>x.length-1?L="":(d>N.length-1&&(o.className=="red-diff"?(o.className="blue-diff",o.setAttribute("aria-describedby","damonDiffBlue")):(o.className="green-diff",o.setAttribute("aria-describedby","damonDiffGreen"))),L=x[d]):(o.className==="green-diff"?(o.dataset.graphArbo=d,p.length>0&&(o.dataset.graphArbo=p.join("-")+"-"+d),o.className=""):(o.className="blue-diff",o.setAttribute("aria-describedby","damonDiffBlue")),L=N[d]),o.className==="red-diff"&&o.setAttribute("aria-describedby","damonDiffRed"),typeof L=="object"&&L!==null)if(Array.isArray(L))if(e.damonInlineArrays!==void 0&&e.damonInlineArrays.indexOf(d)>-1){m.innerHTML+="[";for(let S=0,_=L.length;S<_;S++){let D=document.createElement("span"),k=L[S];if(k===!0)D.textContent="true",D.className="type-boolean";else if(k===!1)D.textContent="false",D.className="type-boolean";else if(k===null)D.textContent="null",D.className="type-null";else if(Number.isFinite(k)&&!Number.isNaN(k))D.textContent=k+"",D.className="type-number";else{if(t)if(r.websiteRegex.test(k)){let I=k;r.httpRegex.test(k)||(I="https://"+k),D.innerHTML=P.sanitize(`<a href="${I}">"${I}"</a>`)}else D.innerHTML=`"${k}"`;else if(r.websiteRegex.test(k)){let I=k;r.httpRegex.test(k)||(I="https://"+k),D.innerHTML=P.sanitize(`<a href="${I}">"${I}"</a>`)}else D.textContent=`"${k}"`;D.className="type-string"}S!==0&&(m.innerHTML+=", "),m.appendChild(valueSpan)}m.innerHTML+="]",o.appendChild(m),o.appendChild(T),h.appendChild(o)}else m.textContent="[]",o.appendChild(m),o.appendChild(T),h.appendChild(o),u(L,T,p.concat([d]),C);else m.textContent="{}",o.appendChild(m),o.appendChild(T),h.appendChild(o),u(L,T,p.concat([d]),C);else{let S=L;if(S===!0)m.textContent="true",m.className="type-boolean";else if(S===!1)m.textContent="false",m.className="type-boolean";else if(S===null)m.textContent="null",m.className="type-null";else if(Number.isFinite(S)&&!Number.isNaN(S))m.textContent=S+"",m.className="type-number";else{if(t)if(r.websiteRegex.test(S)){let _=S;r.httpRegex.test(S)||(_="https://"+S),m.innerHTML=P.sanitize(`<a href="${_}">"${_}"</a>`)}else m.innerHTML=`"${S}"`;else if(r.websiteRegex.test(S)){let _=S;r.httpRegex.test(S)||(_="https://"+S),m.innerHTML=P.sanitize(`<a href="${_}">"${_}"</a>`)}else m.textContent=`"${S}"`;m.className="type-string"}o.appendChild(m),o.appendChild(T),h.appendChild(o)}}}}else if(["red","yellow"].indexOf(y)>-1){let A="",N=null,E=n;for(let x=0,C=p.length;x<C;x++)typeof E=="object"&&E!==null&&!Array.isArray(E)&&E instanceof Map&&E.constructor===Map?E=E.get(Array.from(E.keys())[p[x]]):E=E[p[x]];g(E,h,p,y)}}function g(l,h,p,y){if(typeof h!="object"||h==null||Array.isArray(h))throw new Error("Error List Item "+p.concat("-")+": @param { {} } list");if(typeof l=="object"&&l!==null&&!Array.isArray(l)&&l instanceof Map&&l.constructor===Map){if(h.tagName=="UL"){let A=0;for(let[N,E]of l){let x=document.createElement("ul"),C=document.createElement("code"),T=document.createElement("span"),m=document.createElement("li");if(T.className="type-key",m.className="red-diff",m.setAttribute("aria-describedby","damonDiffRed"),r.websiteRegex.test(N)){let o=N;r.httpRegex.test(N)||(o="https://"+N);let L=P.sanitize(`<a href="${o}">${o}</a>`);T.innerHTML=L}else T.textContent=N;if(typeof E=="object"&&E!==null)if(Array.isArray(E))if(l.damonInlineArrays!==void 0&&l.damonInlineArrays.indexOf(N)>-1){C.innerHTML=T.outerHTML+": [";for(let o=0,L=E.length;o<L;o++){let S=document.createElement("span"),_=E[o];if(_===!0)S.textContent="true",S.className="type-boolean";else if(_===!1)S.textContent="false",S.className="type-boolean";else if(_===null)S.textContent="null",S.className="type-null";else if(Number.isFinite(_)&&!Number.isNaN(_))S.textContent=_+"",S.className="type-number";else{if(t)if(r.websiteRegex.test(_)){let D=_;r.httpRegex.test(_)||(D="https://"+_),S.innerHTML=P.sanitize(`<a href="${D}">"${D}"</a>`)}else S.innerHTML=`"${_}"`;else if(r.websiteRegex.test(_)){let D=_;r.httpRegex.test(_)||(D="https://"+_),S.innerHTML=P.sanitize(`<a href="${D}">"${D}"</a>`)}else S.textContent=`"${_}"`;S.className="type-string"}o!==0&&(C.innerHTML+=", "),C.appendChild(S)}C.innerHTML+="]",m.appendChild(C),m.appendChild(x),h.appendChild(m)}else C.innerHTML=T.outerHTML+": []",m.appendChild(C),m.appendChild(x),h.appendChild(m),recurse(E,x,p.concat([A]),y);else l.implicitMaps!==void 0&&l.implicitMaps.indexOf(N)>-1?C.innerHTML=T.outerHTML:C.innerHTML=T.outerHTML+": {}",m.appendChild(C),m.appendChild(x),h.appendChild(m),g(E,x,p.concat([A]),y);else{C.innerHTML=T.outerHTML+": ";let o=document.createElement("span"),L=E;if(L===!0)o.textContent="true",o.className="type-boolean";else if(L===!1)o.textContent="false",o.className="type-boolean";else if(L===null)o.textContent="null",o.className="type-null";else if(Number.isFinite(L)&&!Number.isNaN(L))o.textContent=L+"",o.className="type-number";else{if(t)if(r.websiteRegex.test(L)){let S=L;r.httpRegex.test(L)||(S="https://"+L),o.innerHTML=P.sanitize(`<a href="${S}">"${S}"</a>`)}else o.innerHTML=`"${L}"`;else if(r.websiteRegex.test(L)){let S=L;r.httpRegex.test(L)||(S="https://"+L),o.innerHTML=P.sanitize(`<a href="${S}">"${S}"</a>`)}else o.textContent=`"${L}"`;o.className="type-string"}l.implicitNulls===void 0||l.implicitNulls.indexOf(N)==-1?C.appendChild(o):C.innerHTML=C.innerHTML.slice(0,-2),m.appendChild(C),h.appendChild(m)}A++}}}else if(Array.isArray(l))for(var d=0,w=l.length;d<w;d++){let A=document.createElement("ul"),N=document.createElement("code"),E=document.createElement("li");if(E.className=l[d]+"-diff",E.setAttribute("aria-describedby","damonDiffRed"),typeof l[d]=="object"&&l[d]!==null)if(Array.isArray(l[d]))if(l.damonInlineArrays!==void 0&&l.damonInlineArrays.indexOf(d)>-1){N.innerHTML+="[";for(let x=0,C=l[d].length;x<C;x++){let T=document.createElement("span"),m=l[d][x];if(m===!0)T.textContent="true",T.className="type-boolean";else if(m===!1)T.textContent="false",T.className="type-boolean";else if(m===null)T.textContent="null",T.className="type-null";else if(Number.isFinite(m)&&!Number.isNaN(m))T.textContent=m+"",T.className="type-number";else{if(t)if(r.websiteRegex.test(m)){let o=m;r.httpRegex.test(m)||(o="https://"+m),T.innerHTML=P.sanitize(`<a href="${o}">"${o}"</a>`)}else T.innerHTML=`"${m}"`;else if(r.websiteRegex.test(m)){let o=m;r.httpRegex.test(m)||(o="https://"+m),T.innerHTML=P.sanitize(`<a href="${o}">"${o}"</a>`)}else T.textContent=`"${m}"`;T.className="type-string"}x!==0&&(N.innerHTML+=", "),N.appendChild(T)}N.innerHTML+="]",E.appendChild(N),E.appendChild(A),h.appendChild(E)}else N.textContent="[]",E.appendChild(N),E.appendChild(A),h.appendChild(E),g(l[d],A,p.concat([d]),y);else N.textContent="{}",E.appendChild(N),E.appendChild(A),h.appendChild(E),g(l[d],A,p.concat([d]),y);else{let x=l[d];if(x===!0)N.textContent="true",N.className="type-boolean";else if(x===!1)N.textContent="false",N.className="type-boolean";else if(x===null)N.textContent="null",N.className="type-null";else if(Number.isFinite(x)&&!Number.isNaN(x))N.textContent=x+"",N.className="type-number";else{if(t)if(r.websiteRegex.test(x)){let C=x;r.httpRegex.test(x)||(C="https://"+x),N.innerHTML=P.sanitize(`<a href="${C}">"${C}"</a>`)}else N.innerHTML=`"${x}"`;else if(r.websiteRegex.test(x)){let C=x;r.httpRegex.test(x)||(C="https://"+x),N.innerHTML=P.sanitize(`<a href="${C}">"${C}"</a>`)}else N.textContent=`"${x}"`;N.className="type-string"}E.appendChild(N),E.appendChild(A),h.appendChild(E)}}}}damonTableToCSV(e){let t=this.damon.damonToMap(e),r="",s=0;for(let[a,f]of t){if(s===0&&a==="00"){r+='"'+f+`"
`,s++;continue}let c=Array.from(f.keys());for(let u=0,g=c.length;u<g;u++)r+='"'+c[u]+'"',u!=g-1&&(r+=",");r+=`
`,s++}return r.slice(0,-1)}csvToDamonTable(e){let n=this,t=e.split(`
`),r=new Map;for(let s=0,a=t.length;s<a;s++){let f=new Map;f.implicitNulls=[],r.set(s+"",f);let c=t[s].split(",");for(let u=0,g=c.length;u<g;u++)if(c[u][0]==='"'&&c[u][c[u].length-1]==='"')try{r.get(s+"").set(JSON.parse(c[u]),null),r.get(s+"").implicitNulls.push(c[u])}catch{r.get(s+"").set(JSON.parse(JSON.stringify(c[u].slice(1,-1))),null),r.get(s+"").implicitNulls.push(JSON.parse(JSON.stringify(c[u].slice(1,-1))))}else try{r.get(s+"").set(JSON.parse(`"${c[u]}"`),null),r.get(s+"").implicitNulls.push(`"${c[u]}"`)}catch{r.get(s+"").set(JSON.parse(JSON.stringify(c[u])),null),r.get(s+"").implicitNulls.push(JSON.stringify(c[u]))}}return n.damon.mapToDamon(r)}wrapListContentsForStyling(e){let n=this;for(let t=0,r=e.length;t<r;t++){let s=document.createElement("div");for(let a=e[t].childNodes.length-1;a>=0;a--)(e[t].childNodes[a].tagName&&e[t].childNodes[a].tagName!=="UL"||e[t].childNodes[a].nodeType==3&&e[t].childNodes[a].data!=`
`&&e[t].childNodes[a].data!=`\r
`)&&(s.childNodes.length==0?s.appendChild(e[t].childNodes[a]):s.insertBefore(e[t].childNodes[a],s.childNodes[0]));e[t].firstElementChild?e[t].insertBefore(s,e[t].firstElementChild):e[t].appendChild(s)}}addLineNumbers(e,n,t,r=0){let s=this;for(let a=0,f=e.length;a<f;a++){let c=document.createElement("div");c.className="damon-line-number";let u=s.damon.damonToMap(n),g=e[a].dataset.graphArbo.split("-"),l=[];for(let h=0,p=g.length;h<p;h++)typeof u=="object"&&u!==null&&!Array.isArray(u)&&u instanceof Map&&u.constructor===Map?(l.push(Array.from(u.keys())[g[h]]),u=l[l.length-1]):(l.push(parseInt(g[h])),u=u[g[h]]);c.textContent=s.damon.getRangeFromPath(n,l)[0][0]+1+r,c.id="damonLine"+c.textContent,e[a].setAttribute("aria-labelledBy",c.id),c.style.left="7px",c.style.top=t.scrollTop+e[a].firstElementChild.getBoundingClientRect().top-t.getBoundingClientRect().top+"px",t.appendChild(c)}}}});var Br=se((jn,Fr)=>{var Zn=sn(lt());Fr.exports=function(i){i.update(),i.historyUpdate(),window.addEventListener("load",e),i.editor.addEventListener("focusin",n),i.editor.addEventListener("focusout",t),i.gutter.addEventListener("click",r),document.addEventListener("mousedown",a),document.addEventListener("mousemove",f),document.addEventListener("mouseup",c),document.addEventListener("selectionchange",u),i.textarea.addEventListener("beforeinput",g),i.textarea.addEventListener("keydown",l),i.textarea.addEventListener("cut",h),i.textarea.addEventListener("copy",p),i.textarea.addEventListener("paste",y);function e(N){i.overlay.firstElementChild.innerHTML="",i.gutter.innerHTML="",i.update(),i.updateCurrentLine(),i.initialized=!0}function n(N){i.utils.addDataState(i.editor,"focused")}function t(N){i.editor.contains(N.target)||i.utils.removeDataState(i.editor,"focused")}function r(N){(Array.from(i.gutter.children).indexOf(N.target)>-1||Array.from(i.gutter.children).indexOf(N.target.parentNode)>-1)&&i.setCarretAt(parseInt(N.target.textContent.trim())-1)}var s;function a(N){if(N.target==i.container){s=N.target,N.preventDefault();let E=i.gutter.children,x="0";for(let C=0,T=E.length;C<T;C++)N.clientY>E[C].getBoundingClientRect().y&&(x=E[C].textContent.trim());x-1<0&&(x=1),i.setCarretAt(x-1),i.textarea.focus()}}function f(N){if(s==i.container&&N.buttons==1){let E=i.gutter.children,x="0";for(let C=0,T=E.length;C<T;C++)N.clientY>E[C].getBoundingClientRect().y&&(x=E[C].textContent.trim());i.textarea.focus(),i.textarea.setSelectionRange(i.textarea.value.split(`
`).slice(0,x).join().length,i.textarea.value.length,"backward")}}function c(N){s==i.container&&N.target==i.textarea&&(i.textarea.selectionEnd=i.textarea.value.length,i.textarea.selectionStart=i.textarea.value.length,i.textarea.focus()),s=void 0}function u(N){document.activeElement===i.textarea&&(i.updateCaret(),i.updateCurrentLine(),i.updateHorizontalScroll(),i.lastSelection=i.getTextareaSelection())}function g(N){i.lastTextareaValue=i.textarea.value}function l(N){if(!N.ctrlKey&&!N.shiftKey&&!N.altKey){if(N.key==" "&&i.textarea.selectionStart==i.textarea.selectionEnd&&(!/\n/.test(i.textarea.value.slice(0,i.textarea.selectionStart))&&(/ +$/.test(i.textarea.value.slice(0,i.textarea.selectionStart))||i.textarea.selectionStart===0)||/\n +$/.test(i.textarea.value.slice(0,i.textarea.selectionStart))||i.textarea.selectionStart<i.textarea.value.length&&(/\n +\n$/.test(i.textarea.value.slice(0,i.textarea.selectionStart+1))||/\n$/.test(i.textarea.value.slice(0,i.textarea.selectionStart)))||i.textarea.value.length==i.textarea.selectionStart&&(/\n +$/.test(i.textarea.value)||/\n$/.test(i.textarea.value)))){N.preventDefault();let E=i.textarea.selectionStart+4,x=i.textarea.value.slice(0,i.textarea.selectionStart)+"    "+i.textarea.value.slice(i.textarea.selectionEnd);i.setTextarea(x,E),d()}if(N.key=="Enter"){let E=i.textarea.value,x=E.split(`
`),C=i.getSelectionStartCoordinates(),T=C[0],m=C[1],o=x[T];if(/^    /.test(o)){if(N.preventDefault(),m%4!==0&&m<o.match(/^(    )+/)[0].length){for(let k=m;0<=k;k--)if(k%4==0){i.textarea.selectionStart==i.textarea.selectionEnd&&(i.textarea.selectionEnd=x.slice(0,T).join().length+k),i.textarea.selectionStart=x.slice(0,T).join().length+k,m=k;break}}let L=0;m>0&&(L=o.slice(0,m).match(/^(    )+/)[0].length);let S=i.textarea.selectionStart,_=i.textarea.value.slice(i.textarea.selectionEnd);_.split(`
`)[0].trim()==""&&(_=`
`+_.split(`
`).slice(1).join(`
`));let D=i.textarea.value.slice(0,i.textarea.selectionStart)+`
`+" ".repeat(L)+_;i.setTextarea(D,S+L+1),d()}}}else if(!N.ctrlKey&&N.shiftKey&&!N.altKey)N.key==" "&&i.textarea.selectionStart==i.textarea.selectionEnd;else if(N.ctrlKey&&!N.shiftKey&&!N.altKey){if(N.key=="Backspace"){let E=i.textarea.value.split(`
`),x=i.getSelectionStartCoordinates(),C=E[x[0]],T=C.slice(0,x[1]);if(i.textarea.selectionEnd==i.textarea.selectionStart&&/^ +$/.test(T)){N.preventDefault();let m=0;T.length%4==0?(E[x[0]]=C.slice(4),m=4):(E[x[0]]=C.slice(T.length%4),m=T.length%4),i.setTextarea(E.join(`
`)),d(),i.setCarretAt(x[0],x[1]-m)}}if(N.key==" "){let E=i.textarea.value.slice(0,i.textarea.selectionStart)+"	"+i.textarea.value.slice(i.textarea.selectionEnd);i.setTextarea(i.formatIndentation(E),i.textarea.selectionEnd+1),d()}if(N.key=="]"){N.preventDefault();let E=i.textarea.value.split(`
`),x=i.textarea.value.slice(0,i.textarea.selectionStart).split(`
`).length-1,C=i.textarea.value.slice(0,i.textarea.selectionEnd).split(`
`).length-1,T=i.textarea.selectionStart+4,m=i.textarea.selectionEnd+4*(C-x+1);for(let o=0,L=E.length;o<L;o++)o>=x&&o<=C&&(E[o]="    "+E[o]);i.setTextarea(E.join(`
`),T,m),d()}if(N.key=="["){let E=i.textarea.value,x=i.textarea.value.split(`
`),C=i.textarea.value.slice(0,i.textarea.selectionStart).split(`
`).length-1,T=i.textarea.value.slice(0,i.textarea.selectionEnd).split(`
`).length-1,m=i.textarea.selectionStart,o=i.textarea.selectionEnd;for(let L=0,S=x.length;L<S;L++)L>=C&&L<=T&&x[L].startsWith("    ")&&(L==C&&(m-=4),o-=4,x[L]=x[L].slice(4));i.setTextarea(x.join(`
`),m,o),d()}if(N.key=="Enter"){let E=i.textarea.value.split(`
`),x=i.getCurrentLine();x==E.length-1?i.setTextarea(E.join(`
`)+`
`):i.setTextarea(E.slice(0,x+1).join(`
`)+`

`+E.slice(x+1).join(`
`)),d(),i.setCarretAt(x+1)}if(N.key=="z"&&(N.preventDefault(),i.historyPosition>1)){i.historyPosition-=1;let E=i.history[i.historyPosition-1];i.setTextarea(E[0],E[1]),i.update(),i.virtualScroller.inputHandler(!0),i.textarea.blur(),i.textarea.focus()}if(N.key=="y"&&(N.preventDefault(),i.historyPosition<i.history.length)){i.historyPosition+=1;let E=i.history[i.historyPosition-1];i.setTextarea(E[0],E[1]),i.update(),i.virtualScroller.inputHandler(!0),i.textarea.blur(),i.textarea.focus()}}else if(!N.ctrlKey&&N.shiftKey&&N.altKey)N.key=="f"&&i.setTextarea(i.formatIndentation(i.textarea.value),i.textarea.selectionEnd);else if(!N.ctrlKey&&!N.shiftKey&&N.altKey){if(N.key=="ArrowDown")if(i.getSelectionStartCoordinates()[0]==i.getSelectionEndCoordinates()[0]){let E=i.textarea.value.split(`
`),x=i.getCurrentLine(),C=E[i.getCurrentLine()].slice();if(i.getCurrentLine()!==E.length){let T=E[i.getCurrentLine()+1].slice();E[i.getCurrentLine()]=T,E[i.getCurrentLine()+1]=C,i.setTextarea(E.join(`
`)),d(),i.setCarretAt(x+1)}}else{let E=i.textarea.value.split(`
`),x=i.getSelectionStartCoordinates()[0],C=i.getSelectionEndCoordinates()[0];if(C<x&&(x=i.getSelectionEndCoordinates()[0],C=i.getSelectionStartCoordinates()[0]),C!=E.length){let T=E.slice(x,C+1),m=E[C+1].slice();E[x]=m;for(let o=x,L=o+T.length;o<L;o++)E[o+1]=T[o-x];C<x?i.setTextarea(E.join(`
`),i.textarea.selectionEnd+m.length+1,i.textarea.selectionStart+m.length+1):i.setTextarea(E.join(`
`),i.textarea.selectionStart+m.length+1,i.textarea.selectionEnd+m.length+1),d()}}else if(N.key=="ArrowUp")if(i.getSelectionStartCoordinates()[0]==i.getSelectionEndCoordinates()[0]){let E=i.textarea.value.split(`
`),x=i.getCurrentLine(),C=E[i.getCurrentLine()].slice();if(i.getCurrentLine()!==0){let T=E[i.getCurrentLine()-1].slice();E[i.getCurrentLine()]=T,E[i.getCurrentLine()-1]=C,i.setTextarea(E.join(`
`)),d(),i.setCarretAt(x-1)}}else{let E=i.textarea.value.split(`
`),x=i.getSelectionStartCoordinates()[0],C=i.getSelectionEndCoordinates()[0];if(C<x&&(x=i.getSelectionEndCoordinates()[0],C=i.getSelectionStartCoordinates()[0]),x!=0){let T=E.slice(x,C+1),m=E[x-1].slice();E[C]=m;for(let o=x,L=o+T.length;o<L;o++)E[o-1]=T[o-x];C<x?i.setTextarea(E.join(`
`),i.textarea.selectionEnd-m.length-1,i.textarea.selectionStart-m.length-1):i.setTextarea(E.join(`
`),i.textarea.selectionStart-m.length-1,i.textarea.selectionEnd-m.length-1),d()}}}i.debounceLint()}function h(N){if(i.textarea.selectionStart==i.textarea.selectionEnd){N.preventDefault();let E=i.textarea.value.split(`
`),x=i.getCurrentLine(),C=E.slice(0,x).join(`
`).length,T=C+E[x].length+1;i.textarea.setSelectionRange(C,T),i.lastTextareaValue=i.textarea.value,document.execCommand("cut"),i.updateCaret()}}function p(N){if(i.textarea.selectionStart==i.textarea.selectionEnd){N.preventDefault();let E=i.textarea.value.split(`
`),x=i.getCurrentLine(),C=E.slice(0,x).join(`
`).length,T=C+E[x].length+1;i.textarea.setSelectionRange(C,T),document.execCommand("copy")}}function y(N){N.preventDefault();let E=N.clipboardData.getData("text").replace(new RegExp(/\r/g),""),x=i.textarea.value.slice(0,i.textarea.selectionStart),C=i.textarea.value.slice(i.textarea.selectionEnd),T=x+E+C,m=i.textarea.selectionStart+E.length;try{JSON.parse(T),i.setTextarea(i.damon.jsonToDamon(T)),d(),i.updateCaret(),i.debounceLint();return}catch{}let o=T.split(`
`),L=m,S=0,_=0;for(let I=0,$=o.length;I<$;I++)if(S+o[I].length+I<L)S+=o[I].length;else{S+=I,_=I;break}let D=[_,m-S],k=o[_].slice(0);if(T=i.formatIndentation(T),o=T.split(`
`),i.textarea.value!==T){let I=o.slice(0,_+1).join(`
`).length-k.length+D[1];i.setTextarea(T,I),d()}i.updateCaret(),i.debounceLint()}i.textarea.addEventListener("input",d),i.editor.addEventListener("scroll",w);function d(){document.activeElement==i.textarea&&(i.update(),i.debounceHistoryUpdate(),i.updateCurrentLine(),i.updateHorizontalScroll(),i.updateCaret(),i.debounceLint())}function w(N){i.virtualScroller.scrollHandler()}window.spaceResizeTimeout=null;function A(N){spaceResizeTimeout&&clearTimeout(spaceResizeTimeout),window.spaceResizeTimeout=setTimeout(function(){let E=i.editor.scrollTop;i.gutter.innerHTML="",i.overlay.firstElementChild.innerHTML="",i.initialized=!1,i.virtualScroller.inputHandler(),i.initialized=!0,i.editor.scrollTop=E},100)}}});var zr=se((ti,Jr)=>{var pt=Ut(),Mn=Nr(),Pn=lt(),Un=Ur();Jr.exports=class{constructor(e,n,t){let r=this;r.dom=e,r.innerHTML="",r.editor={},r.gutter={},r.container={},r.overlay={},r.textarea={},r.caretPadding={},r.caret={},r.statusBar={},r.copyButton={},r.diffButton={},r.prism=n,r.indentation="    ",r.currentLine=0,r.history=[],r.historyPosition=0,r.historyUpdateTimeoutId,r.lintTimeoutId,r.lastTextareaValue="",r.lastSelection="",r.initialized=!1,r.virtualScroller={},r.damon=new Mn,r.damonUtils=new Un(r.damon),r.utils=pt}init(){let e=this;e.statusBarHTML=pt.html`
<div>
    Spaces: <a href="https://github.com/adrianturcev/space/blob/master/bindings.md"><kbd>SPACE</kbd></a>
</div>
<a href="https://github.com/adrianturcev/damon/blob/master/language_reference.md">
    DAMON
    <svg
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg">
        <title>help-circle</title>
        <circle
            style="fill:#FEFEFE;stroke-width:1.04312;fill-opacity:1"
            cx="12"
            cy="12"
            r="9.6854191" />
        <path
            fill="#FEFEFE"
            d="M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"
            style="fill:#4169e1;fill-opacity:1" />
    </svg>
</a>
<button class="space-copyButton">
    JSON
    <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg">
        <title>content-copy</title>
        <path
            fill="#FEFEFE"
            d="M 4,21 H 15 V 7 H 4 M 4,5 h 11 a -2,2 0 0 1 2,2 v 14 a -2,2 0 0 1 -2,2 H 4 A -2,2 0 0 1 2,21 V 7 A -2,2 0 0 1 4,5 M 7,1 h 12 a -2,2 0 0 1 2,2 V 17 H 19 V 3 H 7 Z"/>
    </svg>
</button>
<button class="space-diffButton">
    Diff
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <title>set-left-right</title>
        <path
            fill="#FEFEFE"
            d="M9,5C10.04,5 11.06,5.24 12,5.68C12.94,5.24 13.96,5 15,5A7,7 0 0,1 22,12A7,7 0 0,1 15,19C13.96,19 12.94,18.76 12,18.32C11.06,18.76 10.04,19 9,19A7,7 0 0,1 2,12A7,7 0 0,1 9,5M9,12C9,14.22 10.21,16.16 12,17.2C13.79,16.16 15,14.22 15,12C15,9.78 13.79,7.84 12,6.8C10.21,7.84 9,9.78 9,12Z" />
    </svg>
</button>`,e.innerHTML=pt.html`
<div class="space-editor" data-state="js-off">
    <div class="space-gutter"></div>
    <div class="space-container">
<pre class="space-dummyTextarea"><span class="space-caretPadding"></span><span class="space-caret">&nbsp;</span></pre>
        <pre class="space-overlay" aria-hidden="true" tabindex="-1">
            <code class="language-damon"></code>
        </pre>
        <textarea
            class="space-textarea"
            placeholder="Paste JSON or type DAMON"
            spellcheck="false"
            aria-labelledby=""
            aria-controls="space-statusBar0"
            maxlength="500000">
        </textarea>
        <ul class="space-suggestions"></ul>
    </div>
</div>
<div class="space-statusBar" id="space-statusBar0" role="log" aria-live="polite">${e.statusBarHTML}</div>
        `;let n="";e.dom.innerHTML!==e.innerHTML&&(e.dom.getElementsByTagName("textarea")[0]!==void 0&&(n=e.dom.getElementsByTagName("textarea")[0].innerHTML),e.dom.innerHTML=e.innerHTML),e.editor=e.dom.getElementsByClassName("space-editor")[0],e.gutter=e.dom.getElementsByClassName("space-gutter")[0],e.container=e.dom.getElementsByClassName("space-container")[0],e.overlay=e.dom.getElementsByClassName("space-overlay")[0],e.textarea=e.dom.getElementsByClassName("space-textarea")[0],e.textarea.innerHTML=n,e.caretPadding=e.dom.getElementsByClassName("space-caretPadding")[0],e.caret=e.dom.getElementsByClassName("space-caret")[0],e.statusBar=e.dom.getElementsByClassName("space-statusBar")[0],e.copyButton=e.dom.getElementsByClassName("space-copyButton")[0],e.diffButton=e.dom.getElementsByClassName("space-copyButton")[0],e.virtualScroller=new Pn(this),e.editor.dataset.state="",e.textarea.value=e.formatIndentation(e.textarea.value.replaceAll(/\r/g,"")),e.routes=Br()(this),e.lint()}update(){let e=this;e.initialized&&e.lastTextareaValue==e.textarea.value||(e.gutter.children.length==0?e.virtualScroller.init(0):e.virtualScroller.inputHandler(),e.initialized&&(e.lastTextareaValue=e.textarea.value))}updateHorizontalScroll(){let e=this;if(document.activeElement==e.textarea){let n=e.textarea.value.split(`
`),t=0,r=e.gutter.children[0].children[0].getBoundingClientRect().width;for(let s=0,a=n.length;s<a&&t+n[s].length<e.textarea.selectionEnd;s++)t+=n[s].length+1;(e.textarea.selectionEnd-t)*r-e.gutter.clientWidth<=e.editor.scrollLeft&&(e.editor.scrollLeft=0)}}getCurrentLine(){let e=this,n=e.textarea.value.split(`
`),t=0,r=0,s=0;(e.textarea.selectionDirection=="forward"||e.textarea.selectionStart==e.textarea.selectionEnd)&&(t=e.textarea.selectionEnd),e.textarea.selectionDirection=="backward"&&(t=e.textarea.selectionStart);for(let a=0,f=n.length;a<f;a++)if(r+n[a].length+a<t)r+=n[a].length;else{s=a;break}return s}getSelectionStartCoordinates(){let e=this,n=e.textarea.value.split(`
`),t=e.textarea.selectionStart,r=0,s=0;for(let a=0,f=n.length;a<f;a++)if(r+n[a].length+a<t)r+=n[a].length;else{r+=a,s=a;break}return[s,e.textarea.selectionStart-r]}getSelectionEndCoordinates(){let e=this,n=e.textarea.value.split(`
`),t=e.textarea.selectionEnd,r=0,s=0;for(let a=0,f=n.length;a<f;a++)if(r+n[a].length+a<t)r+=n[a].length;else{r+=a,s=a;break}return[s,e.textarea.selectionEnd-r]}setCarretAt(e,n){let t=this;if(n==null&&(n=t.textarea.value.split(`
`)[e].length),e==0)t.textarea.selectionStart=n;else{let r=Math.min(n,t.textarea.value.split(`
`)[e].length);t.textarea.selectionStart=t.textarea.value.split(`
`).slice(0,e).reduce(function(s,a){return s+a}).length+e+n}t.textarea.selectionEnd=t.textarea.selectionStart,t.textarea.focus()}getTextareaSelection(){let e=this;return e.textarea.selectionStart<e.textarea.selectionEnd?e.textarea.value.slice(e.textarea.selectionStart,e.textarea.selectionEnd):e.textarea.selectionStart<e.textarea.selectionEnd?e.textarea.value.slice(e.textarea.selectionEnd,e.textarea.selectionStart):void 0}updateCurrentLine(e){let n=this,t=n.currentLine;if(n.currentLine=n.getCurrentLine(),t!=n.currentLine||!n.initialized||e||n.lastSelection!=null&&n.getTextareaSelection()==null){for(let s=0,a=n.gutter.children.length;s<a;s++)n.gutter.children[s].classList.remove("currentLine"),n.gutter.children[s].classList.remove("selectionEnd");n.gutter.children[n.currentLine-n.gutter.children[0].textContent.trim()+1]&&(n.textarea.selectionEnd==n.textarea.selectionStart?n.gutter.children[n.currentLine-n.gutter.children[0].textContent.trim()+1].classList.add("currentLine"):n.gutter.children[n.currentLine-n.gutter.children[0].textContent.trim()+1].classList.add("selectionEnd"))}}historyUpdate(){let e=this;if(e.history.length==0||e.textarea.value!=e.history[e.historyPosition-1][0]){let t=function(r,s){return r+s[0]+s[1]};var n=t;if(e.history.length==1){let r=e.textarea.selectionStart-(e.textarea.value.length-e.history[0][0].length);e.history[0][0].length>e.textarea.value.length&&(r=e.textarea.selectionStart-(e.history[0][0].length-e.textarea.value.length)),e.history.push([e.history[0][0],r]),e.historyPosition++}if(e.historyPosition!=e.history.length&&(e.history=e.history.slice(0,e.historyPosition)),e.history.push([e.textarea.value,e.textarea.selectionStart]),e.history.reduce(t,"").length*4>1e8){let r=0;for(;e.history.reduce(t,"").length*4>1e8;)r++,e.history.shift();e.historyPosition-=r}e.historyPosition++}}debounceHistoryUpdate(){var e=this,n=arguments;clearTimeout(this.historyUpdateTimeoutId),this.historyUpdateTimeoutId=setTimeout(function(){e.historyUpdateTimeoutId=null,e.historyUpdate.apply(e,n)},200)}formatIndentation(e){let n=this,t=e.split(`
`);for(let r=0,s=t.length;r<s;r++){if(/^ *(\t)+/.test(t[r])){let a=t[r].match(/^ *(\t)+/)[0].length;for(let f=0,c=a;f<c;f++)t[r]=t[r].replace("	","    ")}if(/^( )+/.test(t[r])&&t[r].match(/^( )+/)[0].length%4!==0){for(let a=t[r].match(/^( )+/)[0].length;0<=a;a--)if(a%4==0){t[r].trimStart(),t[r]=" ".repeat(a)+t[r];break}}}return t.join(`
`)}formatHyphens(e){let n=this,t=e.split(`
`);for(let r=0,s=t.length;r<s;r++)if(!/^ *- /.test(t[r])){let a="";/^ /.test(t[r])&&(a=t[r].match(/^( )+/)[0]),t[r]=a+"- "+t[r].slice(a.length)}return t.join(`
`)}updateCaret(){let e=this;e.textarea.selectionDirection=="forward"||e.textarea.selectionStart==e.textarea.selectionEnd?e.caretPadding.textContent=e.textarea.value.slice(0,e.textarea.selectionEnd):e.caretPadding.textContent=e.textarea.value.slice(0,e.textarea.selectionStart)}setTextarea(e,n,t=n){let r=this;r.lastTextareaValue=r.textarea.value,r.textarea.value=e,n!==null&&r.textarea.setSelectionRange(n,t)}lint(){let e=this;try{e.damon.damonToMap(e.textarea.value),e.statusBar.innerHTML=e.statusBarHTML}catch(n){n.language=="JSON"?e.statusBar.innerHTML="<span>( ! ) Error line number "+n.line+": "+n.type+" not JSON-compliant</span>"+e.statusBarHTML:e.statusBar.innerHTML="<span>( ! ) "+n.message+"</span>"+e.statusBarHTML,console.error(n)}e.copyButton=e.dom.getElementsByClassName("space-copyButton")[0],e.copyButton.addEventListener("click",function(n){let t=document.createElement("textarea");t.style.opacity="0";try{t.value=e.damon.damonToJSON(e.textarea.value)}catch{setTimeout(function(){e.copyButton.classList.remove("error")},1100),e.copyButton.classList.add("error");return}document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")&&(setTimeout(function(){e.copyButton.classList.remove("success")},1100),e.copyButton.classList.add("success"))}catch(r){console.error(r.name,r.message)}document.body.removeChild(t)}),e.diffButton=e.dom.getElementsByClassName("space-diffButton")[0],e.diffButton.addEventListener("click",function(n){try{e.damon.damonToMap(e.textarea.value)}catch{alert("Invalid initial value.");return}e.diff(n)})}diff(e){let n=this;if(n.dom.getElementsByTagName("form").length||n.dom.getElementsByClassName("space-diff").length)return;let t=document.createElement("form"),r=document.createElement("div"),s=document.createElement("input"),a=document.createElement("label"),f=document.createElement("textarea"),c=document.createElement("button");s.type="checkbox",s.id="spaceDiffSortCheckbox",s.name="sort",a.textContent="Sort",a.setAttribute("for","spaceDiffSortCheckbox"),f.className="space-diffTextarea",t.style.position="absolute",f.placeholder="Paste DAMON or JSON.",c.textContent="Close",c.addEventListener("click",function(u){t.remove()}),r.appendChild(s),r.appendChild(a),t.appendChild(r),t.appendChild(f),t.appendChild(c),n.dom.appendChild(t),f.focus(),f.addEventListener("paste",function(u){let g=n.formatIndentation(u.clipboardData.getData("text").replace(new RegExp(/\r/g),"")),l="",h,p;try{h=n.damon.damonToMap(n.textarea.value)}catch{t.remove(),alert("Invalid initial value.");return}try{JSON.parse(g),p=n.damon.jsonToMap(g)}catch{try{p=n.damon.damonToMap(g)}catch{t.remove(),alert("Invalid clipboard value.");return}}s.checked&&(p=n.damonUtils.sortMap(h,p)),l=n.damonUtils.renderDiff(h,p);let y=document.createElement("div"),d=document.createElement("button");y.className="space-diff",y.innerHTML=l.innerHTML,d.textContent="Close",n.damonUtils.wrapListContentsForStyling(y.getElementsByTagName("li")),y.appendChild(d),n.dom.append(y),d.addEventListener("click",function(w){y.remove()}),n.damonUtils.addLineNumbers(y.querySelectorAll("li[data-graph-arbo]"),n.textarea.value,y),t.remove()})}debounceLint(){var e=this,n=arguments;clearTimeout(this.lintTimeoutId),this.lintTimeoutId=setTimeout(function(){e.lintTimeoutId=null,e.lint.apply(e,n)},200)}}});(function(){window.Space=zr()})();})();
/*! Bundled license information:

dompurify/dist/purify.cjs.js:
  (*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE *)
*/
