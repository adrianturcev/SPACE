(()=>{var Qr=Object.create;var He=Object.defineProperty;var jr=Object.getOwnPropertyDescriptor;var en=Object.getOwnPropertyNames;var tn=Object.getPrototypeOf,rn=Object.prototype.hasOwnProperty;var nn=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+i+'" is not supported')});var ln=(i,e)=>()=>(i&&(e=i(i=0)),e);var oe=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),an=(i,e)=>{for(var r in e)He(i,r,{get:e[r],enumerable:!0})},Mt=(i,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of en(e))!rn.call(i,t)&&t!==r&&He(i,t,{get:()=>e[t],enumerable:!(n=jr(e,t))||n.enumerable});return i};var on=(i,e,r)=>(r=i!=null?Qr(tn(i)):{},Mt(e||!i||!i.__esModule?He(r,"default",{value:i,enumerable:!0}):r,i)),sn=i=>Mt(He({},"__esModule",{value:!0}),i);var Ut=oe((Bn,Pt)=>{Pt.exports={nil(i){return i===null||typeof i>"u"},hack(i,e,r){return i.slice(e,r+1)},pick(i,e){return i.filter(e)},prune(i,e){return i.filter(function(r){return!e(r)})},check(i,e){return i.every(e)},escape(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},html(i){let e=i[0],r=Math.max(i.length,arguments.length-1);for(let n=1;n<i.length;n++)e+=arguments[n],e+=i[n];return e},addDataState(i,e){let r=[];i.dataset.state&&i.dataset.state.indexOf(" ")>-1?r=i.dataset.state.split(" "):r=[i.dataset.state],r.indexOf(e)===-1&&(r.push(e),i.dataset.state=r.join(" "))},removeDataState(i,e){let r=[];i.dataset.state&&i.dataset.state.indexOf(" ")>-1?r=i.dataset.state.split(" "):r=[i.dataset.state],i.dataset.state=r.filter(n=>n!==e).join(" ")},replaceDataState(i,e,r){this.removeDataState(i,e),this.addDataState(i,r)},toggleDataState(i,e){i.dataset.state.split(" ").indexOf(e)==-1?this.addDataState(i,e):this.removeDataState(i,e)},ajaxGet(i,e,r,n){var t=new XMLHttpRequest;t.open("GET",i),t.addEventListener("load",function(){if(t.status>=200&&t.status<400)if(r){var l={};try{l=JSON.parse(t.responseText)}catch{console.error("Get request returned invalid JSON.")}n===void 0?e(l):e.apply(n,[l])}else n===void 0?e(t.responseText):e.apply(n,[t.responseText]);else console.error(t.status+" "+t.statusText+" "+i)}),t.addEventListener("error",function(){console.error("Network error trying to access: "+i)}),t.send(null)},ajaxPost(i,e,r,n,t,l,o){var u=new XMLHttpRequest;u.open("POST",i),u.addEventListener("load",function(){u.status>=200&&u.status<400?l===void 0?r(u):r.apply(l,[u]):(o===void 0?n(u):n.apply(o,[u]),console.error(u.status+" "+u.statusText+" "+i))}),u.addEventListener("error",function(){console.error("Network error trying to access: "+i)}),t&&(u.setRequestHeader("Content-Type","application/json"),e=JSON.stringify(e)),u.send(e)}}});var pr={};an(pr,{__addDisposableResource:()=>ur,__assign:()=>Me,__asyncDelegator:()=>rr,__asyncGenerator:()=>tr,__asyncValues:()=>nr,__await:()=>ye,__awaiter:()=>Kt,__classPrivateFieldGet:()=>or,__classPrivateFieldIn:()=>fr,__classPrivateFieldSet:()=>sr,__createBinding:()=>Ue,__decorate:()=>Jt,__disposeResources:()=>cr,__esDecorate:()=>Gt,__exportStar:()=>Zt,__extends:()=>Ft,__generator:()=>Xt,__importDefault:()=>ar,__importStar:()=>lr,__makeTemplateObject:()=>ir,__metadata:()=>Yt,__param:()=>zt,__propKey:()=>Wt,__read:()=>rt,__rest:()=>Bt,__rewriteRelativeImportExtension:()=>dr,__runInitializers:()=>Vt,__setFunctionName:()=>qt,__spread:()=>Qt,__spreadArray:()=>er,__spreadArrays:()=>jt,__values:()=>Pe,default:()=>cn});function Ft(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");et(i,e);function r(){this.constructor=i}i.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function Bt(i,e){var r={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(r[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,n=Object.getOwnPropertySymbols(i);t<n.length;t++)e.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(i,n[t])&&(r[n[t]]=i[n[t]]);return r}function Jt(i,e,r,n){var t=arguments.length,l=t<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(i,e,r,n);else for(var u=i.length-1;u>=0;u--)(o=i[u])&&(l=(t<3?o(l):t>3?o(e,r,l):o(e,r))||l);return t>3&&l&&Object.defineProperty(e,r,l),l}function zt(i,e){return function(r,n){e(r,n,i)}}function Gt(i,e,r,n,t,l){function o(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var u=n.kind,d=u==="getter"?"get":u==="setter"?"set":"value",a=!e&&i?n.static?i:i.prototype:null,p=e||(a?Object.getOwnPropertyDescriptor(a,n.name):{}),c,f=!1,h=r.length-1;h>=0;h--){var b={};for(var y in n)b[y]=y==="access"?{}:n[y];for(var y in n.access)b.access[y]=n.access[y];b.addInitializer=function(S){if(f)throw new TypeError("Cannot add initializers after decoration has completed");l.push(o(S||null))};var x=(0,r[h])(u==="accessor"?{get:p.get,set:p.set}:p[d],b);if(u==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(c=o(x.get))&&(p.get=c),(c=o(x.set))&&(p.set=c),(c=o(x.init))&&t.unshift(c)}else(c=o(x))&&(u==="field"?t.unshift(c):p[d]=c)}a&&Object.defineProperty(a,n.name,p),f=!0}function Vt(i,e,r){for(var n=arguments.length>2,t=0;t<e.length;t++)r=n?e[t].call(i,r):e[t].call(i);return n?r:void 0}function Wt(i){return typeof i=="symbol"?i:"".concat(i)}function qt(i,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(i,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function Yt(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Kt(i,e,r,n){function t(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{a(n.next(p))}catch(c){o(c)}}function d(p){try{a(n.throw(p))}catch(c){o(c)}}function a(p){p.done?l(p.value):t(p.value).then(u,d)}a((n=n.apply(i,e||[])).next())})}function Xt(i,e){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,t,l,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=u(0),o.throw=u(1),o.return=u(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(p){return d([a,p])}}function d(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(r=0)),r;)try{if(n=1,t&&(l=a[0]&2?t.return:a[0]?t.throw||((l=t.return)&&l.call(t),0):t.next)&&!(l=l.call(t,a[1])).done)return l;switch(t=0,l&&(a=[a[0]&2,l.value]),a[0]){case 0:case 1:l=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,t=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!l||a[1]>l[0]&&a[1]<l[3])){r.label=a[1];break}if(a[0]===6&&r.label<l[1]){r.label=l[1],l=a;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(a);break}l[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(i,r)}catch(p){a=[6,p],t=0}finally{n=l=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}function Zt(i,e){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Ue(e,i,r)}function Pe(i){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&i[e],n=0;if(r)return r.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rt(i,e){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var n=r.call(i),t,l=[],o;try{for(;(e===void 0||e-- >0)&&!(t=n.next()).done;)l.push(t.value)}catch(u){o={error:u}}finally{try{t&&!t.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return l}function Qt(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(rt(arguments[e]));return i}function jt(){for(var i=0,e=0,r=arguments.length;e<r;e++)i+=arguments[e].length;for(var n=Array(i),t=0,e=0;e<r;e++)for(var l=arguments[e],o=0,u=l.length;o<u;o++,t++)n[t]=l[o];return n}function er(i,e,r){if(r||arguments.length===2)for(var n=0,t=e.length,l;n<t;n++)(l||!(n in e))&&(l||(l=Array.prototype.slice.call(e,0,n)),l[n]=e[n]);return i.concat(l||Array.prototype.slice.call(e))}function ye(i){return this instanceof ye?(this.v=i,this):new ye(i)}function tr(i,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(i,e||[]),t,l=[];return t=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",o),t[Symbol.asyncIterator]=function(){return this},t;function o(h){return function(b){return Promise.resolve(b).then(h,c)}}function u(h,b){n[h]&&(t[h]=function(y){return new Promise(function(x,S){l.push([h,y,x,S])>1||d(h,y)})},b&&(t[h]=b(t[h])))}function d(h,b){try{a(n[h](b))}catch(y){f(l[0][3],y)}}function a(h){h.value instanceof ye?Promise.resolve(h.value.v).then(p,c):f(l[0][2],h)}function p(h){d("next",h)}function c(h){d("throw",h)}function f(h,b){h(b),l.shift(),l.length&&d(l[0][0],l[0][1])}}function rr(i){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(t,l){e[t]=i[t]?function(o){return(r=!r)?{value:ye(i[t](o)),done:!1}:l?l(o):o}:l}}function nr(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],r;return e?e.call(i):(i=typeof Pe=="function"?Pe(i):i[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(l){r[l]=i[l]&&function(o){return new Promise(function(u,d){o=i[l](o),t(u,d,o.done,o.value)})}}function t(l,o,u,d){Promise.resolve(d).then(function(a){l({value:a,done:u})},o)}}function ir(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function lr(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var r=tt(i),n=0;n<r.length;n++)r[n]!=="default"&&Ue(e,i,r[n]);return fn(e,i),e}function ar(i){return i&&i.__esModule?i:{default:i}}function or(i,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!n:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(i):n?n.value:e.get(i)}function sr(i,e,r,n,t){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!t)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!t:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?t.call(i,r):t?t.value=r:e.set(i,r),r}function fr(i,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof i=="function"?e===i:i.has(e)}function ur(i,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,t;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(t=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");t&&(n=function(){try{t.call(this)}catch(l){return Promise.reject(l)}}),i.stack.push({value:e,dispose:n,async:r})}else r&&i.stack.push({async:!0});return e}function cr(i){function e(l){i.error=i.hasError?new un(l,i.error,"An error was suppressed during disposal."):l,i.hasError=!0}var r,n=0;function t(){for(;r=i.stack.pop();)try{if(!r.async&&n===1)return n=0,i.stack.push(r),Promise.resolve().then(t);if(r.dispose){var l=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(l).then(t,function(o){return e(o),t()})}else n|=1}catch(o){e(o)}if(n===1)return i.hasError?Promise.reject(i.error):Promise.resolve();if(i.hasError)throw i.error}return t()}function dr(i,e){return typeof i=="string"&&/^\.\.?\//.test(i)?i.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,t,l,o){return n?e?".jsx":".js":t&&(!l||!o)?r:t+l+"."+o.toLowerCase()+"js"}):i}var et,Me,Ue,fn,tt,un,cn,hr=ln(()=>{et=function(i,e){return et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])},et(i,e)};Me=function(){return Me=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Me.apply(this,arguments)};Ue=Object.create?function(i,e,r,n){n===void 0&&(n=r);var t=Object.getOwnPropertyDescriptor(e,r);(!t||("get"in t?!e.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(i,n,t)}:function(i,e,r,n){n===void 0&&(n=r),i[n]=e[r]};fn=Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e},tt=function(i){return tt=Object.getOwnPropertyNames||function(e){var r=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[r.length]=n);return r},tt(i)};un=typeof SuppressedError=="function"?SuppressedError:function(i,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=i,n.suppressed=e,n};cn={__extends:Ft,__assign:Me,__rest:Bt,__decorate:Jt,__param:zt,__esDecorate:Gt,__runInitializers:Vt,__propKey:Wt,__setFunctionName:qt,__metadata:Yt,__awaiter:Kt,__generator:Xt,__createBinding:Ue,__exportStar:Zt,__values:Pe,__read:rt,__spread:Qt,__spreadArrays:jt,__spreadArray:er,__await:ye,__asyncGenerator:tr,__asyncDelegator:rr,__asyncValues:nr,__makeTemplateObject:ir,__importStar:lr,__importDefault:ar,__classPrivateFieldGet:or,__classPrivateFieldSet:sr,__classPrivateFieldIn:fr,__addDisposableResource:ur,__disposeResources:cr,__rewriteRelativeImportExtension:dr}});var mr=oe(nt=>{(function(i){"use strict";var e=typeof process=="object"&&process.env?process.env:self;i.parser=function(g){return new c(g)},i.CParser=c,i.CStream=h,i.createStream=f,i.MAX_BUFFER_LENGTH=64*1024,i.DEBUG=e.CDEBUG==="debug",i.INFO=e.CDEBUG==="debug"||e.CDEBUG==="info",i.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var r={textNode:void 0,numberNode:""},n=i.EVENTS.filter(function(g){return g!=="error"&&g!=="end"}),t=0,l;i.STATE={BEGIN:t++,VALUE:t++,OPEN_OBJECT:t++,CLOSE_OBJECT:t++,OPEN_ARRAY:t++,CLOSE_ARRAY:t++,TEXT_ESCAPE:t++,STRING:t++,BACKSLASH:t++,END:t++,OPEN_KEY:t++,CLOSE_KEY:t++,TRUE:t++,TRUE2:t++,TRUE3:t++,FALSE:t++,FALSE2:t++,FALSE3:t++,FALSE4:t++,NULL:t++,NULL2:t++,NULL3:t++,NUMBER_DECIMAL_POINT:t++,NUMBER_DIGIT:t++};for(var o in i.STATE)i.STATE[i.STATE[o]]=o;t=i.STATE;let u={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(g){function s(){this.__proto__=g}return s.prototype=g,new s}),Object.getPrototypeOf||(Object.getPrototypeOf=function(g){return g.__proto__}),Object.keys||(Object.keys=function(g){var s=[];for(var O in g)g.hasOwnProperty(O)&&s.push(O);return s});function d(g){var s=Math.max(i.MAX_BUFFER_LENGTH,10),O=0;for(var C in r){var _=g[C]===void 0?0:g[C].length;if(_>s)switch(C){case"text":closeText(g);break;default:E(g,"Max buffer length exceeded: "+C)}O=Math.max(O,_)}g.bufferCheckPosition=i.MAX_BUFFER_LENGTH-O+g.position}function a(g){for(var s in r)g[s]=r[s]}var p=/[\\"\n]/g;function c(g){if(!(this instanceof c))return new c(g);var s=this;a(s),s.bufferCheckPosition=i.MAX_BUFFER_LENGTH,s.q=s.c=s.p="",s.opt=g||{},s.closed=s.closedRoot=s.sawRoot=!1,s.tag=s.error=null,s.state=t.BEGIN,s.stack=new Array,s.position=s.column=0,s.line=1,s.slashed=!1,s.unicodeI=0,s.unicodeS=null,s.depth=0,b(s,"onready")}c.prototype={end:function(){A(this)},write:T,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{l=nn("stream").Stream}catch{l=function(){}}function f(g){return new h(g)}function h(g){if(!(this instanceof h))return new h(g);this._parser=new c(g),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var s=this;l.apply(s),this._parser.onend=function(){s.emit("end")},this._parser.onerror=function(O){s.emit("error",O),s._parser.error=null},n.forEach(function(O){Object.defineProperty(s,"on"+O,{get:function(){return s._parser["on"+O]},set:function(C){if(!C)return s.removeAllListeners(O),s._parser["on"+O]=C,C;s.on(O,C)},enumerable:!0,configurable:!1})})}h.prototype=Object.create(l.prototype,{constructor:{value:h}}),h.prototype.write=function(g){g=new Buffer(g);for(var s=0;s<g.length;s++){var O=g[s];if(this.bytes_remaining>0){for(var C=0;C<this.bytes_remaining;C++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+C]=g[C];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,s=s+C-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&O>=128)if(O>=194&&O<=223&&(this.bytes_in_sequence=2),O>=224&&O<=239&&(this.bytes_in_sequence=3),O>=240&&O<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+s>g.length){for(var _=0;_<=g.length-1-s;_++)this.temp_buffs[this.bytes_in_sequence][_]=g[s+_];return this.bytes_remaining=s+this.bytes_in_sequence-g.length,!0}else{this.string=g.slice(s,s+this.bytes_in_sequence).toString(),s=s+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var k=s;k<g.length&&!(g[k]>=128);k++);this.string=g.slice(s,k).toString(),this._parser.write(this.string),this.emit("data",this.string),s=k-1}},h.prototype.end=function(g){return g&&g.length&&this._parser.write(g.toString()),this._parser.end(),!0},h.prototype.on=function(g,s){var O=this;return!O._parser["on"+g]&&n.indexOf(g)!==-1&&(O._parser["on"+g]=function(){var C=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);C.splice(0,0,g),O.emit.apply(O,C)}),l.prototype.on.call(O,g,s)},h.prototype.destroy=function(){a(this._parser),this.emit("close")};function b(g,s,O){i.INFO&&console.log("-- emit",s,O),g[s]&&g[s](O)}function y(g,s,O){x(g),b(g,s,O)}function x(g,s){g.textNode=m(g.opt,g.textNode),g.textNode!==void 0&&b(g,s||"onvalue",g.textNode),g.textNode=void 0}function S(g){g.numberNode&&b(g,"onvalue",parseFloat(g.numberNode)),g.numberNode=""}function m(g,s){return s===void 0||(g.trim&&(s=s.trim()),g.normalize&&(s=s.replace(/\s+/g," "))),s}function E(g,s){return x(g),s+=`
Line: `+g.line+`
Column: `+g.column+`
Char: `+g.c,s=new Error(s),g.error=s,b(g,"onerror",s),g}function A(g){return(g.state!==t.VALUE||g.depth!==0)&&E(g,"Unexpected end"),x(g),g.c="",g.closed=!0,b(g,"onend"),c.call(g,g.opt),g}function w(g){return g===u.carriageReturn||g===u.lineFeed||g===u.space||g===u.tab}function T(g){var s=this;if(this.error)throw this.error;if(s.closed)return E(s,"Cannot write after close. Assign an onready handler.");if(g===null)return A(s);var O=0,C=g.charCodeAt(0),_=s.p,k=!1;for(i.DEBUG&&console.log("write -> ["+g+"]");C&&(_=C,s.c=C=g.charCodeAt(O++),_!==C?s.p=_:_=s.p,!!C);)switch(i.DEBUG&&console.log(O,C,i.STATE[s.state]),k?k=!1:(s.position++,C===u.lineFeed?(s.line++,s.column=0):s.column++),s.state){case t.BEGIN:C===u.openBrace?s.state=t.OPEN_OBJECT:C===u.openBracket?s.state=t.OPEN_ARRAY:w(C)||E(s,"Non-whitespace before {[.");continue;case t.OPEN_KEY:case t.OPEN_OBJECT:if(w(C))continue;if(s.state===t.OPEN_KEY)s.stack.push(t.CLOSE_KEY);else if(C===u.closeBrace){b(s,"onopenobject"),this.depth++,b(s,"oncloseobject"),this.depth--,s.state=s.stack.pop()||t.VALUE;continue}else s.stack.push(t.CLOSE_OBJECT);C===u.doubleQuote?s.state=t.STRING:E(s,'Malformed object key should start with "');continue;case t.CLOSE_KEY:case t.CLOSE_OBJECT:if(w(C))continue;var P=s.state===t.CLOSE_KEY?"key":"object";C===u.colon?(s.state===t.CLOSE_OBJECT?(s.stack.push(t.CLOSE_OBJECT),x(s,"onopenobject"),this.depth++):x(s,"onkey"),s.state=t.VALUE):C===u.closeBrace?(y(s,"oncloseobject"),this.depth--,s.state=s.stack.pop()||t.VALUE):C===u.comma?(s.state===t.CLOSE_OBJECT&&s.stack.push(t.CLOSE_OBJECT),x(s),s.state=t.OPEN_KEY):E(s,"Bad object");continue;case t.OPEN_ARRAY:case t.VALUE:if(w(C))continue;if(s.state===t.OPEN_ARRAY)if(b(s,"onopenarray"),this.depth++,s.state=t.VALUE,C===u.closeBracket){b(s,"onclosearray"),this.depth--,s.state=s.stack.pop()||t.VALUE;continue}else s.stack.push(t.CLOSE_ARRAY);C===u.doubleQuote?s.state=t.STRING:C===u.openBrace?s.state=t.OPEN_OBJECT:C===u.openBracket?s.state=t.OPEN_ARRAY:C===u.t?s.state=t.TRUE:C===u.f?s.state=t.FALSE:C===u.n?s.state=t.NULL:C===u.minus?s.numberNode+="-":u._0<=C&&C<=u._9?(s.numberNode+=String.fromCharCode(C),s.state=t.NUMBER_DIGIT):E(s,"Bad value");continue;case t.CLOSE_ARRAY:if(C===u.comma)s.stack.push(t.CLOSE_ARRAY),x(s,"onvalue"),s.state=t.VALUE;else if(C===u.closeBracket)y(s,"onclosearray"),this.depth--,s.state=s.stack.pop()||t.VALUE;else{if(w(C))continue;E(s,"Bad array")}continue;case t.STRING:s.textNode===void 0&&(s.textNode="");var I=O-1,D=s.slashed,$=s.unicodeI;e:for(;;){for(i.DEBUG&&console.log(O,C,i.STATE[s.state],D);$>0;)if(s.unicodeS+=String.fromCharCode(C),C=g.charCodeAt(O++),s.position++,$===4?(s.textNode+=String.fromCharCode(parseInt(s.unicodeS,16)),$=0,I=O-1):$++,!C)break e;if(C===u.doubleQuote&&!D){s.state=s.stack.pop()||t.VALUE,s.textNode+=g.substring(I,O-1),s.position+=O-1-I;break}if(C===u.backslash&&!D&&(D=!0,s.textNode+=g.substring(I,O-1),s.position+=O-1-I,C=g.charCodeAt(O++),s.position++,!C))break;if(D){if(D=!1,C===u.n?s.textNode+=`
`:C===u.r?s.textNode+="\r":C===u.t?s.textNode+="	":C===u.f?s.textNode+="\f":C===u.b?s.textNode+="\b":C===u.u?($=1,s.unicodeS=""):s.textNode+=String.fromCharCode(C),C=g.charCodeAt(O++),s.position++,I=O-1,C)continue;break}p.lastIndex=O;var U=p.exec(g);if(U===null){O=g.length+1,s.textNode+=g.substring(I,O-1),s.position+=O-1-I;break}if(O=U.index+1,C=g.charCodeAt(U.index),!C){s.textNode+=g.substring(I,O-1),s.position+=O-1-I;break}}s.slashed=D,s.unicodeI=$;continue;case t.TRUE:C===u.r?s.state=t.TRUE2:E(s,"Invalid true started with t"+C);continue;case t.TRUE2:C===u.u?s.state=t.TRUE3:E(s,"Invalid true started with tr"+C);continue;case t.TRUE3:C===u.e?(b(s,"onvalue",!0),s.state=s.stack.pop()||t.VALUE):E(s,"Invalid true started with tru"+C);continue;case t.FALSE:C===u.a?s.state=t.FALSE2:E(s,"Invalid false started with f"+C);continue;case t.FALSE2:C===u.l?s.state=t.FALSE3:E(s,"Invalid false started with fa"+C);continue;case t.FALSE3:C===u.s?s.state=t.FALSE4:E(s,"Invalid false started with fal"+C);continue;case t.FALSE4:C===u.e?(b(s,"onvalue",!1),s.state=s.stack.pop()||t.VALUE):E(s,"Invalid false started with fals"+C);continue;case t.NULL:C===u.u?s.state=t.NULL2:E(s,"Invalid null started with n"+C);continue;case t.NULL2:C===u.l?s.state=t.NULL3:E(s,"Invalid null started with nu"+C);continue;case t.NULL3:C===u.l?(b(s,"onvalue",null),s.state=s.stack.pop()||t.VALUE):E(s,"Invalid null started with nul"+C);continue;case t.NUMBER_DECIMAL_POINT:C===u.period?(s.numberNode+=".",s.state=t.NUMBER_DIGIT):E(s,"Leading zero not followed by .");continue;case t.NUMBER_DIGIT:u._0<=C&&C<=u._9?s.numberNode+=String.fromCharCode(C):C===u.period?(s.numberNode.indexOf(".")!==-1&&E(s,"Invalid number has two dots"),s.numberNode+="."):C===u.e||C===u.E?((s.numberNode.indexOf("e")!==-1||s.numberNode.indexOf("E")!==-1)&&E(s,"Invalid number has two exponential"),s.numberNode+="e"):C===u.plus||C===u.minus?(_===u.e||_===u.E||E(s,"Invalid symbol in number"),s.numberNode+=String.fromCharCode(C)):(S(s),O--,k=!0,s.state=s.stack.pop()||t.VALUE);continue;default:E(s,"Unknown state: "+s.state)}return s.position>=s.bufferCheckPosition&&d(s),s}})(typeof nt>"u"?clarinet={}:nt)});var yr=oe(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.stringify=xe.parse=void 0;var dn=(hr(),sn(pr)),pn=dn.__importDefault(mr());function hn(i){let e=lt(),r,n;function t(o){try{let u=e.next(o);u.done&&(r=u.value)}catch(u){n=u}}let l=pn.default.parser();if(l.onopenobject=o=>t({type:"openobject",key:o}),l.onopenarray=()=>t({type:"openarray"}),l.onkey=o=>t({type:"key",key:o}),l.onvalue=o=>t({type:"value",value:o}),l.oncloseobject=()=>t({type:"closeobject"}),l.onclosearray=()=>t({type:"closearray"}),l.onerror=o=>t({type:"error",err:o}),e.next(),l.write(i).close(),n)throw n;return r}xe.parse=hn;function it(i){return Array.isArray(i)?`[${i.map(it).join(",")}]`:i instanceof Map?`{${[...i].map(([e,r])=>JSON.stringify(e)+":"+it(r)).join(",")}}`:JSON.stringify(i)}xe.stringify=it;var gr=Symbol();function*lt(){let i=yield;switch(i.type){case"value":return i.value;case"openobject":let e=new Map,r=i.key;for(r===void 0&&(yield);r!==void 0;)e.set(r,yield*lt()),r=(yield).key;return e;case"openarray":let n=[],t;for(;;){if(t=yield*lt(),t===gr)return n;n.push(t)}case"closearray":return gr;case"error":throw i.err;default:throw Error(`Unexpected ParseEvent ${i.type}`)}}});var Nr=oe((Vn,Er)=>{var xr=yr().parse;Er.exports=class{constructor(e=!1){let r=this;if(this.indentation=4,[!0,!1,void 0].indexOf(e)==-1)throw new Error("@param {Boolean} pedantic");this.pedantic=e}template(e){let r=this;var n=e.raw[0];for(let l=1;l<e.raw.length;l++)typeof arguments[l]=="string"?n+='"'+arguments[l]+'"':n+=arguments[l],n+=e.raw[l];return r._treeToMap(r._damonToTree(n))}damonToMap(e,r=0){let n=this,t=n._damonToTree(e,r);return t===!0||t===!1||t===null||typeof t=="string"||typeof t=="number"?t:n._treeToMap(n._damonToTree(e,r),r)}damonToJSON(e){let r=this;return r.mapToJSON(r.damonToMap(e))}jsonToDamon(e){let r=this;return r.mapToDamon(r.jsonToMap(e),!1)}jsonToMap(e){var n=this._getLines(e,"JSON");if(n=n.filter(t=>!/^ *\/\//.test(t)),n=n.filter(t=>t!=""),n=n.filter(t=>!/^[ \t]+$/.test(t)),n.length==1){if(["true","false","null"].indexOf(n[0].trim())>-1)return JSON.parse(n[0]);if(/^".*"$/.test(n[0].trim()))try{return JSON.parse(n[0].trim())}catch(t){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),t.line=1,t.language="JSON",t.type="string",t}else if(isFinite(n[0])&&!isNaN(parseFloat(n[0]))&&Number.isFinite(n[0]*1)&&!Number.isNaN(n[0]*1)){if(n[0].indexOf(0)==0&&n[0].length>1&&n[0].indexOf(".")!==1){let t=new Error("Error line number 1: leading 0");throw t.line=1,t.language="DAMON",t}try{return JSON.parse(n[0]*1)}catch(t){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),t.line=1,t.language="JSON",t.type="number",t}}else if(n[0]*1===1/0)try{JSON.parse(n[0]*1)}catch(t){throw console.error("Error line number 1: not JSON-compliant, detailed error follows"),t.line=1,t.language="JSON",t.type="infinity",t}else return xr(e)}else return xr(e)}_getLines(e,r="DAMON",n=0){if(["DAMON","JSON"].indexOf(r)==-1)throw new Error("Bad language argument, expected 'DAMON' or 'JSON'");if(e===""){let o=new Error("Error line "+(n+1)+": empty string");throw o.line=n+1,o.language=r,o}if(/[\s]/.test(e)&&e.match(new RegExp(/[\s]/))[0].length==e.length){let o=new Error("Error line "+(n+1)+": string only contains whitespace");throw o.line=n+1,o.language=r,o}var t=/\r\n/.test(e)?`\r
`:`
`,l=e.split(t);if(t==`
`&&/\\*\n/.test(e)){if(/[^\\]\\(\\\\)*\n/.test(e)){let d=e.split(/[^\\]\\(\\\\)*\n/)[0].split(`
`).length,a=new Error("Error line "+(n+d)+": oddly escaped newline");throw a.line=n+d,a.language=r,a}l=e.split("").reverse().join("").split(/\n/).map(d=>d.split("").reverse().join("")).reverse()}return l}_damonToTree(e,r){let n=this,t=n._getLines(e,"DAMON",r),l=t.slice(0);if(t=t.filter(x=>!/^ *\/\//.test(x)),t=t.filter(x=>x!=""),t=t.filter(x=>!/^[ \t]+$/.test(x)),t.length==1){if(["true","false","null"].indexOf(t[0].trim())>-1)return JSON.parse(t[0]);if(/^".*"$/.test(t[0].trim()))try{return JSON.parse(t[0].trim())}catch(x){throw console.error("Error line number "+(r+1)+": not JSON-compliant, detailed error follows"),x.line=r+1,x.language="JSON",x.type="string",x}else if(isFinite(t[0])&&!isNaN(parseFloat(t[0]))&&Number.isFinite(t[0]*1)&&!Number.isNaN(t[0]*1)){if(t[0].indexOf(0)==0&&t[0].length>1&&t[0].indexOf(".")!==1){let x=new Error("Error line number "+(r+1)+": leading 0");throw x.line=r+1,x.language="DAMON",x}try{return JSON.parse(t[0]*1)}catch(x){throw console.error("Error line number "+(r+1)+": not JSON-compliant, detailed error follows"),x.line=r+1,x.language="JSON",x.type="number",x}}else if(t[0]*1===1/0)try{JSON.parse(t[0]*1)}catch(x){throw console.error("Error line number "+(r+1)+": not JSON-compliant, detailed error follows"),x.line=r+1,x.language="JSON",x.type="infinity",x}}let o=0,u=[];for(let x=0,S=l.length;x<S;x++)t.slice(o).indexOf(l[x])>-1?u[x]=t.slice(o).indexOf(l[x]):u[x]=null;let d=new RegExp("^(\\t)+");for(let x=0,S=t.length;x<S;x++){if(d.test(t[x])){let m=t[x].match(d)[0].length;for(let E=0,A=m;E<A;E++)t[x]=t[x].replace("	"," ".repeat(n.indentation))}if(!/^ *- $/.test(t[x])&&/[ \t]+$/.test(t[x])){let m=new Error("Error line "+(r+u.indexOf(x)+1)+": trailing whitespace");throw m.line=r+u.indexOf(x)+1,m.language="DAMON",m}}let a=new RegExp("^("+" ".repeat(n.indentation)+")+");if(a.test(t[0])){let x=t[0].match(a)[0].length,S=!0;for(let m=0,E=t.length;m<E;m++)a.test(t[m])&&t[m].match(a)[0].length>=x?t[m]=t[m].slice(x):S=!1;if(!S){let m=new Error("Error line "+(r+1)+": bad formatting");throw m.line=r+1,m.language="DAMON",m}}else if(a.test(t[1])&&t[1].match(a)[0].length>n.indentation){let x=t[1].match(a)[0].length-n.indentation,S=!0;for(let m=1,E=t.length;m<E;m++)a.test(t[m])&&t[m].match(a)[0].length>=x?t[m]=t[m].slice(x):S=!1;if(!S){let m=new Error("Error line "+(r+2)+": bad formatting");throw m.line=r+2,m.language="DAMON",m}}let p=!1;if(t.length>1)for(let x=0,S=t.length;x<S;x++)x!==0&&/^- /.test(t[x])&&(p=!0);if(!/^- \{\}$/.test(t[0])&&!/^- \[\]$/.test(t[0])&&(p=!0),p){for(let x=0,S=t.length;x<S;x++)t[x]=" ".repeat(n.indentation)+t[x];t.unshift("- {}")}var c={content:t[0],level:0,id:0,children:[],headless:p,damonOriginalLinesMapping:u},f=c;if(!/^- /.test(t[0].trimStart())||/^ +/.test(t[0])&&(t[0].match(/^ +/)[0].length%n.indentation!=0||t[0].match(/^ +/)[0].length!=n.indentation)){let x=new Error("Error line "+(r+(p*1+1))+": bad formatting");throw x.line=r+p*1+1,x.language="DAMON",x}t.shift();for(let x=0,S=t.length;x<S;x++){if(!/^- /.test(t[x].trimStart())||/^ +/.test(t[x])&&(t[x].match(/^ +/)[0].length%n.indentation!=0||x==0&&t[x].match(/^ +/)[0].length!=n.indentation||x!=0&&/^- /.test(t[x-1])&&t[x].match(/^ +/)[0].length!=n.indentation||x!=0&&!/^- /.test(t[x-1])&&t[x].match(/^ +/)[0].length>t[x-1].match(/^ +/)[0].length+n.indentation)){let E=new Error("Error line "+(r+u.indexOf(x)+1)+": bad formatting");throw E.line=r+u.indexOf(x)+1,E.language="DAMON",E}let m={content:t[x].trimStart().slice(2),level:1+t[x].match(/^ +/)[0].length/n.indentation,id:"",children:[]};if(f===c)m.id=c.children.length+1,c.children.push(m);else if(f.level===m.level){var h=n._findListItemCommonDirectParent(f,c);h.level==0?m.id=h.children.length+1:m.id=h.id+"-"+(h.children.length+1),h.children.push(m)}else if(f.level>m.level){var b=n._findListItemCommonAncestor(f,c,m.level);b.level==0?m.id=b.children.length+1:m.id=b.id+"-"+(b.children.length+1),b.children.push(m)}else if(f.level<m.level){var y=n._findListItemCommonDirectParent(f,c);let E=y.children.indexOf(f),A=y.children[E].id,w=y.children[E].children.length+1;m.id=A+"-"+w,y.children[E].children.push(m)}f=m}return c}_findListItemCommonDirectParent(e,r){let n=this;if(r.children.indexOf(e)>-1)return r;var t;for(let l=r.children.length-1,o=0;l>=o;l--)if(t=n._findListItemCommonDirectParent(e,r.children[l]),t)return t}_findListItemCommonAncestor(e,r,n){let t=this;var l=t._findListItemCommonDirectParent(e,r);return l.level<n?l:t._findListItemCommonAncestor(l,r,n)}_treeToMap(e,r){let n=this;var t=0;if(e.content=="- {}"){let d=new Map;return d.damonOriginalLinesMapping=e.damonOriginalLinesMapping,e.headless&&(d.headless=!0),l(e,d)}else if(e.content=="- []"){let d=[];return d.damonOriginalLinesMapping=e.damonOriginalLinesMapping,l(e,d)}function l(d,a){if(typeof d!="object"||d==null||Array.isArray(d)){let p=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,c=new Error("Error line number "+(r+p)+": @param { {} } tree");throw c.line=r+p,c.language="DAMON",c}if(typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map)o(d,a);else if(Array.isArray(a))u(d,a);else{let p=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,c=new Error("Error line number "+(r+p)+": @param { {} | [] } jsonMap");throw c.line=r+p,c.language="DAMON",c}return a}function o(d,a){for(let p=0,c=d.children.length;p<c;p++)if(t++,d.children[p].content.length==0){let f="";d.children[p].children.length>0?(f="implicit map key",a.set("",new Map),a.implicitMaps===void 0&&(a.implicitMaps=[]),a.implicitMaps.push(""),l(d.children[p],a.get(""))):(f="implicit null key",a.set("",null),a.implicitNulls===void 0&&(a.implicitNulls=[]),a.implicitNulls.push(""))}else{let f=d.children[p].content,h="key";try{if(/^.*: +\[/.test(f)&&f[f.length-1]=="]")if(/: +\[ *\]$/.test(f)){let b=JSON.parse(`["${f.slice(0,-1*f.match(/: +\[ *\]$/)[0].length)}"]`)[0];a.set(b,[]),d.children[p].children.length>0&&l(d.children[p],a.get(b))}else{let b=new RegExp(/: +\[/g),y=f.slice(0,-1).split(b),x=f.match(b).concat([""]),S=y.map((w,T)=>w+x[T]),m="",E=[];for(let w=0,T=y.length;w<T;w++)try{let g;if(w==0?g=y[0]:g=S.slice(0,w).join("")+y[w],m=JSON.parse(`["${g}"]`)[0],h="list",E=JSON.parse(`[${S.slice(w+1).join("")}]`),Array.isArray(E))break}catch{if(w==T-2){let s=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,O=new Error("Error line number "+(r+s)+": invalid inline list");throw O.line=r+s,O.language="DAMON",O}}if(E.every(function(w){return w===!0||w===!1||w===null||typeof w=="string"?!0:!!(isFinite(w)&&!isNaN(parseFloat(w))&&Number.isFinite(w*1)&&!Number.isNaN(w*1))}))a.set(m,E),a.damonInlineArrays===void 0&&(a.damonInlineArrays=[]),a.damonInlineArrays.push(m);else{let w=+(e.headless*-1)+e.damonOriginalLinesMapping.indexOf(t-1)+2,T=new Error("Error line number "+(r+w)+": no nesting in inline lists");throw T.line=r+w,T.language="DAMON",T}if(d.children[p].children.length>0){let w=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+3,T=new Error("Error line number "+(r+w)+": inline lists can't have children");throw T.line=r+w,T.language="DAMON",T}}else if(/: +\{ *\}$/.test(f)){let b=JSON.parse(`["${f.slice(0,-1*f.match(/: +\{ *\}$/)[0].length)}"]`)[0];a.set(b,new Map),l(d.children[p],a.get(b))}else{let b=!1;if(/^.*: /.test(f)&&f.split(new RegExp(/: +/))[f.split(new RegExp(/: +/)).length-1]==="true"){let y=f.match(new RegExp(/: +/g))[f.match(new RegExp(/: +/g)).length-1],x=JSON.parse(`["${f.slice(0,-1*y.length-4)}"]`)[0];a.set(x,!0)}else if(/^.*: /.test(f)&&f.split(new RegExp(/: +/))[f.split(new RegExp(/: +/)).length-1]==="false"){let y=f.match(new RegExp(/: +/g))[f.match(new RegExp(/: +/g)).length-1],x=JSON.parse(`["${f.slice(0,-1*y.length-5)}"]`)[0];a.set(x,!1)}else if(/^.*: /.test(f)&&f.split(new RegExp(/: +/))[f.split(new RegExp(/: +/)).length-1]==="null"){let y=f.match(new RegExp(/: +/g))[f.match(new RegExp(/: +/g)).length-1],x=JSON.parse(`["${f.slice(0,-1*y.length-4)}"]`)[0];a.set(x,null)}else if(/^.*: +"/.test(f)&&f[f.length-1]=='"'){let y=f.match(new RegExp(/: +"/g));if(y.length==1){let x=JSON.parse(`["${f.split(y[0])[0]}"]`)[0];h="string";let S=JSON.parse(`["${f.split(y[0]).slice(1).join("").slice(0,-1)}"]`)[0];a.set(x,S)}else if(y.length==2&&/: +"$/.test(f)){let x=JSON.parse(`["${f.split(y[0])[0]}"]`)[0];h="string";let S=JSON.parse(`["${f.split(y[0]).slice(1).join("")+": "}"]`)[0];a.set(x,S)}else{let x=+(e.headless*-1)+e.damonOriginalLinesMapping.indexOf(t-1)+2,S=new Error("Error line number "+(r+x)+": unescaped double quote");throw S.line=r+x,S.language="DAMON",S}}else if(/^.*: /.test(f)&&isFinite(f.split(": ")[f.split(": ").length-1])&&!isNaN(parseFloat(f.split(": ")[f.split(": ").length-1]))&&Number.isFinite(f.split(": ")[f.split(": ").length-1]*1)&&!Number.isNaN(f.split(": ")[f.split(": ").length-1]*1)){let y=JSON.parse(`["${f.split(": ").slice(0,-1).join(": ")}"]`)[0];h="number";let x=f.match(new RegExp(/: +/g)),S=x[x.length-1],m=f.split(S)[f.split(S).length-1];if(m.indexOf(0)==0&&m.length>1&&m.indexOf(".")!==1){let A=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,w=new Error("Error line number "+(r+A)+": leading 0");throw w.line=r+A,w.language="DAMON",w}let E=JSON.parse(`[${f.split(": ")[f.split(": ").length-1]*1}]`)[0];a.set(y,E)}else if(/^.*: /.test(f)&&f.split(new RegExp(/: +/))[f.split(new RegExp(/: +/)).length-1]*1===1/0){let y=JSON.parse(`["${f.split(": ").slice(0,-1).join(": ")}"]`)[0];h="infinity";let x=JSON.parse(`[${f.split(": ")[f.split(": ").length-1]*1}]`)}else{let y=!1,x=0;if(/\[ *\]$/.test(f)&&(y=!0,x=f.match(new RegExp(/\[ *\]$/g))[0].length),/\{ *\}$/.test(f)&&(y=!0,x=f.match(new RegExp(/\{ *\}$/g))[0].length),/true$/.test(f)&&(y=!0,x=4),/false$/.test(f)&&(y=!0,x=5),/null$/.test(f)&&(y=!0,x=4),/".*"$/.test(f)&&(y=!0,x=f.match(new RegExp(/".*"$/g))[0].length),!y){let S="";for(let m=f.length-1;m>-1&&(S=f[m].concat(S),isFinite(S)&&!isNaN(parseFloat(S))&&Number.isFinite(S*1)&&!Number.isNaN(S*1));m--){if(!/[ \t]/.test(f[m]))break;y=!0,x=S.length}}if(y)if(JSON.parse(`["${f.slice(0,-1*x)}"]`)[0],n.pedantic){let S=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t),m=new Error("Error line number "+(r+S)+": missing separator");throw m.line=r+S,m.language="DAMON",m.errorType="pedantic",m}else if(b=!0,d.children[p].children.length>0){h="implicit map key";let S=JSON.parse(`["${f}"]`)[0];a.set(S,new Map),a.implicitMaps===void 0&&(a.implicitMaps=[]),a.implicitMaps.push(S),l(d.children[p],a.get(S))}else{h="implicit null key";let S=JSON.parse(`["${f}"]`)[0];a.set(S,null),a.implicitNulls===void 0&&(a.implicitNulls=[]),a.implicitNulls.push(S)}else{let S=JSON.parse(`["${f.slice(0,-1*x)}"]`)[0];if(n.pedantic)if(/: +$/.test(S)){let m=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t),E=new Error("Error line number "+(r+m)+": bad value");throw E.line=r+m,E.language="DAMON",E.errorType="pedantic",E}else{let m=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t),E=new Error("Error line number "+(r+m)+": missing separator");throw E.line=r+m,E.language="DAMON",E.errorType="pedantic",E}else if(b=!0,d.children[p].children.length>0){h="implicit map key";let m=JSON.parse(`["${f}"]`)[0];a.set(m,new Map),a.implicitMaps===void 0&&(a.implicitMaps=[]),a.implicitMaps.push(m),l(d.children[p],a.get(m))}else{h="implicit null key";let m=JSON.parse(`["${f}"]`)[0];a.set(m,null),a.implicitNulls===void 0&&(a.implicitNulls=[]),a.implicitNulls.push(m)}}}if(!b&&d.children[p].children.length>0){let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+3,x=new Error("Error line number "+(r+y)+": missing container or excess indentation");throw x.line=r+y,x.language="DAMON",x}}}catch(b){if(b.language===void 0){let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;console.error("Error line number "+(r+y)+": not JSON-compliant, detailed error follows"),b.line=r+y,b.language="JSON",b.type=h}throw b}}}function u(d,a){for(let p=0,c=d.children.length;p<c;p++)if(t++,d.children[p].content.length){let f=d.children[p].content;if(/^[ \t]*\[/.test(f)&&f[f.length-1]=="]")if(/^[ \t]*\[ *\]$/.test(f))a.push([]),l(d.children[p],a[a.length-1]);else{let h;try{h=JSON.parse(f)}catch{let x=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,S=new Error("Error line number "+(r+x)+": invalid inline lists");throw S.line=r+x,S.language="JSON",S.type="list",S}if(h.every(function(y){return y===!0||y===!1||y===null||typeof y=="string"?!0:!!(isFinite(y)&&!isNaN(parseFloat(y))&&Number.isFinite(y*1)&&!Number.isNaN(y*1))}))a.push(h),a.damonInlineArrays===void 0&&(a.damonInlineArrays=[]),a.damonInlineArrays.push(p);else{let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,x=new Error("Error line number "+(r+y)+": no nesting in inline lists");throw x.line=r+y,x.language="DAMON",x}if(d.children[p].children.length>0){let y=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+3,x=new Error("Error line number "+(r+y)+": inline lists can't have children");throw x.line=r+y,x.language="DAMON",x}}else if(/^[ \t]*\{\}$/.test(f))a.push(new Map),l(d.children[p],a[a.length-1]);else if(/^[ \t]*true$/.test(f))a.push(!0);else if(/^[ \t]*false$/.test(f))a.push(!1);else if(/^[ \t]*null$/.test(f))a.push(null);else if(/^[ \t]*".*"$/.test(f))try{a.push(JSON.parse(`[${f.trimStart()}]`)[0])}catch(h){let b=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;throw console.error("Error line number "+(r+b)+": not JSON-compliant, detailed error follows"),h.line=r+b,h.language="JSON",h.type="string",h}else if(isFinite(f)&&!isNaN(parseFloat(f))&&Number.isFinite(f*1)&&!Number.isNaN(f*1)){if(f.indexOf(0)==0&&f.length>1&&f.indexOf(".")!==1){let h=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,b=new Error("Error line number "+(r+h)+": leading 0");throw b.line=r+h,b.language="DAMON",b}try{a.push(JSON.parse(`[${f*1}]`)[0])}catch(h){let b=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;throw console.error("Error line number "+(r+b)+": not JSON-compliant, detailed error follows"),h.line=r+b,h.language="JSON",h.type="number",h}}else if(f*1===1/0)try{JSON.parse(f*1)}catch(h){let b=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2;throw console.error("Error line number "+(r+b)+": not JSON-compliant, detailed error follows"),h.line=r+b,h.language="JSON",h.type="infinity",h}else{let h=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,b=new Error("Error line number "+(r+h)+": list items can't have a key");throw b.line=r+h,b.language="DAMON",b}}else{let f=e.headless*-1+e.damonOriginalLinesMapping.indexOf(t-1)+2,h=new Error("Error line number "+(r+f)+": empty list node");throw h.line=r+f,h.language="DAMON",h}}}mapToDamon(e,r){let n=this;var t="";if(Array.isArray(e))t+=`- []
`;else if(typeof e=="object"&&e!==null&&e instanceof Map&&e.constructor===Map)t+=`- {}
`;else return typeof e=="string"&&(e='"'+e+'"'),JSON.parse(e),e;return l(e),n.damonToMap(t.slice(0,-1)),t.slice(0,-1);function l(o,u=1){if(typeof o=="object"&&o!==null&&!Array.isArray(o)&&o instanceof Map&&o.constructor===Map){let p=Array.from(o.keys()),c=!1;o.implicitNulls!==void 0&&o.implicitNulls.length===p.length&&(c=!0);for(let[f,h]of o)if(typeof h=="object"&&h!==null)if(Array.isArray(h)){let b=0,y=h.filter(function(x){return x===!0||x===!1?!0:x===null?(b++,!0):typeof x=="string"?!0:!!(isFinite(x)&&!isNaN(parseFloat(x))&&Number.isFinite(x*1)&&!Number.isNaN(x*1))});if(h.length==y.length&&u*4+2+h.join(", ").length+b*4<=80||r&&o.damonInlineArrays!==void 0&&o.damonInlineArrays.indexOf(f)>-1){let x="["+h.map(function(S){return typeof S=="string"&&(S=JSON.stringify(S)),S}).join(", ")+"]";t+="    ".repeat(u)+"- "+JSON.stringify(f).slice(1,-1)+": "+x+`
`}else t+="    ".repeat(u)+"- "+JSON.stringify(f).slice(1,-1)+`: []
`,l(h,u+1)}else t+="    ".repeat(u)+"- "+JSON.stringify(f).slice(1,-1)+`: {}
`,l(h,u+1);else c?t+="    ".repeat(u)+"- "+JSON.stringify(f).slice(1,-1)+`
`:(t+="    ".repeat(u)+"- "+JSON.stringify(f).slice(1,-1)+": ",h===!0?t+=`true
`:h===!1?t+=`false
`:h===null?t+=`null
`:Number.isFinite(h)&&!Number.isNaN(h)?t+=h+`
`:t+=JSON.stringify(h)+`
`)}else if(Array.isArray(o))for(var d=0,a=o.length;d<a;d++)if(typeof o[d]=="object"&&o[d]!==null)if(Array.isArray(o[d])){let p=0,c=o[d].filter(function(f){return f===!0||f===!1?!0:f===null?(p++,!0):typeof f=="string"?!0:!!(isFinite(f)&&!isNaN(parseFloat(f))&&Number.isFinite(f*1)&&!Number.isNaN(f*1))});if(o[d].length==c.length&&u*4+2+o[d].join(", ").length+p*4<=80||r&&o.damonInlineArrays!==void 0&&o.damonInlineArrays.indexOf(d)>-1){let f="["+o[d].map(function(h){return typeof h=="string"&&(h=JSON.stringify(h)),h}).join(", ")+"]";t+="    ".repeat(u)+"- "+f+`
`}else t+="    ".repeat(u)+`- []
`,l(o[d],u+1)}else t+="    ".repeat(u)+`- {}
`,l(o[d],u+1);else o[d]===!0?t+="    ".repeat(u)+`- true
`:o[d]===!1?t+="    ".repeat(u)+`- false
`:o[d]===null?t+="    ".repeat(u)+`- null
`:Number.isFinite(o[d])&&!Number.isNaN(o[d])?t+="    ".repeat(u)+"- "+o[d]+`
`:t+="    ".repeat(u)+"- "+JSON.stringify(o[d])+`
`}}mapToJSON(e){let r=this;var n="";if(Array.isArray(e))return n+=`[\r
`,t(e),n+="]",JSON.parse(n),n;return typeof e=="object"&&e!==null&&e instanceof Map&&e.constructor===Map?(n+=`{\r
`,t(e),n+="}",JSON.parse(n),n):(typeof e=="string"&&(e=JSON.stringify(e)),JSON.parse(e),e);function t(l,o=1){if(typeof l=="object"&&l!==null&&!Array.isArray(l)&&l instanceof Map&&l.constructor===Map)for(let[a,p]of l)typeof p=="object"&&p!==null?Array.isArray(p)?p.length>0?(n+="    ".repeat(o)+`${JSON.stringify(a)}: [\r
`,t(p,o+1),n+="    ".repeat(o)+"]"):n+="    ".repeat(o)+`${JSON.stringify(a)}: []`:Array.from(p.keys()).length>0?(n+="    ".repeat(o)+`${JSON.stringify(a)}: {\r
`,t(p,o+1),n+="    ".repeat(o)+"}"):n+="    ".repeat(o)+`${JSON.stringify(a)}: {}`:p===!0?n+="    ".repeat(o)+`${JSON.stringify(a)}: true`:p===!1?n+="    ".repeat(o)+`${JSON.stringify(a)}: false`:p===null?n+="    ".repeat(o)+`${JSON.stringify(a)}: null`:Number.isFinite(p)&&!Number.isNaN(p)?n+="    ".repeat(o)+`${JSON.stringify(a)}: `+p:n+="    ".repeat(o)+`${JSON.stringify(a)}: `+JSON.stringify(p),a!=Array.from(l.keys())[Array.from(l.keys()).length-1]?n+=`,\r
`:n+=`\r
`;else if(Array.isArray(l))for(var u=0,d=l.length;u<d;u++)typeof l[u]=="object"&&l[u]!==null?Array.isArray(l[u])?l[u].length>0?(n+="    ".repeat(o)+`[\r
`,t(l[u],o+1),n+="    ".repeat(o)+"]"):n+="    ".repeat(o)+"[]":Array.from(l[u].keys()).length>0?(n+="    ".repeat(o)+`{\r
`,t(l[u],o+1),n+="    ".repeat(o)+"}"):n+="    ".repeat(o)+"{}":l[u]===!0?n+="    ".repeat(o)+"true":l[u]===!1?n+="    ".repeat(o)+"false":l[u]===null?n+="    ".repeat(o)+"null":Number.isFinite(l[u])&&!Number.isNaN(l[u])?n+="    ".repeat(o)+l[u]:n+="    ".repeat(o)+JSON.stringify(l[u]),u!=d-1?n+=`,\r
`:n+=`\r
`}}getPathsList(e){let n=this.damonToMap(e),t=[];return l(n),t;function l(o,u=[]){if(typeof o=="object"&&o!==null&&!Array.isArray(o)&&o instanceof Map&&o.constructor===Map)for(let[d,a]of o)typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map&&Array.from(a.keys()).length?(t.push(u.concat(d)),l(a,u.concat([d]))):Array.isArray(a)&&(o.damonInlineArrays==null||o.damonInlineArrays.indexOf(d)===-1)&&a.length?(t.push(u.concat(d)),l(a,u.concat([d]))):t.push(u.concat(d).concat(a));else for(let d=0,a=o.length;d<a;d++)typeof o[d]=="object"&&o[d]!==null&&!Array.isArray(o[d])&&o[d]instanceof Map&&o[d].constructor===Map&&Array.from(o[d].keys()).length?(t.push(u.concat(d)),l(o[d],u.concat([d]))):Array.isArray(o[d])&&(o.damonInlineArrays==null||o.damonInlineArrays.indexOf(d)===-1)&&o[d].length?(t.push(u.concat(d)),l(o[d],u.concat([d]))):t.push(u.concat(o[d]))}}getRangeFromPath(e,r){let n=this,t=n.damonToMap(e),l=-1,o=!1;c(t,r);let u=n.mapIndexToLine(t,l),d=n._getLines(e)[u],a=0,p=d.length;if(r.length==1)typeof r[r.length-1]=="string"?a=d.length-d.trimStart().slice(2+r[r.length-1].length+2).trimStart().length:a=d.length-d.trimStart().slice(2).length;else if(typeof r[r.length-2]=="string")if(typeof r[r.length-1]=="string")a=d.length-d.trimStart().slice(2+r[r.length-1].length+2).trimStart().length;else if(d[d.length-1]=="]"&&!/\[ *\]$/.test(d)){let f=d.trimStart().slice(2+r[r.length-2].length+2),h=JSON.parse(f),b=h.slice(0,r[r.length-1].length).reduce((S,m)=>S+(m===h[r[r.length-1]]),0),y=0,x=h[r[r.length-1]];typeof x=="string"&&(x='"'+x+'"');for(let S=0,m=b+1;S<m;S++)y=f.indexOf(x,y);a=d.length-f.length+y,p=a+x.length}else a=d.length-d.trimStart().slice(2).length;else if(typeof r[r.length-1]=="string")a=d.length-d.trimStart().slice(2+r[r.length-1].length+2).trimStart().length;else if(d[d.length-1]=="]"&&!/\[ *\]$/.test(d)){let f=d.trimStart().slice(2),h=JSON.parse(f),b=h.slice(0,r[r.length-1]).reduce((S,m)=>S+(m===h[r[r.length-1]]),0),y=0,x=h[r[r.length-1]];typeof x=="string"&&(x='"'+x+'"');for(let S=0,m=b+1;S<m;S++)y=f.indexOf(x,y);a=d.length-f.length+y,p=a+x.length}else a=d.length-d.trimStart().slice(2).length;return[[u,a],[u,p]];function c(f,h,b=[]){if(l+=1,typeof f=="object"&&f!==null&&!Array.isArray(f)&&f instanceof Map&&f.constructor===Map)for(let[y,x]of f){if(o==!0)return;if(l+=1,JSON.stringify(h)===JSON.stringify(b.concat([y]))){o=!0;return}if(typeof x=="object"&&x!==null&&!Array.isArray(x)&&x instanceof Map&&x.constructor===Map&&Array.from(x.keys()).length)l-=1,c(x,h,b.concat([y]));else if(Array.isArray(x)&&x.length){if(f.damonInlineArrays==null||f.damonInlineArrays.indexOf(y)===-1)l-=1,c(x,h,b.concat([y]));else if(JSON.stringify(h.slice(0,-1))===JSON.stringify(b.concat([y]))){o=!0;return}}}else for(let y=0,x=f.length;y<x;y++){if(o==!0)return;if(l+=1,JSON.stringify(h)===JSON.stringify(b.concat([y]))){o=!0;return}if(typeof f[y]=="object"&&f[y]!==null&&!Array.isArray(f[y])&&f[y]instanceof Map&&f[y].constructor===Map&&Array.from(f[y].keys()).length)l-=1,c(f[y],h,b.concat([y]));else if(Array.isArray(f[y])&&f[y].length){if(f.damonInlineArrays==null||f.damonInlineArrays.indexOf(y)===-1)l-=1,c(f[y],h,b.concat([y]));else if(JSON.stringify(h.slice(0,-1))===JSON.stringify(b.concat([y]))){o=!0;return}}}}}getTokenFromCoordinates(e,r){let n=this,t={},l=n._getLines(e).slice(0,r[0]);if(l[r[0]-1]=="")return t.type="newline",t.path=null,t.range=[r,r],t;if(/^[ \t]+$/.test(l[r[0]-1]))return t.type="indentation",t.path=null,t.range=[[r[0],1],[r[0],l[l.length-1].length]],t;if(/^[ \t]+/.test(l[r[0]-1].slice(0,r[1]-1))&&(t.type="indentation",t.range=[[r[0],1],[r[0],l[r[0]-1].match(/^[ \t]+/)[0].length]]),/^ *\/\//.test(l[r[0]-1]))return t.type=="indentation"?(t.path=null,t):(t.type="comment",t.path=null,t.range=[[[r[0],l[r[0]-1].split("//")[0].length]],[[r[0],l[r[0]-1].length]]],t);if(l.length==1)try{let p=JSON.parse(e);if(p===!0||p===!1||p===null||typeof p=="string"||typeof p=="number"){let c=e.match(/^ */)[0].length,f=e.match(/ *$/)[0].length;return t.type="null",typeof p!="object"&&(t.type=typeof p),t.path=null,t.range=[[0,c],[0,e.length-f]],t}}catch{}let o=n.damonToMap(l.join(`
`)),u=Array.from(o.keys()),d=[];for(;u.length;){let p=u[u.length-1];if(d.push(p),typeof o=="object"&&o!==null&&!Array.isArray(o)&&o instanceof Map&&o.constructor===Map?o=o.get(p):Array.isArray(o)&&(o=o[p]),o===!0||o===!1||o===null||typeof o=="string"||typeof o=="number")break;u=Array.from(o.keys())}t.path=d;let a=n.getRangeFromPath(e,d);if(typeof d[d.length-1]=="string")if(r[1]<a[0][1]){let p=l[r[0]-1].slice(0,-1*(a[1][1]-a[0][1])-1).length;if(r[1]<p){let c=l[r[0]-1].match(/^[ \t]+/)[0].length+3;r[1]>=c?(t.type="property",t.range=[[r[0],c],[r[0],p]]):(t.type="hyphen",t.range=[[r[0],c-2],[r[0],c-1]])}else t.type="separator",t.range=[[r[0],p+1],[r[0],a[0][1]-1]]}else t.type="?",t.range=a;else if(r[1]<a[0][1]){t.type="hyphen";let p=l[r[0]-1].match(/^[ \t]+/)[0].length+1;t.range=[[r[0],p],[r[0],p+1]]}else t.type="?",t.range=a;return t}mapIndexToLine(e,r){let n=0,t=0;e.headless&&(r-=1);for(let l=0,o=e.damonOriginalLinesMapping.length;l<o;l++)if(e.damonOriginalLinesMapping[l]!==null&&t++,t==r){n=l+1;break}return n}}});var at=oe((qn,br)=>{br.exports=class{constructor(e){let r=this;this.parent=e,this.itemHeight=parseFloat(getComputedStyle(this.parent.editor).getPropertyValue("--fontSize"))*parseFloat(getComputedStyle(this.parent.editor).getPropertyValue("--lineHeight")),this.viewportHeight=this.parent.editor.getBoundingClientRect().height,this.viewable=Math.ceil(r.viewportHeight/r.itemHeight),this.maxCounter=this.parent.textarea.value.split(`
`).length,this.buffer=r.viewable*2,this.visibleNodesCount=r.viewable+r.buffer,this.lastScrollTop=void 0,this.lastStart=void 0,this.active=!1}inputHandler(e){let r=this;r.parent.textarea.value.split(`
`).length<=r.visibleNodesCount?(r.parent.gutter.innerHTML="",r.init(0)):(r.parent.gutter.innerHTML="",r.init(r.getStartNode(r.parent.textarea.value.split(`
`).length)))}scrollHandler(){let e=this;e.maxCounter<e.visibleNodesCount?e.lastScrollTop!==e.parent.editor.scrollTop?(e.parent.gutter.innerHTML="",e.parent.editor.style.setProperty("--scrollbarPadding","0px"),e.init(0)):(e.parent.editor.style.setProperty("--scrollbarPadding","0px"),e.parent.gutter.style.transform="translate("+e.parent.editor.scrollLeft+"px, "+0*e.itemHeight+"px)",e.parent.overlay.firstElementChild.style.transform="translate(0px, "+0*e.itemHeight+"px)"):e.lastScrollTop!==e.parent.editor.scrollTop?(e.active=!0,e.parent.editor.style.setProperty("--scrollbarPadding","var(--textareaPadding) * 4"),e.update(e.getStartNode(e.maxCounter))):(e.parent.gutter.style.transform="translate("+e.parent.editor.scrollLeft+"px, "+e.getStartNode(e.maxCounter)*e.itemHeight+"px)",e.parent.overlay.firstElementChild.style.transform="translate(0px, "+e.getStartNode(e.maxCounter)*e.itemHeight+"px)")}init(e){let r=this;r.parent.textarea.style.height=(r.parent.textarea.value.split(`
`).length+1)*r.itemHeight+"px",r.resetProperties(),e>r.maxCounter-r.visibleNodesCount&&(r.maxCounter-r.visibleNodesCount>0?e=r.maxCounter-r.visibleNodesCount:e=0);let n=Math.max(1,Math.min(r.maxCounter-e,r.visibleNodesCount));for(let d=e;d<e+n;d++){let a=document.createElement("div"),p=document.createElement("span"),c=(r.maxCounter+"").length,f=(d+1+"").length,h=c-f;p.textContent=" ".repeat(h)+(d+1),a.appendChild(p),r.parent.gutter.appendChild(a)}r.parent.gutter.style.transform="translate("+r.parent.editor.scrollLeft+"px, "+e*r.itemHeight+"px)",r.parent.overlay.firstElementChild.style.transform="translate(0px, "+e*r.itemHeight+"px)",r.lastStart=e,r.lastScrollTop=r.parent.editor.scrollTop,r.maxCounter>=r.visibleNodesCount&&(r.active=!0),r.setGutterWidth(),r.parent.updateCurrentLine(!0);let t=r.parent.textarea.value.split(`
`);r.parent.textarea.rows=t.length+1,r.parent.textarea.cols=t.map(d=>d.length).reduce(function(d,a){return Math.max(d,a)});let l=r.parent.textarea.value.replaceAll(/&amp;/g,"&").replaceAll(/&lt;/g,"<").replaceAll(/&gt;/g,">"),o=[`<span class="token lf">
</span>`],u=r.parent.lastTextareaValue.split(`
`);l!=""&&(o=r.parent.prism.highlight(l+`
`,r.parent.prism.languages.damon,"damon").replace(/<span>\n<\/span>$/,"").split(`
`).map(d=>d.replace(/^<\/span>/,"")+`
</span>`));for(let d=e,a=e+n;d<a;d++){let p=document.createElement("span"),c=0;p.classList.add("space-line"),p.innerHTML=o[d];for(let f=0,h=p.children.length;f<h&&p.children[f].textContent==" ";f++)c++,c==4&&(c=0,p.children[f-3].classList.add("indent-guide"));(!r.parent.initialized||u[d]==null||u[d]!=t[d]||r.parent.overlay.firstElementChild.children[d-e]!=null&&p.innerHTML!=r.parent.overlay.firstElementChild.children[d-e].innerHTML)&&(u[d]==null||!r.parent.initialized?(r.parent.overlay.firstElementChild.appendChild(p),r.parent.overlay.firstElementChild.children.length>n+1&&r.parent.overlay.firstElementChild.firstElementChild.remove()):r.parent.overlay.firstElementChild.replaceChild(p,r.parent.overlay.firstElementChild.children[d-e]))}if(r.parent.overlay.firstElementChild.children.length>n)for(let d=n,a=r.parent.overlay.firstElementChild.children.length;d<a;d++)r.parent.overlay.firstElementChild.lastElementChild.remove()}getStartNode(e){let r=this,n=Math.floor(r.parent.editor.scrollTop/r.itemHeight)-r.viewable;return n=Math.min(Math.max(0,n),Math.max(0,e-r.buffer)),n}resetProperties(){let e=this;e.viewportHeight=e.parent.editor.getBoundingClientRect().height,e.viewable=Math.ceil(e.viewportHeight/e.itemHeight),e.maxCounter=e.parent.textarea.value.split(`
`).length,e.buffer=e.viewable*2,e.visibleNodesCount=e.viewable+e.buffer,e.active=!1}update(e){let r=this;if(r.resetProperties(),r.parent.gutter.firstElementChild)if(r.lastScrollTop!=r.parent.editor.scrollTop)e>r.maxCounter-r.visibleNodesCount&&(r.maxCounter-r.visibleNodesCount>0?e=r.maxCounter-r.visibleNodesCount:e=0),r.diffItems(e,r.visibleNodesCount),r.parent.gutter.style.transform="translate("+r.parent.editor.scrollLeft+"px, "+e*r.itemHeight+"px)",r.parent.overlay.firstElementChild.style.transform="translate(0px, "+e*r.itemHeight+"px)",r.lastScrollTop=r.parent.editor.scrollTop;else if(/^translate\(.+px, .+px\)$/.test(r.parent.gutter.style.transform))r.parent.gutter.style.transform="translate("+r.parent.editor.scrollLeft+"px, "+r.parent.gutter.style.transform.split(", ")[1];else throw new Error("You need to update this regex.");r.setGutterWidth(),r.parent.updateCurrentLine(!0)}diffItems(e,r){let n=this;if(n.lastStart!=e){if(n.lastStart<e){let t=Math.min(r,Math.abs(e-n.lastStart));for(let a=0,p=t;a<p;a++)n.parent.gutter.firstElementChild.remove();for(let a=e+r-t;a<e+r;a++){let p=document.createElement("div"),c=document.createElement("span"),f=(n.maxCounter+"").length,h=(a+1+"").length,b=f-h;c.textContent=" ".repeat(b)+(a+1),p.appendChild(c),n.parent.gutter.appendChild(p)}let l=n.parent.textarea.value.split(`
`);n.parent.textarea.rows=l.length+1,n.parent.textarea.cols=l.map(a=>a.length).reduce(function(a,p){return Math.max(a,p)});let o=n.parent.textarea.value.replaceAll(/&amp;/g,"&").replaceAll(/&lt;/g,"<").replaceAll(/&gt;/g,">"),u=n.parent.prism.highlight(o+`
`,n.parent.prism.languages.damon,"damon").replace(/<span>\n<\/span>$/,"").split(`
`).map(a=>a.replace(/^<\/span>/,"")+`
</span>`),d=n.parent.lastTextareaValue.split(`
`);for(let a=0,p=t;a<p;a++)n.parent.overlay.firstElementChild.firstElementChild.remove();for(let a=e+r-t;a<e+r;a++){let p=document.createElement("span"),c=0;p.classList.add("space-line"),p.innerHTML=u[a];for(let f=0,h=p.children.length;f<h&&p.children[f].textContent==" ";f++)c++,c==4&&(c=0,p.children[f-3].classList.add("indent-guide"));n.parent.overlay.firstElementChild.appendChild(p)}}else{let t=Math.min(r,Math.abs(n.lastStart-e));for(let c=0,f=t;c<f;c++)n.parent.gutter.lastElementChild.remove();let l=document.createDocumentFragment();for(let c=e;c<e+t;c++){let f=document.createElement("div"),h=document.createElement("span"),b=(n.maxCounter+"").length,y=(c+1+"").length,x=b-y;h.textContent=" ".repeat(x)+(c+1),f.appendChild(h),l.appendChild(f)}n.parent.gutter.insertBefore(l,n.parent.gutter.firstElementChild);let o=n.parent.textarea.value.split(`
`);n.parent.textarea.rows=o.length+1,n.parent.textarea.cols=o.map(c=>c.length).reduce(function(c,f){return Math.max(c,f)});let u=n.parent.textarea.value.replaceAll(/&amp;/g,"&").replaceAll(/&lt;/g,"<").replaceAll(/&gt;/g,">"),d=n.parent.prism.highlight(u+`
`,n.parent.prism.languages.damon,"damon").replace(/<span>\n<\/span>$/,"").split(`
`).map(c=>c.replace(/^<\/span>/,"")+`
</span>`),a=n.parent.lastTextareaValue.split(`
`);for(let c=0,f=t;c<f;c++)n.parent.overlay.firstElementChild.lastElementChild.remove();let p=document.createDocumentFragment();for(let c=e;c<e+t;c++){let f=document.createElement("span"),h=0;f.classList.add("space-line"),f.innerHTML=d[c];for(let b=0,y=f.children.length;b<y&&f.children[b].textContent==" ";b++)h++,h==4&&(h=0,f.children[b-3].classList.add("indent-guide"));p.appendChild(f)}n.parent.overlay.firstElementChild.insertBefore(p,n.parent.overlay.firstElementChild.firstElementChild)}n.lastStart=e}}setGutterWidth(){let e=this,r=e.parent.gutter.children[0].children[0].getBoundingClientRect().width,n=parseFloat(getComputedStyle(e.parent.editor).getPropertyValue("--gutterWidth"));r>n?(e.parent.gutter.style.width=r+"px",e.parent.container.style.left=r+"px"):(e.parent.gutter.style.width="",e.parent.container.style.left="")}}});var Mr=oe((Yn,Hr)=>{"use strict";var{entries:Rr,setPrototypeOf:Ar,isFrozen:mn,getPrototypeOf:gn,getOwnPropertyDescriptor:yn}=Object,{freeze:Z,seal:ee,create:Dr}=Object,{apply:dt,construct:pt}=typeof Reflect<"u"&&Reflect;Z||(Z=function(e){return e});ee||(ee=function(e){return e});dt||(dt=function(e,r,n){return e.apply(r,n)});pt||(pt=function(e,r){return new e(...r)});var Fe=Q(Array.prototype.forEach),xn=Q(Array.prototype.lastIndexOf),wr=Q(Array.prototype.pop),we=Q(Array.prototype.push),En=Q(Array.prototype.splice),Je=Q(String.prototype.toLowerCase),ot=Q(String.prototype.toString),Sr=Q(String.prototype.match),Se=Q(String.prototype.replace),Nn=Q(String.prototype.indexOf),bn=Q(String.prototype.trim),re=Q(Object.prototype.hasOwnProperty),X=Q(RegExp.prototype.test),Te=An(TypeError);function Q(i){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];return dt(i,e,n)}}function An(i){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return pt(i,r)}}function H(i,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Je;Ar&&Ar(i,null);let n=e.length;for(;n--;){let t=e[n];if(typeof t=="string"){let l=r(t);l!==t&&(mn(e)||(e[n]=l),t=l)}i[t]=!0}return i}function wn(i){for(let e=0;e<i.length;e++)re(i,e)||(i[e]=null);return i}function se(i){let e=Dr(null);for(let[r,n]of Rr(i))re(i,r)&&(Array.isArray(n)?e[r]=wn(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=se(n):e[r]=n);return e}function Ce(i,e){for(;i!==null;){let n=yn(i,e);if(n){if(n.get)return Q(n.get);if(typeof n.value=="function")return Q(n.value)}i=gn(i)}function r(){return null}return r}var Tr=Z(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),st=Z(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ft=Z(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Sn=Z(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ut=Z(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Tn=Z(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Cr=Z(["#text"]),Or=Z(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ct=Z(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Lr=Z(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Be=Z(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Cn=ee(/\{\{[\w\W]*|[\w\W]*\}\}/gm),On=ee(/<%[\w\W]*|[\w\W]*%>/gm),Ln=ee(/\$\{[\w\W]*/gm),_n=ee(/^data-[\-\w.\u00B7-\uFFFF]+$/),vn=ee(/^aria-[\-\w]+$/),kr=ee(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Rn=ee(/^(?:\w+script|data):/i),Dn=ee(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ir=ee(/^html$/i),kn=ee(/^[a-z][.\w]*(-[.\w]+)+$/i),_r=Object.freeze({__proto__:null,ARIA_ATTR:vn,ATTR_WHITESPACE:Dn,CUSTOM_ELEMENT:kn,DATA_ATTR:_n,DOCTYPE_NAME:Ir,ERB_EXPR:On,IS_ALLOWED_URI:kr,IS_SCRIPT_OR_DATA:Rn,MUSTACHE_EXPR:Cn,TMPLIT_EXPR:Ln}),Oe={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},In=function(){return typeof window>"u"?null:window},$n=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,t="data-tt-policy-suffix";r&&r.hasAttribute(t)&&(n=r.getAttribute(t));let l="dompurify"+(n?"#"+n:"");try{return e.createPolicy(l,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}},vr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function $r(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:In(),e=R=>$r(R);if(e.version="3.2.6",e.removed=[],!i||!i.document||i.document.nodeType!==Oe.document||!i.Element)return e.isSupported=!1,e;let{document:r}=i,n=r,t=n.currentScript,{DocumentFragment:l,HTMLTemplateElement:o,Node:u,Element:d,NodeFilter:a,NamedNodeMap:p=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:c,DOMParser:f,trustedTypes:h}=i,b=d.prototype,y=Ce(b,"cloneNode"),x=Ce(b,"remove"),S=Ce(b,"nextSibling"),m=Ce(b,"childNodes"),E=Ce(b,"parentNode");if(typeof o=="function"){let R=r.createElement("template");R.content&&R.content.ownerDocument&&(r=R.content.ownerDocument)}let A,w="",{implementation:T,createNodeIterator:g,createDocumentFragment:s,getElementsByTagName:O}=r,{importNode:C}=n,_=vr();e.isSupported=typeof Rr=="function"&&typeof E=="function"&&T&&T.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:k,ERB_EXPR:P,TMPLIT_EXPR:I,DATA_ATTR:D,ARIA_ATTR:$,IS_SCRIPT_OR_DATA:U,ATTR_WHITESPACE:F,CUSTOM_ELEMENT:z}=_r,{IS_ALLOWED_URI:te}=_r,J=null,Le=H({},[...Tr,...st,...ft,...ut,...Cr]),q=null,mt=H({},[...Or,...ct,...Lr,...Be]),G=Object.seal(Dr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ee=null,ze=null,gt=!0,Ge=!0,yt=!1,xt=!0,ue=!1,_e=!0,fe=!1,Ve=!1,We=!1,ce=!1,ve=!1,Re=!1,Et=!0,Nt=!1,Gr="user-content-",qe=!0,Ne=!1,de={},pe=null,bt=H({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),At=null,wt=H({},["audio","video","img","source","image","track"]),Ye=null,St=H({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),De="http://www.w3.org/1998/Math/MathML",ke="http://www.w3.org/2000/svg",ie="http://www.w3.org/1999/xhtml",he=ie,Ke=!1,Xe=null,Vr=H({},[De,ke,ie],ot),Ie=H({},["mi","mo","mn","ms","mtext"]),$e=H({},["annotation-xml"]),Wr=H({},["title","style","font","a","script"]),be=null,qr=["application/xhtml+xml","text/html"],Yr="text/html",W=null,me=null,Kr=r.createElement("form"),Tt=function(N){return N instanceof RegExp||N instanceof Function},Ze=function(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(me&&me===N)){if((!N||typeof N!="object")&&(N={}),N=se(N),be=qr.indexOf(N.PARSER_MEDIA_TYPE)===-1?Yr:N.PARSER_MEDIA_TYPE,W=be==="application/xhtml+xml"?ot:Je,J=re(N,"ALLOWED_TAGS")?H({},N.ALLOWED_TAGS,W):Le,q=re(N,"ALLOWED_ATTR")?H({},N.ALLOWED_ATTR,W):mt,Xe=re(N,"ALLOWED_NAMESPACES")?H({},N.ALLOWED_NAMESPACES,ot):Vr,Ye=re(N,"ADD_URI_SAFE_ATTR")?H(se(St),N.ADD_URI_SAFE_ATTR,W):St,At=re(N,"ADD_DATA_URI_TAGS")?H(se(wt),N.ADD_DATA_URI_TAGS,W):wt,pe=re(N,"FORBID_CONTENTS")?H({},N.FORBID_CONTENTS,W):bt,Ee=re(N,"FORBID_TAGS")?H({},N.FORBID_TAGS,W):se({}),ze=re(N,"FORBID_ATTR")?H({},N.FORBID_ATTR,W):se({}),de=re(N,"USE_PROFILES")?N.USE_PROFILES:!1,gt=N.ALLOW_ARIA_ATTR!==!1,Ge=N.ALLOW_DATA_ATTR!==!1,yt=N.ALLOW_UNKNOWN_PROTOCOLS||!1,xt=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ue=N.SAFE_FOR_TEMPLATES||!1,_e=N.SAFE_FOR_XML!==!1,fe=N.WHOLE_DOCUMENT||!1,ce=N.RETURN_DOM||!1,ve=N.RETURN_DOM_FRAGMENT||!1,Re=N.RETURN_TRUSTED_TYPE||!1,We=N.FORCE_BODY||!1,Et=N.SANITIZE_DOM!==!1,Nt=N.SANITIZE_NAMED_PROPS||!1,qe=N.KEEP_CONTENT!==!1,Ne=N.IN_PLACE||!1,te=N.ALLOWED_URI_REGEXP||kr,he=N.NAMESPACE||ie,Ie=N.MATHML_TEXT_INTEGRATION_POINTS||Ie,$e=N.HTML_INTEGRATION_POINTS||$e,G=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&Tt(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&Tt(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(G.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ue&&(Ge=!1),ve&&(ce=!0),de&&(J=H({},Cr),q=[],de.html===!0&&(H(J,Tr),H(q,Or)),de.svg===!0&&(H(J,st),H(q,ct),H(q,Be)),de.svgFilters===!0&&(H(J,ft),H(q,ct),H(q,Be)),de.mathMl===!0&&(H(J,ut),H(q,Lr),H(q,Be))),N.ADD_TAGS&&(J===Le&&(J=se(J)),H(J,N.ADD_TAGS,W)),N.ADD_ATTR&&(q===mt&&(q=se(q)),H(q,N.ADD_ATTR,W)),N.ADD_URI_SAFE_ATTR&&H(Ye,N.ADD_URI_SAFE_ATTR,W),N.FORBID_CONTENTS&&(pe===bt&&(pe=se(pe)),H(pe,N.FORBID_CONTENTS,W)),qe&&(J["#text"]=!0),fe&&H(J,["html","head","body"]),J.table&&(H(J,["tbody"]),delete Ee.tbody),N.TRUSTED_TYPES_POLICY){if(typeof N.TRUSTED_TYPES_POLICY.createHTML!="function")throw Te('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof N.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Te('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=N.TRUSTED_TYPES_POLICY,w=A.createHTML("")}else A===void 0&&(A=$n(h,t)),A!==null&&typeof w=="string"&&(w=A.createHTML(""));Z&&Z(N),me=N}},Ct=H({},[...st,...ft,...Sn]),Ot=H({},[...ut,...Tn]),Xr=function(N){let L=E(N);(!L||!L.tagName)&&(L={namespaceURI:he,tagName:"template"});let v=Je(N.tagName),B=Je(L.tagName);return Xe[N.namespaceURI]?N.namespaceURI===ke?L.namespaceURI===ie?v==="svg":L.namespaceURI===De?v==="svg"&&(B==="annotation-xml"||Ie[B]):!!Ct[v]:N.namespaceURI===De?L.namespaceURI===ie?v==="math":L.namespaceURI===ke?v==="math"&&$e[B]:!!Ot[v]:N.namespaceURI===ie?L.namespaceURI===ke&&!$e[B]||L.namespaceURI===De&&!Ie[B]?!1:!Ot[v]&&(Wr[v]||!Ct[v]):!!(be==="application/xhtml+xml"&&Xe[N.namespaceURI]):!1},ne=function(N){we(e.removed,{element:N});try{E(N).removeChild(N)}catch{x(N)}},ge=function(N,L){try{we(e.removed,{attribute:L.getAttributeNode(N),from:L})}catch{we(e.removed,{attribute:null,from:L})}if(L.removeAttribute(N),N==="is")if(ce||ve)try{ne(L)}catch{}else try{L.setAttribute(N,"")}catch{}},Lt=function(N){let L=null,v=null;if(We)N="<remove></remove>"+N;else{let V=Sr(N,/^[\r\n\t ]+/);v=V&&V[0]}be==="application/xhtml+xml"&&he===ie&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");let B=A?A.createHTML(N):N;if(he===ie)try{L=new f().parseFromString(B,be)}catch{}if(!L||!L.documentElement){L=T.createDocument(he,"template",null);try{L.documentElement.innerHTML=Ke?w:B}catch{}}let Y=L.body||L.documentElement;return N&&v&&Y.insertBefore(r.createTextNode(v),Y.childNodes[0]||null),he===ie?O.call(L,fe?"html":"body")[0]:fe?L.documentElement:Y},_t=function(N){return g.call(N.ownerDocument||N,N,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT|a.SHOW_PROCESSING_INSTRUCTION|a.SHOW_CDATA_SECTION,null)},Qe=function(N){return N instanceof c&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof p)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},vt=function(N){return typeof u=="function"&&N instanceof u};function le(R,N,L){Fe(R,v=>{v.call(e,N,L,me)})}let Rt=function(N){let L=null;if(le(_.beforeSanitizeElements,N,null),Qe(N))return ne(N),!0;let v=W(N.nodeName);if(le(_.uponSanitizeElement,N,{tagName:v,allowedTags:J}),_e&&N.hasChildNodes()&&!vt(N.firstElementChild)&&X(/<[/\w!]/g,N.innerHTML)&&X(/<[/\w!]/g,N.textContent)||N.nodeType===Oe.progressingInstruction||_e&&N.nodeType===Oe.comment&&X(/<[/\w]/g,N.data))return ne(N),!0;if(!J[v]||Ee[v]){if(!Ee[v]&&kt(v)&&(G.tagNameCheck instanceof RegExp&&X(G.tagNameCheck,v)||G.tagNameCheck instanceof Function&&G.tagNameCheck(v)))return!1;if(qe&&!pe[v]){let B=E(N)||N.parentNode,Y=m(N)||N.childNodes;if(Y&&B){let V=Y.length;for(let j=V-1;j>=0;--j){let ae=y(Y[j],!0);ae.__removalCount=(N.__removalCount||0)+1,B.insertBefore(ae,S(N))}}}return ne(N),!0}return N instanceof d&&!Xr(N)||(v==="noscript"||v==="noembed"||v==="noframes")&&X(/<\/no(script|embed|frames)/i,N.innerHTML)?(ne(N),!0):(ue&&N.nodeType===Oe.text&&(L=N.textContent,Fe([k,P,I],B=>{L=Se(L,B," ")}),N.textContent!==L&&(we(e.removed,{element:N.cloneNode()}),N.textContent=L)),le(_.afterSanitizeElements,N,null),!1)},Dt=function(N,L,v){if(Et&&(L==="id"||L==="name")&&(v in r||v in Kr))return!1;if(!(Ge&&!ze[L]&&X(D,L))){if(!(gt&&X($,L))){if(!q[L]||ze[L]){if(!(kt(N)&&(G.tagNameCheck instanceof RegExp&&X(G.tagNameCheck,N)||G.tagNameCheck instanceof Function&&G.tagNameCheck(N))&&(G.attributeNameCheck instanceof RegExp&&X(G.attributeNameCheck,L)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(L))||L==="is"&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&X(G.tagNameCheck,v)||G.tagNameCheck instanceof Function&&G.tagNameCheck(v))))return!1}else if(!Ye[L]){if(!X(te,Se(v,F,""))){if(!((L==="src"||L==="xlink:href"||L==="href")&&N!=="script"&&Nn(v,"data:")===0&&At[N])){if(!(yt&&!X(U,Se(v,F,"")))){if(v)return!1}}}}}}return!0},kt=function(N){return N!=="annotation-xml"&&Sr(N,z)},It=function(N){le(_.beforeSanitizeAttributes,N,null);let{attributes:L}=N;if(!L||Qe(N))return;let v={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q,forceKeepAttr:void 0},B=L.length;for(;B--;){let Y=L[B],{name:V,namespaceURI:j,value:ae}=Y,Ae=W(V),je=ae,K=V==="value"?je:bn(je);if(v.attrName=Ae,v.attrValue=K,v.keepAttr=!0,v.forceKeepAttr=void 0,le(_.uponSanitizeAttribute,N,v),K=v.attrValue,Nt&&(Ae==="id"||Ae==="name")&&(ge(V,N),K=Gr+K),_e&&X(/((--!?|])>)|<\/(style|title)/i,K)){ge(V,N);continue}if(v.forceKeepAttr)continue;if(!v.keepAttr){ge(V,N);continue}if(!xt&&X(/\/>/i,K)){ge(V,N);continue}ue&&Fe([k,P,I],Ht=>{K=Se(K,Ht," ")});let $t=W(N.nodeName);if(!Dt($t,Ae,K)){ge(V,N);continue}if(A&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!j)switch(h.getAttributeType($t,Ae)){case"TrustedHTML":{K=A.createHTML(K);break}case"TrustedScriptURL":{K=A.createScriptURL(K);break}}if(K!==je)try{j?N.setAttributeNS(j,V,K):N.setAttribute(V,K),Qe(N)?ne(N):wr(e.removed)}catch{ge(V,N)}}le(_.afterSanitizeAttributes,N,null)},Zr=function R(N){let L=null,v=_t(N);for(le(_.beforeSanitizeShadowDOM,N,null);L=v.nextNode();)le(_.uponSanitizeShadowNode,L,null),Rt(L),It(L),L.content instanceof l&&R(L.content);le(_.afterSanitizeShadowDOM,N,null)};return e.sanitize=function(R){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=null,v=null,B=null,Y=null;if(Ke=!R,Ke&&(R="<!-->"),typeof R!="string"&&!vt(R))if(typeof R.toString=="function"){if(R=R.toString(),typeof R!="string")throw Te("dirty is not a string, aborting")}else throw Te("toString is not a function");if(!e.isSupported)return R;if(Ve||Ze(N),e.removed=[],typeof R=="string"&&(Ne=!1),Ne){if(R.nodeName){let ae=W(R.nodeName);if(!J[ae]||Ee[ae])throw Te("root node is forbidden and cannot be sanitized in-place")}}else if(R instanceof u)L=Lt("<!---->"),v=L.ownerDocument.importNode(R,!0),v.nodeType===Oe.element&&v.nodeName==="BODY"||v.nodeName==="HTML"?L=v:L.appendChild(v);else{if(!ce&&!ue&&!fe&&R.indexOf("<")===-1)return A&&Re?A.createHTML(R):R;if(L=Lt(R),!L)return ce?null:Re?w:""}L&&We&&ne(L.firstChild);let V=_t(Ne?R:L);for(;B=V.nextNode();)Rt(B),It(B),B.content instanceof l&&Zr(B.content);if(Ne)return R;if(ce){if(ve)for(Y=s.call(L.ownerDocument);L.firstChild;)Y.appendChild(L.firstChild);else Y=L;return(q.shadowroot||q.shadowrootmode)&&(Y=C.call(n,Y,!0)),Y}let j=fe?L.outerHTML:L.innerHTML;return fe&&J["!doctype"]&&L.ownerDocument&&L.ownerDocument.doctype&&L.ownerDocument.doctype.name&&X(Ir,L.ownerDocument.doctype.name)&&(j="<!DOCTYPE "+L.ownerDocument.doctype.name+`>
`+j),ue&&Fe([k,P,I],ae=>{j=Se(j,ae," ")}),A&&Re?A.createHTML(j):j},e.setConfig=function(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ze(R),Ve=!0},e.clearConfig=function(){me=null,Ve=!1},e.isValidAttribute=function(R,N,L){me||Ze({});let v=W(R),B=W(N);return Dt(v,B,L)},e.addHook=function(R,N){typeof N=="function"&&we(_[R],N)},e.removeHook=function(R,N){if(N!==void 0){let L=xn(_[R],N);return L===-1?void 0:En(_[R],L,1)[0]}return wr(_[R])},e.removeHooks=function(R){_[R]=[]},e.removeAllHooks=function(){_=vr()},e}var Hn=$r();Hr.exports=Hn});var Ur=oe((Xn,Pr)=>{var M=Mr();Pr.exports=class{constructor(e){let r=this;r.damon=e,r.websiteRegex=/^(https?:\/\/)?[-a-zA-Z0-9]*[a-zA-Z0-9]+(\.[-a-zA-Z0-9]*[a-zA-Z0-9]+)+/,r.httpRegex=/^https?:\/\//}damonToSExpression(e){let r=this;return r.implicitMapToSExpression(r.damon.damonToMap(e))}escape(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}mapToHtmlList(e,r=!1,n=void 0){let t=this;try{t.damon.mapToJSON(e)}catch(a){throw console.log(a),new Error("Provided map value doesn't passes JSON.parse()")}var l=0,o=document.createElement("ul"),u;return n!==void 0&&(u=JSON.parse(n)),o.className="DAMON-List",d(e,o),o;function d(a,p,c=[]){if(typeof p!="object"||p==null||Array.isArray(p))throw new Error("Error List Item number "+l+": @param { {} } list");if(typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map){if(p.tagName=="UL")for(let[b,y]of a){let x=document.createElement("ul"),S=document.createElement("code"),m=document.createElement("span"),E=document.createElement("li");if(E.dataset.graphArbo=Array.from(a.keys()).indexOf(b),c.length>0&&(E.dataset.graphArbo=c.join("-")+"-"+Array.from(a.keys()).indexOf(b)),m.className="type-key",t.websiteRegex.test(b)){let A=b;t.httpRegex.test(b)||(A="https://"+b);let w=M.sanitize(`<a href="${A}">${A}</a>`);m.innerHTML=w}else n!==void 0&&b in u["@context"]?m.innerHTML=M.sanitize(`<a href="${u["@context"][b]["@id"]}">${b}</a>`):m.textContent=b;if(typeof y=="object"&&y!==null)if(Array.isArray(y))if(a.damonInlineArrays!==void 0&&a.damonInlineArrays.indexOf(b)>-1){S.innerHTML=m.outerHTML+": [";for(let A=0,w=y.length;A<w;A++){let T=document.createElement("span"),g=y[A];if(g===!0)T.textContent="true",T.className="type-boolean";else if(g===!1)T.textContent="false",T.className="type-boolean";else if(g===null)T.textContent="null",T.className="type-null";else if(Number.isFinite(g)&&!Number.isNaN(g))T.textContent=g+"",T.className="type-number";else{if(r)if(t.websiteRegex.test(g)){let s=g;t.httpRegex.test(g)||(s="https://"+g),T.innerHTML=M.sanitize(`<a href="${s}">"${s}"</a>`)}else T.innerHTML=`"${g}"`;else if(t.websiteRegex.test(g)){let s=g;t.httpRegex.test(g)||(s="https://"+g),T.innerHTML=M.sanitize(`<a href="${s}">"${s}"</a>`)}else T.textContent=`"${g}"`;T.className="type-string"}A!==0&&(S.innerHTML+=", "),S.appendChild(T)}S.innerHTML+="]",E.appendChild(S),E.appendChild(x),p.appendChild(E)}else S.innerHTML=m.outerHTML+": []",E.appendChild(S),E.appendChild(x),p.appendChild(E),d(y,x,c.concat([Array.from(a.keys()).indexOf(b)]));else a.implicitMaps!==void 0&&a.implicitMaps.indexOf(b)>-1?S.innerHTML=m.outerHTML:S.innerHTML=m.outerHTML+": {}",E.appendChild(S),E.appendChild(x),p.appendChild(E),d(y,x,c.concat([Array.from(a.keys()).indexOf(b)]));else{l++,S.innerHTML=m.outerHTML+": ";let A=document.createElement("span"),w=y;if(w===!0)A.textContent="true",A.className="type-boolean";else if(w===!1)A.textContent="false",A.className="type-boolean";else if(w===null)A.textContent="null",A.className="type-null";else if(Number.isFinite(w)&&!Number.isNaN(w))A.textContent=w+"",A.className="type-number";else{if(r)if(t.websiteRegex.test(w)){let T=w;t.httpRegex.test(w)||(T="https://"+w),A.innerHTML=M.sanitize(`<a href="${T}">"${T}"</a>`)}else A.innerHTML=`"${w}"`;else if(t.websiteRegex.test(w)){let T=w;t.httpRegex.test(w)||(T="https://"+w),A.innerHTML=M.sanitize(`<a href="${T}">"${T}"</a>`)}else A.textContent=`"${w}"`;A.className="type-string"}a.implicitNulls===void 0||a.implicitNulls.indexOf(b)==-1?S.appendChild(A):S.innerHTML=S.innerHTML.slice(0,-2),E.appendChild(S),p.appendChild(E)}}}else if(Array.isArray(a))for(var f=0,h=a.length;f<h;f++){let b=document.createElement("ul"),y=document.createElement("code"),x=document.createElement("li");if(x.dataset.graphArbo=f,c.length>0&&(x.dataset.graphArbo=c.join("-")+"-"+f),typeof a[f]=="object"&&a[f]!==null)if(Array.isArray(a[f]))if(a.damonInlineArrays!==void 0&&a.damonInlineArrays.indexOf(f)>-1){y.innerHTML+="[";for(let S=0,m=a[f].length;S<m;S++){let E=document.createElement("span"),A=a[f][S];if(A===!0)E.textContent="true",E.className="type-boolean";else if(A===!1)E.textContent="false",E.className="type-boolean";else if(A===null)E.textContent="null",E.className="type-null";else if(Number.isFinite(A)&&!Number.isNaN(A))E.textContent=A+"",E.className="type-number";else{if(r)if(t.websiteRegex.test(A)){let w=A;t.httpRegex.test(A)||(w="https://"+A),E.innerHTML=M.sanitize(`<a href="${w}">"${w}"</a>`)}else E.innerHTML=`"${A}"`;else if(t.websiteRegex.test(A)){let w=A;t.httpRegex.test(A)||(w="https://"+A),E.innerHTML=M.sanitize(`<a href="${w}">"${w}"</a>`)}else E.textContent=`"${A}"`;E.className="type-string"}S!==0&&(y.innerHTML+=", "),y.appendChild(E)}y.innerHTML+="]",x.appendChild(y),x.appendChild(b),p.appendChild(x)}else y.textContent="[]",x.appendChild(y),x.appendChild(b),p.appendChild(x),d(a[f],b,c.concat(f));else y.textContent="{}",x.appendChild(y),x.appendChild(b),p.appendChild(x),d(a[f],b,c.concat(f));else{l++;let S=a[f];if(S===!0)y.textContent="true",y.className="type-boolean";else if(S===!1)y.textContent="false",y.className="type-boolean";else if(S===null)y.textContent="null",y.className="type-null";else if(Number.isFinite(S)&&!Number.isNaN(S))y.textContent=S+"",y.className="type-number";else{if(r)if(t.websiteRegex.test(S)){let m=S;t.httpRegex.test(S)||(m="https://"+S),y.innerHTML=M.sanitize(`<a href="${m}">"${m}"</a>`)}else y.innerHTML=`"${S}"`;else if(t.websiteRegex.test(S)){let m=S;t.httpRegex.test(S)||(m="https://"+S),y.innerHTML=M.sanitize(`<a href="${m}">"${m}"</a>`)}else y.textContent=`"${S}"`;y.className="type-string"}x.appendChild(y),x.appendChild(b),p.appendChild(x)}}}}mapToHtmlTable(e,r=!1){let n=this;try{n.damon.mapToJSON(e)}catch{throw new Error("Provided map value doesn't passes JSON.parse()")}var t=0,l=document.createElement("table"),o=document.createElement("thead"),u=document.createElement("tbody"),d=!1,a=0;if(l.className="DAMON-Table",typeof e!="object"||e==null||Array.isArray(e)||!(e instanceof Map)||e.constructor!==Map)throw new Error("Error List Item number "+t+": @param { {} } list");for(let[p,c]of e){if(typeof c=="object"&&c!==null&&!Array.isArray(c)&&c instanceof Map&&c.constructor===Map)if(p=="0"&&!d){let f=document.createElement("tr");a=c.length;for(let[h,b]of c)if(b===null){let y=document.createElement("th");r?n.websiteRegex.test(h)?y.innerHTML=M.sanitize(`<a href="${h}">${h}</a>`):y.innerHTML=`${h}`:n.websiteRegex.test(h)?y.innerHTML=M.sanitize(`<a href="${h}">${h}</a>`):y.textContent=`${h}`,f.appendChild(y)}else throw new Error("Expected implicit null property, saw otherwise");o.appendChild(f),d=!0}else{if(a==0&&(a=c.length),c.length!=a)throw new Error("Error List Item number "+t+": @param { {} } list");let f=document.createElement("tr");for(let[h,b]of c)if(b===null){let y=document.createElement("td");r?n.websiteRegex.test(h)?y.innerHTML=M.sanitize(`<a href="${h}">${h}</a>`):y.innerHTML=`${h}`:n.websiteRegex.test(h)?y.innerHTML=M.sanitize(`<a href="${h}">${h}</a>`):y.textContent=`${h}`,f.appendChild(y)}else throw new Error("Expected implicit null property, saw otherwise");u.appendChild(f)}else if(typeof c!="object"&&p=="00"){let f=document.createElement("caption");r?f.innerHTML=c:f.textContent=c,l.appendChild(f)}else throw new Error("Error List Item number "+t+": @param { {} } list");t++}return d&&l.appendChild(o),l.appendChild(u),l}mapTreeLeavesToHtmlTable(e,r=!1){let n=this;try{n.damon.mapToJSON(e)}catch{throw new Error("Provided map value doesn't passes JSON.parse()")}var t=0,l=0,o=document.createElement("table"),u=document.createElement("thead"),d=document.createElement("tbody"),a=!1;if(o.className="DAMON-LeavesToTable",typeof e!="object"||e==null||Array.isArray(e)||!(e instanceof Map)||e.constructor!==Map)throw new Error("Error List Item number "+t+": @param { {} } list");for(let[c,f]of e){if(typeof f=="object"&&!Array.isArray(f)){if(c=="head"&&!a){try{p(f,u)}catch{return}a=!0}else if(c=="body")try{p(f,d)}catch{return}}else if(typeof f!="object"&&c=="caption"){let h=document.createElement("caption");r?h.innerHTML=f:h.textContent=f,o.appendChild(h)}else throw new Error("Error List Item number "+t+": @param { {} } list");t++}return a&&o.appendChild(u),o.appendChild(d),o;function p(c,f,h=0,b=[]){if(typeof f!="object"||f==null)throw new Error("Error List Item number "+t+": @param { {} } list");if(typeof c=="object"&&c!==null&&!Array.isArray(c)&&c instanceof Map&&c.constructor===Map){if(f.tagName=="THEAD")if(Array.from(c.keys()).length==1)if(typeof c.get(Array.from(c.keys())[0])=="object"&&c.get(Array.from(c.keys())[0])!==null)t++,p(c.get(Array.from(c.keys())[0]),f,h+1,b.concat([Array.from(c.keys())[0]]));else throw new Error("Error List Item number "+t+": @param { {} } list");else throw new Error("Error List Item number "+t+": @param { {} } list");else if(f.tagName=="TBODY"){if(Array.from(c.keys()).length==0)throw new Error("Error List Item number "+t+": @param { {} } list");for(let[y,x]of c)if(typeof x=="object"&&x!==null)t++,p(x,f,h+1,b.concat([y]));else throw new Error("Error List Item number "+t+": @param { {} } list")}}else if(Array.isArray(c)){if(f.tagName=="THEAD")if(c.length==1){t++,l=h;let y=document.createElement("tr");b.push(c[0]);for(let x=0,S=b.length;x<S;x++){let m=document.createElement("th");r?m.innerHTML=b[x]:m.textContent=b[x],y.appendChild(m)}f.appendChild(y)}else throw new Error("Error List Item number "+t+": @param { {} } list");else if(f.tagName=="TBODY")if(h==l){if(c.length==0)throw new Error("Error List Item number "+t+": @param { {} } list");for(let y=0,x=c.length;y<x;y++){t++;let S=document.createElement("tr");for(let E=0,A=b.length;E<A;E++){let w=document.createElement("td");r?w.innerHTML=b[E]:w.textContent=b[E],S.appendChild(w)}let m=document.createElement("td");r?m.innerHTML=c[y]:m.textContent=c[y],m.textContent=c[y],S.appendChild(m),f.appendChild(S)}}else throw new Error("Error List Item number "+t+": @param { {} } list")}}}htmlToJSON(e){let r=this;var n=0;if(e.firstElementChild.textContent=="{}")return r._mapToJSON(t(e,new Map));if(e.firstElementChild.textContent=="[]")return r._mapToJSON(t(e,[]));function t(l,o){if(typeof l!="object"||l==null||Array.isArray(l))throw new Error("Error List Item number "+n+": @param { {} } list");if(typeof o=="object"&&o!==null&&!Array.isArray(o)&&o instanceof Map&&o.constructor===Map){for(let u=0,d=l.children.length;u<d;u++)if(n++,l.children[u].tagName=="LI")if(l.children[u].firstElementChild.tagName=="CODE")if(l.children[u].firstElementChild.innerHTML.length){let a=l.children[u].firstElementChild.innerHTML.trim();if(a[a.length-1]==":"&&a.length>1){let p=l.children[u].children[1];if(p.tagName=="UL"&&p.firstElementChild.tagName=="LI"&&p.children.length==1&&p.firstElementChild.firstElementChild.tagName=="CODE"){n++;let c=p.firstElementChild.firstElementChild.textContent.trim();c=="true"?o.set(a.slice(0,-1),!0):c=="false"?o.set(a.slice(0,-1),!1):c=="null"?o.set(a.slice(0,-1),null):isFinite(c)&&!isNaN(parseFloat(c))?o.set(a.slice(0,-1),c*1):o.set(a.slice(0,-1),c)}else throw new Error("Error List Item number "+n+": not DAMON-compliant.")}else if(a[a.length-4]==":"&&a.length>4){if(a.slice(-3)==" []")if(o.set(a.slice(0,-4),[]),l.children[u].children[1].tagName=="UL")t(l.children[u].children[1],o.get(a.slice(0,-4)));else throw new Error("Error List Item number "+n+": not DAMON-compliant.");else if(a.slice(-3)==" {}")if(o.set(a.slice(0,-4),new Map),l.children[u].children[1].tagName=="UL")t(l.children[u].children[1],o.get(a.slice(0,-4)));else throw new Error("Error List Item number "+n+": not DAMON-compliant.")}else throw new Error("Error List Item number "+n+": map items need a key")}else throw new Error("Error List Item number "+n+": empty node.");else throw new Error("Error List Item number "+n+": not DAMON-compliant.")}else if(Array.isArray(o)){for(let u=0,d=l.children.length;u<d;u++)if(n++,l.children[u].tagName=="LI")if(l.children[u].firstElementChild.tagName=="CODE")if(l.children[u].firstElementChild.innerHTML.length){let a=l.children[u].firstElementChild.innerHTML.trim();if(a[a.length-1]==":"&&a.length>1)throw new Error("Error List Item number "+n+": lists can't have keys.");if(a[a.length-4]==":"&&a.length>4)throw new Error("Error List Item number "+n+": not DAMON-compliant.");if(a=="[]")if(o.push([]),l.children[u].children[1]&&l.children[u].children[1].tagName=="UL")t(l.children[u].children[1],o[o.length-1]);else throw new Error("Error List Item number "+n+": not DAMON-compliant.");else if(a=="{}")if(o.push({}),l.children[u].children[1]&&l.children[u].children[1].tagName=="UL")t(l.children[u].children[1],o[o.length-1]);else throw new Error("Error List Item number "+n+": not DAMON-compliant.");else a=="true"?o.push(!0):a=="false"?o.push(!1):a=="null"?o.push(null):isFinite(a)&&!isNaN(parseFloat(a))?o.push(a*1):o.push(a)}else throw new Error("Error List Item number "+n+": empty node.");else throw new Error("Error List Item number "+n+": not DAMON-compliant.")}else throw new Error("Error List Item number "+n+": @param { {} | [] } jsonMap");return o}}implicitMapToSExpression(e){let r=this;var n="";if(typeof e=="object"&&e!==null&&e instanceof Map&&e.constructor===Map)return n+=`[\r
`,t(e),n+="]",JSON.parse(n),n;return typeof e=="string"&&(e='"'+e+'"'),JSON.parse(e),e;function t(l,o=1){if(typeof l=="object"&&l!==null&&!Array.isArray(l)&&l instanceof Map&&l.constructor===Map){let a=-1;for(let[p,c]of l){if(a++,typeof c=="object"&&c!==null)if(Array.isArray(c))c.length>0?(n+="    ".repeat(o)+`${JSON.stringify(p)}, [\r
`,t(c,o+1),n+="    ".repeat(o)+"]"):n+="    ".repeat(o)+`${JSON.stringify(p)}, []`;else if(Array.from(c.keys()).length>0){if(o==1)if(a==0)n="";else throw new Error("Multiple S-Expression roots");n+="    ".repeat(o)+`[${JSON.stringify(p)}, \r
`,t(c,o+1),o!=1&&(n+="    ".repeat(o)+"]")}else n+="    ".repeat(o)+`${JSON.stringify(p)}, []`;else{if(c===!0)throw new Error("Booleans require quotes");if(c===!1)throw new Error("Booleans require quotes");c===null?n+="    ".repeat(o)+`${JSON.stringify(p)}`:Number.isFinite(c)&&!Number.isNaN(c)?n+="    ".repeat(o)+`${JSON.stringify(p)}, `+c:n+="    ".repeat(o)+`${JSON.stringify(p)}, `+JSON.stringify(c)}p!=Array.from(l.keys())[Array.from(l.keys()).length-1]?n+=`,\r
`:n+=`\r
`}}else if(Array.isArray(l))for(var u=0,d=l.length;u<d;u++){if(typeof l[u]=="object"&&l[u]!==null)Array.isArray(l[u])?l[u].length>0?(n+="    ".repeat(o)+`[\r
`,t(l[u],o+1),n+="    ".repeat(o)+"]"):n+="    ".repeat(o)+"[]":Array.from(l[u].keys()).length>0?(n+="    ".repeat(o)+`[\r
`,t(l[u],o+1),n+="    ".repeat(o)+"]"):n+="    ".repeat(o)+"[]";else{if(l[u]===!0)throw new Error("Booleans require quotes");if(l[u]===!1)throw new Error("Booleans require quotes");if(l[u]===null)throw new Error("Array-nulls require quotes");Number.isFinite(l[u])&&!Number.isNaN(l[u])?n+="    ".repeat(o)+l[u]:n+="    ".repeat(o)+JSON.stringify(l[u])}u!=d-1?n+=`,\r
`:n+=`\r
`}}}damonToMathJs(e){let r=this,n="",t=r.damon.damonToMap(e);if(Array.isArray(t))return o(t),n.slice(0,-1);return typeof t=="object"&&t!==null&&t instanceof Map&&t.constructor===Map?(o(t),n.slice(0,-1)):(typeof t=="string"&&(t=JSON.stringify(t)),JSON.parse(t),t);function l(u){return u[0].toLowerCase()+u.slice(1)}function o(u,d=0){if(typeof u=="object"&&u!==null&&!Array.isArray(u)&&u instanceof Map&&u.constructor===Map)for(let[c,f]of u)typeof f=="object"&&f!==null?Array.isArray(f)?f.length>0?(n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}(
`,o(f,d+1),n+="    ".repeat(d)+")"):n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}()`:Array.from(f.keys()).length>0?(n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}(
`,o(f,d+1),n+="    ".repeat(d)+")"):n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}()`:f===!0?n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}(true)`:f===!1?n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}(false)`:f===null?n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}`:Number.isFinite(f)&&!Number.isNaN(f)?n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}(`+f+")":n+="    ".repeat(d)+`${JSON.stringify(l(c)).slice(1,-1)}(`+JSON.stringify(f)+")",c!=Array.from(u.keys())[Array.from(u.keys()).length-1]?n+=`,
`:n+=`
`;else if(Array.isArray(u))for(var a=0,p=u.length;a<p;a++)typeof u[a]=="object"&&u[a]!==null?Array.isArray(u[a])?u[a].length>0?u.damonInlineArrays!==void 0&&u.damonInlineArrays.indexOf(a)>-1?u[a]===!0?n+="    ".repeat(d)+"true":u[a]===!1?n+="    ".repeat(d)+"false":u[a]===null?n+="    ".repeat(d)+"null":Number.isFinite(u[a])&&!Number.isNaN(u[a])?n+="    ".repeat(d)+u[a]:n+="    ".repeat(d)+JSON.stringify(u[a]).slice(1,-1):(n+="    ".repeat(d)+`(
`,o(u[a],d+1),n+="    ".repeat(d)+")"):n+="    ".repeat(d)+"()":Array.from(u[a].keys()).length>0?(n+="    ".repeat(d)+`(
`,o(u[a],d+1),n+="    ".repeat(d)+")"):n+="    ".repeat(d)+"()":u[a]===!0?n+="    ".repeat(d)+"true":u[a]===!1?n+="    ".repeat(d)+"false":u[a]===null?n+="    ".repeat(d)+"null":Number.isFinite(u[a])&&!Number.isNaN(u[a])?n+="    ".repeat(d)+u[a]:n+="    ".repeat(d)+JSON.stringify(u[a]).slice(1,-1),a!=p-1?n+=`,
`:n+=`
`}}_mapsDiff(e,r){let n=this;try{n.damon.mapToJSON(e),n.damon.mapToJSON(r)}catch{throw new Error("Provided map value doesn't passes JSON.parse()")}if(typeof e!=typeof r||typeof e=="object"&&e!==null&&!Array.isArray(e)&&e instanceof Map&&e.constructor===Map&&(r==null||Array.isArray(r)||!(r instanceof Map)||r.constructor!==Map))throw new Error("Different root types.");var t;if(typeof e=="object"&&e!==null&&!Array.isArray(e)&&e instanceof Map&&e.constructor===Map)return t=new Map,l(e),t;if(Array.isArray(e))return t=[],l(e),t;function l(o,u=[]){if(typeof o=="object"&&o!==null&&!Array.isArray(o)&&o instanceof Map&&o.constructor===Map){let d="",a=null,p=r;for(let h=0,b=u.length;h<b;h++)typeof p=="object"&&p!==null&&!Array.isArray(p)&&p instanceof Map&&p.constructor===Map?p=p.get(Array.from(p.keys())[u[h]]):p=p[u[h]];let c=t;for(let h=0,b=u.length;h<b;h++)typeof c=="object"&&c!==null&&!Array.isArray(c)&&c instanceof Map&&c.constructor===Map&&Array.from(c.keys()).length?c=c.get(Array.from(c.keys())[u[h]]):c=c[u[h]];let f=0;for(let[h,b]of o)f>Array.from(p.keys()).length-1?typeof b=="object"&&b!==null&&!Array.isArray(b)&&b instanceof Map&&b.constructor===Map?Array.from(p.keys()).indexOf(h)!==-1&&typeof p.get(h)=="object"&&p.get(h)!==null&&!Array.isArray(p.get(h))&&p.get(h)instanceof Map&&p.get(h).constructor===Map?c.set(f+"-yellow",null):c.set(f+"-red",null):Array.isArray(b)?Array.from(p.keys()).indexOf(h)!==-1&&Array.isArray(p.get(h))?c.set(f+"-yellow",null):c.set(f+"-red",null):Array.from(p.keys()).indexOf(h)!==-1&&b===p.get(h)?c.set(f+"-yellow",null):c.set(f+"-red",null):(d=Array.from(p.keys())[f],a=p.get(d),typeof b=="object"&&b!==null&&!Array.isArray(b)&&b instanceof Map&&b.constructor===Map?typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map&&h===d?(c.set(f+"-green",new Map),Array.from(b.keys()).length>0&&l(b,u.concat([f]))):c.set(f+"-red",null):Array.isArray(b)?Array.isArray(a)&&h===d?(c.set(f+"-green",[]),b.length>0&&l(b,u.concat([f]))):c.set(f+"-red",null):b===a&&h===d?c.set(f+"-green","green"):c.set(f+"-red",null)),f++;if(Array.from(o.keys()).length<Array.from(p.keys()).length){let h=0;for(let[b,y]of p){if(h<=f-1){h++;continue}typeof y=="object"&&y!==null&&!Array.isArray(y)&&y instanceof Map&&y.constructor===Map?Array.from(o.keys()).indexOf(b)!==-1&&typeof o.get(b)=="object"&&o.get(b)!==null&&!Array.isArray(o.get(b))&&o.get(b)instanceof Map&&o.get(b).constructor===Map?c.set(f+"-yellow",null):c.set(f+"-red",null):Array.isArray(y)?Array.from(o.keys()).indexOf(b)!==-1&&Array.isArray(o.get(b))?c.set(f+"-yellow",null):c.set(f+"-red",null):Array.from(o.keys()).indexOf(b)!==-1&&y===o.get(b)?c.set(f+"-yellow",null):c.set(f+"-red",null),h++}}}else{let d=null,a=r;for(let c=0,f=u.length;c<f;c++)typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map&&Array.from(a.keys()).length?a=a.get(Array.from(a.keys())[u[c]]):a=a[u[c]];let p=t;for(let c=0,f=u.length;c<f;c++)typeof p=="object"&&p!==null&&!Array.isArray(p)&&p instanceof Map&&p.constructor===Map&&Array.from(p.keys()).length?p=p.get(Array.from(p.keys())[u[c]]):p=p[u[c]];for(let c=0,f=o.length;c<f;c++)c>a.length-1?p[c]="red":(d=a[c],typeof o[c]=="object"&&o[c]!==null&&!Array.isArray(o[c])&&o[c]instanceof Map&&o[c].constructor===Map?typeof d=="object"&&d!==null&&!Array.isArray(d)&&d instanceof Map&&d.constructor===Map?(p[c]=new Map,Array.from(o[c].keys()).length>0&&l(o[c],u.concat([c]))):p[c]="red":Array.isArray(o[c])?Array.isArray(d)?(p[c]=[],o[c].length>0&&l(o[c],u.concat([c]))):p[c]="red":o[c]===d?p[c]="green":p[c]="red");if(o.length<a.length)for(let c=0,f=a.length;c<f;c++)c<=o.length-1||(p[c]="red")}}}sortMap(e,r){let n=this,t=Array.from(e.keys()),l=Array.from(r.keys()),o=new Map;for(let u=0,d=t.length;u<d;u++)r.get(t[u])!==void 0&&o.set(t[u],r.get(t[u]));for(let u=0,d=l.length;u<d;u++)t.indexOf(l[u])==-1&&o.set(l[u],r.get(l[u]));return o}renderDiff(e,r,n=!1){let t=this,l=document.createElement("div"),o=document.createElement("div"),u=document.createElement("ul"),d=t._mapsDiff(e,r);return l.className="DAMON-Diff",o.className="DAMON-Diff-legend",u.className="DAMON-List",o.innerHTML='<span id="damonDiffRed"><span>Red</span>: Difference</span>; <span id="damonDiffBlue"><span>Blue</span>: Addition</span>; <span id="damonDiffGreen"><span>Green</span>: Displacement</span>',a(d,u),l.appendChild(o),l.appendChild(u),l;function a(c,f,h=[],b="green"){if(b==="green"){if(typeof f!="object"||f==null||Array.isArray(f))throw new Error("Error List Item "+h.concat("-")+": @param { {} } list");if(typeof c=="object"&&c!==null&&!Array.isArray(c)&&c instanceof Map&&c.constructor===Map){if(f.tagName=="UL"){let S="",m=null,E=e;for(let s=0,O=h.length;s<O;s++)typeof E=="object"&&E!==null&&!Array.isArray(E)&&E instanceof Map&&E.constructor===Map?E=E.get(Array.from(E.keys())[h[s]]):E=E[h[s]];let A="",w=null,T=r;for(let s=0,O=h.length;s<O;s++)typeof T=="object"&&T!==null&&!Array.isArray(T)&&T instanceof Map&&T.constructor===Map?T=T.get(Array.from(T.keys())[h[s]]):T=T[h[s]];let g=0;for(let[s,O]of c){let C=Array.from(c.keys())[g].split("-")[1],_=c.get(Array.from(c.keys())[g]),k=document.createElement("ul"),P=document.createElement("code"),I=document.createElement("span"),D=document.createElement("li");if(I.className="type-key",D.className=C+"-diff",D.className==="red-diff"&&g<=Array.from(E.keys()).length-1?g>Array.from(T.keys()).length-1?(s="",O=""):(g>Array.from(E.keys()).length-1&&(D.className="blue-diff",D.setAttribute("aria-describedby","damonDiffBlue")),A=Array.from(T.keys())[g],w=T.get(A),s=A,O=w):D.className==="green-diff"?(D.dataset.graphArbo=g,h.length>0&&(D.dataset.graphArbo=h.join("-")+"-"+g),D.className="",S=Array.from(T.keys())[g],m=T.get(S),s=S,O=m):D.className==="yellow-diff"?g>Array.from(E.keys()).length-1?(D.className="green-diff",D.setAttribute("aria-describedby","damonDiffGreen"),S=Array.from(T.keys())[g],m=T.get(S),s=S,O=m):(s="",O="",D.className="red-diff",D.setAttribute("aria-describedby","damonDiffRed")):(D.className="blue-diff",D.setAttribute("aria-describedby","damonDiffBlue"),S=Array.from(T.keys())[g],m=T.get(S),s=S,O=m),D.className==="red-diff"&&D.setAttribute("aria-describedby","damonDiffRed"),t.websiteRegex.test(s)){let $=s;t.httpRegex.test(s)||($="https://"+s);let U=M.sanitize(`<a href="${$}">${$}</a>`);I.innerHTML=U}else I.textContent=s;if(typeof O=="object"&&O!==null)if(Array.isArray(O))if(e.damonInlineArrays!==void 0&&e.damonInlineArrays.indexOf(s)>-1){P.innerHTML=I.outerHTML+": [";for(let $=0,U=O.length;$<U;$++){let F=document.createElement("span"),z=O[$];if(z===!0)F.textContent="true",F.className="type-boolean";else if(z===!1)F.textContent="false",F.className="type-boolean";else if(z===null)F.textContent="null",F.className="type-null";else if(Number.isFinite(z)&&!Number.isNaN(z))F.textContent=z+"",F.className="type-number";else{if(n)if(t.websiteRegex.test(z)){let te=z;t.httpRegex.test(z)||(te="https://"+z),F.innerHTML=M.sanitize(`<a href="${te}">"${te}"</a>`)}else F.innerHTML=`"${z}"`;else if(t.websiteRegex.test(z)){let te=z;t.httpRegex.test(z)||(te="https://"+z),F.innerHTML=M.sanitize(`<a href="${te}">"${te}"</a>`)}else F.textContent=`"${z}"`;F.className="type-string"}$!==0&&(P.innerHTML+=", "),P.appendChild(F)}P.innerHTML+="]",D.appendChild(P),D.appendChild(k),f.appendChild(D)}else P.innerHTML=I.outerHTML+": []",D.appendChild(P),D.appendChild(k),f.appendChild(D),C=="green"?a(_,k,h.concat([g]),C):a(_,k,h.concat([g]),C);else e.implicitMaps!==void 0&&e.implicitMaps.indexOf(s)>-1?P.innerHTML=I.outerHTML:P.innerHTML=I.outerHTML+": {}",D.appendChild(P),D.appendChild(k),f.appendChild(D),C=="green"?a(_,k,h.concat([g]),C):a(_,k,h.concat([g]),C);else{P.innerHTML=I.outerHTML+": ";let $=document.createElement("span"),U=O;if(U===!0)$.textContent="true",$.className="type-boolean";else if(U===!1)$.textContent="false",$.className="type-boolean";else if(U===null)$.textContent="null",$.className="type-null";else if(Number.isFinite(U)&&!Number.isNaN(U))$.textContent=U+"",$.className="type-number";else{if(n)if(t.websiteRegex.test(U)){let F=U;t.httpRegex.test(U)||(F="https://"+U),$.innerHTML=M.sanitize(`<a href="${F}">"${F}"</a>`)}else $.innerHTML=`"${U}"`;else if(t.websiteRegex.test(U)){let F=U;t.httpRegex.test(U)||(F="https://"+U),$.innerHTML=M.sanitize(`<a href="${F}">"${F}"</a>`)}else $.textContent=`"${U}"`;$.className="type-string"}e.implicitNulls===void 0||e.implicitNulls.indexOf(s)==-1?P.appendChild($):P.innerHTML=P.innerHTML.slice(0,-2),D.appendChild(P),f.appendChild(D)}g++}}}else if(Array.isArray(c)){let S=e;for(let E=0,A=h.length;E<A;E++)typeof S=="object"&&S!==null&&!Array.isArray(S)&&S instanceof Map&&S.constructor===Map&&Array.from(S.keys()).length?S=S.get(Array.from(S.keys())[h[E]]):S=S[h[E]];let m=r;for(let E=0,A=h.length;E<A;E++)typeof m=="object"&&m!==null&&!Array.isArray(m)&&m instanceof Map&&m.constructor===Map&&Array.from(m.keys()).length?m=m.get(Array.from(m.keys())[h[E]]):m=m[h[E]];for(var y=0,x=c.length;y<x;y++){let E=c[y].split("-")[1],A=document.createElement("ul"),w=document.createElement("code"),T=document.createElement("li"),g;if(T.className=c[y].split("-")[1]+"-diff",T.className==="red-diff"&&y<=S.length-1?y>m.length-1?g="":(y>S.length-1&&(T.className=="red-diff"?(T.className="blue-diff",T.setAttribute("aria-describedby","damonDiffBlue")):(T.className="green-diff",T.setAttribute("aria-describedby","damonDiffGreen"))),g=m[y]):(T.className==="green-diff"?(T.dataset.graphArbo=y,h.length>0&&(T.dataset.graphArbo=h.join("-")+"-"+y),T.className=""):(T.className="blue-diff",T.setAttribute("aria-describedby","damonDiffBlue")),g=S[y]),T.className==="red-diff"&&T.setAttribute("aria-describedby","damonDiffRed"),typeof g=="object"&&g!==null)if(Array.isArray(g))if(e.damonInlineArrays!==void 0&&e.damonInlineArrays.indexOf(y)>-1){w.innerHTML+="[";for(let s=0,O=g.length;s<O;s++){let C=document.createElement("span"),_=g[s];if(_===!0)C.textContent="true",C.className="type-boolean";else if(_===!1)C.textContent="false",C.className="type-boolean";else if(_===null)C.textContent="null",C.className="type-null";else if(Number.isFinite(_)&&!Number.isNaN(_))C.textContent=_+"",C.className="type-number";else{if(n)if(t.websiteRegex.test(_)){let k=_;t.httpRegex.test(_)||(k="https://"+_),C.innerHTML=M.sanitize(`<a href="${k}">"${k}"</a>`)}else C.innerHTML=`"${_}"`;else if(t.websiteRegex.test(_)){let k=_;t.httpRegex.test(_)||(k="https://"+_),C.innerHTML=M.sanitize(`<a href="${k}">"${k}"</a>`)}else C.textContent=`"${_}"`;C.className="type-string"}s!==0&&(w.innerHTML+=", ")}w.innerHTML+="]",T.appendChild(w),T.appendChild(A),f.appendChild(T)}else w.textContent="[]",T.appendChild(w),T.appendChild(A),f.appendChild(T),a(g,A,h.concat([y]),E);else w.textContent="{}",T.appendChild(w),T.appendChild(A),f.appendChild(T),a(g,A,h.concat([y]),E);else{let s=g;if(s===!0)w.textContent="true",w.className="type-boolean";else if(s===!1)w.textContent="false",w.className="type-boolean";else if(s===null)w.textContent="null",w.className="type-null";else if(Number.isFinite(s)&&!Number.isNaN(s))w.textContent=s+"",w.className="type-number";else{if(n)if(t.websiteRegex.test(s)){let O=s;t.httpRegex.test(s)||(O="https://"+s),w.innerHTML=M.sanitize(`<a href="${O}">"${O}"</a>`)}else w.innerHTML=`"${s}"`;else if(t.websiteRegex.test(s)){let O=s;t.httpRegex.test(s)||(O="https://"+s),w.innerHTML=M.sanitize(`<a href="${O}">"${O}"</a>`)}else w.textContent=`"${s}"`;w.className="type-string"}T.appendChild(w),T.appendChild(A),f.appendChild(T)}}}}else if(["red","yellow"].indexOf(b)>-1){let S=r;for(let m=0,E=h.length;m<E;m++)typeof S=="object"&&S!==null&&!Array.isArray(S)&&S instanceof Map&&S.constructor===Map?S=S.get(Array.from(S.keys())[h[m]]):S=S[h[m]];p(S,f,h,b)}}function p(c,f,h,b){if(typeof f!="object"||f==null||Array.isArray(f))throw new Error("Error List Item "+h.concat("-")+": @param { {} } list");if(typeof c=="object"&&c!==null&&!Array.isArray(c)&&c instanceof Map&&c.constructor===Map){if(f.tagName=="UL"){let S=0;for(let[m,E]of c){let A=document.createElement("ul"),w=document.createElement("code"),T=document.createElement("span"),g=document.createElement("li");if(T.className="type-key",g.className="red-diff",g.setAttribute("aria-describedby","damonDiffRed"),t.websiteRegex.test(m)){let s=m;t.httpRegex.test(m)||(s="https://"+m);let O=M.sanitize(`<a href="${s}">${s}</a>`);T.innerHTML=O}else T.textContent=m;if(typeof E=="object"&&E!==null)if(Array.isArray(E))if(c.damonInlineArrays!==void 0&&c.damonInlineArrays.indexOf(m)>-1){w.innerHTML=T.outerHTML+": [";for(let s=0,O=E.length;s<O;s++){let C=document.createElement("span"),_=E[s];if(_===!0)C.textContent="true",C.className="type-boolean";else if(_===!1)C.textContent="false",C.className="type-boolean";else if(_===null)C.textContent="null",C.className="type-null";else if(Number.isFinite(_)&&!Number.isNaN(_))C.textContent=_+"",C.className="type-number";else{if(n)if(t.websiteRegex.test(_)){let k=_;t.httpRegex.test(_)||(k="https://"+_),C.innerHTML=M.sanitize(`<a href="${k}">"${k}"</a>`)}else C.innerHTML=`"${_}"`;else if(t.websiteRegex.test(_)){let k=_;t.httpRegex.test(_)||(k="https://"+_),C.innerHTML=M.sanitize(`<a href="${k}">"${k}"</a>`)}else C.textContent=`"${_}"`;C.className="type-string"}s!==0&&(w.innerHTML+=", "),w.appendChild(C)}w.innerHTML+="]",g.appendChild(w),g.appendChild(A),f.appendChild(g)}else w.innerHTML=T.outerHTML+": []",g.appendChild(w),g.appendChild(A),f.appendChild(g),p(E,A,h.concat([S]),b);else c.implicitMaps!==void 0&&c.implicitMaps.indexOf(m)>-1?w.innerHTML=T.outerHTML:w.innerHTML=T.outerHTML+": {}",g.appendChild(w),g.appendChild(A),f.appendChild(g),p(E,A,h.concat([S]),b);else{w.innerHTML=T.outerHTML+": ";let s=document.createElement("span"),O=E;if(O===!0)s.textContent="true",s.className="type-boolean";else if(O===!1)s.textContent="false",s.className="type-boolean";else if(O===null)s.textContent="null",s.className="type-null";else if(Number.isFinite(O)&&!Number.isNaN(O))s.textContent=O+"",s.className="type-number";else{if(n)if(t.websiteRegex.test(O)){let C=O;t.httpRegex.test(O)||(C="https://"+O),s.innerHTML=M.sanitize(`<a href="${C}">"${C}"</a>`)}else s.innerHTML=`"${O}"`;else if(t.websiteRegex.test(O)){let C=O;t.httpRegex.test(O)||(C="https://"+O),s.innerHTML=M.sanitize(`<a href="${C}">"${C}"</a>`)}else s.textContent=`"${O}"`;s.className="type-string"}c.implicitNulls===void 0||c.implicitNulls.indexOf(m)==-1?w.appendChild(s):w.innerHTML=w.innerHTML.slice(0,-2),g.appendChild(w),f.appendChild(g)}S++}}}else if(Array.isArray(c))for(var y=0,x=c.length;y<x;y++){let S=document.createElement("ul"),m=document.createElement("code"),E=document.createElement("li");if(E.className=c[y]+"-diff",E.setAttribute("aria-describedby","damonDiffRed"),typeof c[y]=="object"&&c[y]!==null)if(Array.isArray(c[y]))if(c.damonInlineArrays!==void 0&&c.damonInlineArrays.indexOf(y)>-1){m.innerHTML+="[";for(let A=0,w=c[y].length;A<w;A++){let T=document.createElement("span"),g=c[y][A];if(g===!0)T.textContent="true",T.className="type-boolean";else if(g===!1)T.textContent="false",T.className="type-boolean";else if(g===null)T.textContent="null",T.className="type-null";else if(Number.isFinite(g)&&!Number.isNaN(g))T.textContent=g+"",T.className="type-number";else{if(n)if(t.websiteRegex.test(g)){let s=g;t.httpRegex.test(g)||(s="https://"+g),T.innerHTML=M.sanitize(`<a href="${s}">"${s}"</a>`)}else T.innerHTML=`"${g}"`;else if(t.websiteRegex.test(g)){let s=g;t.httpRegex.test(g)||(s="https://"+g),T.innerHTML=M.sanitize(`<a href="${s}">"${s}"</a>`)}else T.textContent=`"${g}"`;T.className="type-string"}A!==0&&(m.innerHTML+=", "),m.appendChild(T)}m.innerHTML+="]",E.appendChild(m),E.appendChild(S),f.appendChild(E)}else m.textContent="[]",E.appendChild(m),E.appendChild(S),f.appendChild(E),p(c[y],S,h.concat([y]),b);else m.textContent="{}",E.appendChild(m),E.appendChild(S),f.appendChild(E),p(c[y],S,h.concat([y]),b);else{let A=c[y];if(A===!0)m.textContent="true",m.className="type-boolean";else if(A===!1)m.textContent="false",m.className="type-boolean";else if(A===null)m.textContent="null",m.className="type-null";else if(Number.isFinite(A)&&!Number.isNaN(A))m.textContent=A+"",m.className="type-number";else{if(n)if(t.websiteRegex.test(A)){let w=A;t.httpRegex.test(A)||(w="https://"+A),m.innerHTML=M.sanitize(`<a href="${w}">"${w}"</a>`)}else m.innerHTML=`"${A}"`;else if(t.websiteRegex.test(A)){let w=A;t.httpRegex.test(A)||(w="https://"+A),m.innerHTML=M.sanitize(`<a href="${w}">"${w}"</a>`)}else m.textContent=`"${A}"`;m.className="type-string"}E.appendChild(m),E.appendChild(S),f.appendChild(E)}}}}damonTableToCSV(e){let n=this.damon.damonToMap(e),t="",l=0;for(let[o,u]of n){if(l===0&&o==="00"){t+='"'+u+`"
`,l++;continue}let d=Array.from(u.keys());for(let a=0,p=d.length;a<p;a++)t+='"'+d[a]+'"',a!=p-1&&(t+=",");t+=`
`,l++}return t.slice(0,-1)}damonTableToJSON(e){let n=this.damon.damonToMap(e),t=`[
`,l=0;for(let[o,u]of n){if(t+="    [",l===0&&o==="00"){t+=JSON.stringify(u)+`],
`,l++;continue}let d=Array.from(u.keys());for(let a=0,p=d.length;a<p;a++)t+=JSON.stringify(d[a]),a!=p-1&&(t+=", ");t+=`],
`,l++}return t=t.slice(0,-2)+`
]`,t}csvToDamonTable(e){let r=this,n=e.split(`
`),t=new Map;for(let l=0,o=n.length;l<o;l++){let u=new Map;u.implicitNulls=[],t.set(l+"",u);let d=n[l].split(",");for(let a=0,p=d.length;a<p;a++)if(d[a][0]==='"'&&d[a][d[a].length-1]==='"')try{t.get(l+"").set(JSON.parse(d[a]),null),t.get(l+"").implicitNulls.push(d[a])}catch{t.get(l+"").set(JSON.parse(JSON.stringify(d[a].slice(1,-1))),null),t.get(l+"").implicitNulls.push(JSON.parse(JSON.stringify(d[a].slice(1,-1))))}else try{t.get(l+"").set(JSON.parse(`"${d[a]}"`),null),t.get(l+"").implicitNulls.push(`"${d[a]}"`)}catch{t.get(l+"").set(JSON.parse(JSON.stringify(d[a])),null),t.get(l+"").implicitNulls.push(JSON.stringify(d[a]))}}return r.damon.mapToDamon(t)}jsonToDamonTable(e){let r=this,n=JSON.parse(e).map(l=>JSON.stringify(l)),t=new Map;for(let l=0,o=n.length;l<o;l++){let u=new Map;u.implicitNulls=[],t.set(l+"",u);let d=JSON.parse(n[l]);for(let a=0,p=d.length;a<p;a++)t.get(l+"").set(d[a],null),t.get(l+"").implicitNulls.push(d[a])}return r.damon.mapToDamon(t)}wrapListContentsForStyling(e){let r=this;for(let n=0,t=e.length;n<t;n++){let l=document.createElement("div");for(let o=e[n].childNodes.length-1;o>=0;o--)(e[n].childNodes[o].tagName&&e[n].childNodes[o].tagName!=="UL"||e[n].childNodes[o].nodeType==3&&e[n].childNodes[o].data!=`
`&&e[n].childNodes[o].data!=`\r
`)&&(l.childNodes.length==0?l.appendChild(e[n].childNodes[o]):l.insertBefore(e[n].childNodes[o],l.childNodes[0]));e[n].firstElementChild?e[n].insertBefore(l,e[n].firstElementChild):e[n].appendChild(l)}}addLineNumbers(e,r,n=0){let t=this,l=r.querySelectorAll("li[data-graph-arbo]");for(let o=0,u=l.length;o<u;o++){let d=document.createElement("div");d.className="damon-line-number";let a=t.damon.damonToMap(e),p=l[o].dataset.graphArbo.split("-"),c=[];for(let f=0,h=p.length;f<h;f++)typeof a=="object"&&a!==null&&!Array.isArray(a)&&a instanceof Map&&a.constructor===Map?(c.push(Array.from(a.keys())[p[f]]),a=c[c.length-1]):(c.push(parseInt(p[f])),a=a.get(a[p[f]]));d.textContent=t.damon.getRangeFromPath(e,c)[0][0]+1+n,d.id="damonLine"+d.textContent,l[o].setAttribute("aria-labelledBy",d.id),d.style.left="7px",d.style.top=r.scrollTop+l[o].firstElementChild.getBoundingClientRect().top-r.getBoundingClientRect().top+"px",r.appendChild(d)}}damonGraphToMermaid(e,r=0){let t=this.damon.damonToMap(e),l="";if(typeof t!="object"||t===null||Array.isArray(t)||!(t instanceof Map)||t.constructor!==Map)throw new Error("Error: input does not conform to Map type");let o=0;for(let[u,d]of t){if(o++,typeof d!="object"||d===null||Array.isArray(d)||!(d instanceof Map)||d.constructor!==Map)throw new Error("Error line "+e.mapIndexToLine(t,o)+r+": value does not conform to Map type");l+=u;for(let[a,p]of d){if(o++,typeof p!="string")throw new Error("Error line "+e.mapIndexToLine(t,o)+r+": value does not conform to String type");let c=p.split(",");for(let f=0,h=c.length;f<h;f++)f==0?a.length?l+=" -- "+a+" --> "+c[f]+`\r
`:l+=" --> "+c[f]+`\r
`:a.length?l+=u+" -- "+a+" --> "+c[f]+`\r
`:l+=u+" --> "+c[f]+`\r
`}}return l.slice(0,-2)}}});var Br=oe((jn,Fr)=>{var Zn=on(at());Fr.exports=function(i){i.update(),i.historyUpdate(),window.addEventListener("load",e),i.editor.addEventListener("focusin",r),i.editor.addEventListener("focusout",n),i.gutter.addEventListener("click",t),document.addEventListener("mousedown",o),document.addEventListener("mousemove",u),document.addEventListener("mouseup",d),document.addEventListener("selectionchange",a),i.textarea.addEventListener("beforeinput",p),i.textarea.addEventListener("keydown",c),i.textarea.addEventListener("cut",f),i.textarea.addEventListener("copy",h),i.textarea.addEventListener("paste",b);function e(m){i.overlay.firstElementChild.innerHTML="",i.gutter.innerHTML="",i.update(),i.updateCurrentLine(),i.initialized=!0}function r(m){i.utils.addDataState(i.editor,"focused")}function n(m){i.editor.contains(m.target)||i.utils.removeDataState(i.editor,"focused")}function t(m){(Array.from(i.gutter.children).indexOf(m.target)>-1||Array.from(i.gutter.children).indexOf(m.target.parentNode)>-1)&&i.setCarretAt(parseInt(m.target.textContent.trim())-1)}var l;function o(m){if(m.target==i.container){l=m.target,m.preventDefault();let E=i.gutter.children,A="0";for(let w=0,T=E.length;w<T;w++)m.clientY>E[w].getBoundingClientRect().y&&(A=E[w].textContent.trim());A-1<0&&(A=1),i.setCarretAt(A-1),i.textarea.focus()}}function u(m){if(l==i.container&&m.buttons==1){let E=i.gutter.children,A="0";for(let w=0,T=E.length;w<T;w++)m.clientY>E[w].getBoundingClientRect().y&&(A=E[w].textContent.trim());i.textarea.focus(),i.textarea.setSelectionRange(i.textarea.value.split(`
`).slice(0,A).join().length,i.textarea.value.length,"backward")}}function d(m){l==i.container&&m.target==i.textarea&&(i.textarea.selectionEnd=i.textarea.value.length,i.textarea.selectionStart=i.textarea.value.length,i.textarea.focus()),l=void 0}function a(m){document.activeElement===i.textarea&&(i.updateCaret(),i.updateCurrentLine(),i.updateHorizontalScroll(),i.lastSelection=i.getTextareaSelection())}function p(m){i.lastTextareaValue=i.textarea.value}function c(m){if(!m.ctrlKey&&!m.shiftKey&&!m.altKey){if(m.key==" "&&i.textarea.selectionStart==i.textarea.selectionEnd&&(!/\n/.test(i.textarea.value.slice(0,i.textarea.selectionStart))&&(/ +$/.test(i.textarea.value.slice(0,i.textarea.selectionStart))||i.textarea.selectionStart===0)||/\n +$/.test(i.textarea.value.slice(0,i.textarea.selectionStart))||i.textarea.selectionStart<i.textarea.value.length&&(/\n +\n$/.test(i.textarea.value.slice(0,i.textarea.selectionStart+1))||/\n$/.test(i.textarea.value.slice(0,i.textarea.selectionStart)))||i.textarea.value.length==i.textarea.selectionStart&&(/\n +$/.test(i.textarea.value)||/\n$/.test(i.textarea.value)))){m.preventDefault();let E=i.textarea.selectionStart+4,A=i.textarea.value.slice(0,i.textarea.selectionStart)+"    "+i.textarea.value.slice(i.textarea.selectionEnd);i.setTextarea(A,E),y()}if(m.key=="Enter"){let E=i.textarea.value,A=E.split(`
`),w=i.getSelectionStartCoordinates(),T=w[0],g=w[1],s=A[T];if(/^    /.test(s)){if(m.preventDefault(),g%4!==0&&g<s.match(/^(    )+/)[0].length){for(let P=g;0<=P;P--)if(P%4==0){i.textarea.selectionStart==i.textarea.selectionEnd&&(i.textarea.selectionEnd=A.slice(0,T).join().length+P),i.textarea.selectionStart=A.slice(0,T).join().length+P,g=P;break}}let O=0;g>0&&(O=s.slice(0,g).match(/^(    )+/)[0].length);let C=i.textarea.selectionStart,_=i.textarea.value.slice(i.textarea.selectionEnd);_.split(`
`)[0].trim()==""&&(_=`
`+_.split(`
`).slice(1).join(`
`));let k=i.textarea.value.slice(0,i.textarea.selectionStart)+`
`+" ".repeat(O)+_;i.setTextarea(k,C+O+1),y()}}}else if(!m.ctrlKey&&m.shiftKey&&!m.altKey)m.key==" "&&i.textarea.selectionStart==i.textarea.selectionEnd;else if(m.ctrlKey&&!m.shiftKey&&!m.altKey){if(m.key=="Backspace"){let E=i.textarea.value.split(`
`),A=i.getSelectionStartCoordinates(),w=E[A[0]],T=w.slice(0,A[1]);if(i.textarea.selectionEnd==i.textarea.selectionStart&&/^ +$/.test(T)){m.preventDefault();let g=0;T.length%4==0?(E[A[0]]=w.slice(4),g=4):(E[A[0]]=w.slice(T.length%4),g=T.length%4),i.setTextarea(E.join(`
`)),y(),i.setCarretAt(A[0],A[1]-g)}}if(m.key==" "){let E=i.textarea.value.slice(0,i.textarea.selectionStart)+"	"+i.textarea.value.slice(i.textarea.selectionEnd);i.setTextarea(i.formatIndentation(E),i.textarea.selectionEnd+1),y()}if(m.key=="]"){m.preventDefault();let E=i.textarea.value.split(`
`),A=i.textarea.value.slice(0,i.textarea.selectionStart).split(`
`).length-1,w=i.textarea.value.slice(0,i.textarea.selectionEnd).split(`
`).length-1,T=i.textarea.selectionStart+4,g=i.textarea.selectionEnd+4*(w-A+1);for(let s=0,O=E.length;s<O;s++)s>=A&&s<=w&&(E[s]="    "+E[s]);i.setTextarea(E.join(`
`),T,g),y()}if(m.key=="["){let E=i.textarea.value,A=i.textarea.value.split(`
`),w=i.textarea.value.slice(0,i.textarea.selectionStart).split(`
`).length-1,T=i.textarea.value.slice(0,i.textarea.selectionEnd).split(`
`).length-1,g=i.textarea.selectionStart,s=i.textarea.selectionEnd;for(let O=0,C=A.length;O<C;O++)O>=w&&O<=T&&A[O].startsWith("    ")&&(O==w&&(g-=4),s-=4,A[O]=A[O].slice(4));i.setTextarea(A.join(`
`),g,s),y()}if(m.key=="Enter"){let E=i.textarea.value.split(`
`),A=i.getCurrentLine();A==E.length-1?i.setTextarea(E.join(`
`)+`
`):i.setTextarea(E.slice(0,A+1).join(`
`)+`

`+E.slice(A+1).join(`
`)),y(),i.setCarretAt(A+1)}if(m.key=="z"&&(m.preventDefault(),i.historyPosition>1)){i.historyPosition-=1;let E=i.history[i.historyPosition-1];i.setTextarea(E[0],E[1]),i.update(),i.virtualScroller.inputHandler(!0),i.textarea.blur(),i.textarea.focus()}if(m.key=="y"&&(m.preventDefault(),i.historyPosition<i.history.length)){i.historyPosition+=1;let E=i.history[i.historyPosition-1];i.setTextarea(E[0],E[1]),i.update(),i.virtualScroller.inputHandler(!0),i.textarea.blur(),i.textarea.focus()}}else if(!m.ctrlKey&&m.shiftKey&&m.altKey)m.key=="f"&&i.setTextarea(i.formatIndentation(i.textarea.value),i.textarea.selectionEnd);else if(!m.ctrlKey&&!m.shiftKey&&m.altKey){if(m.key=="ArrowDown")if(i.getSelectionStartCoordinates()[0]==i.getSelectionEndCoordinates()[0]){let E=i.textarea.value.split(`
`),A=i.getCurrentLine(),w=E[i.getCurrentLine()].slice();if(i.getCurrentLine()!==E.length){let T=E[i.getCurrentLine()+1].slice();E[i.getCurrentLine()]=T,E[i.getCurrentLine()+1]=w,i.setTextarea(E.join(`
`)),y(),i.setCarretAt(A+1)}}else{let E=i.textarea.value.split(`
`),A=i.getSelectionStartCoordinates()[0],w=i.getSelectionEndCoordinates()[0];if(w<A&&(A=i.getSelectionEndCoordinates()[0],w=i.getSelectionStartCoordinates()[0]),w!=E.length){let T=E.slice(A,w+1),g=E[w+1].slice();E[A]=g;for(let s=A,O=s+T.length;s<O;s++)E[s+1]=T[s-A];w<A?i.setTextarea(E.join(`
`),i.textarea.selectionEnd+g.length+1,i.textarea.selectionStart+g.length+1):i.setTextarea(E.join(`
`),i.textarea.selectionStart+g.length+1,i.textarea.selectionEnd+g.length+1),y()}}else if(m.key=="ArrowUp")if(i.getSelectionStartCoordinates()[0]==i.getSelectionEndCoordinates()[0]){let E=i.textarea.value.split(`
`),A=i.getCurrentLine(),w=E[i.getCurrentLine()].slice();if(i.getCurrentLine()!==0){let T=E[i.getCurrentLine()-1].slice();E[i.getCurrentLine()]=T,E[i.getCurrentLine()-1]=w,i.setTextarea(E.join(`
`)),y(),i.setCarretAt(A-1)}}else{let E=i.textarea.value.split(`
`),A=i.getSelectionStartCoordinates()[0],w=i.getSelectionEndCoordinates()[0];if(w<A&&(A=i.getSelectionEndCoordinates()[0],w=i.getSelectionStartCoordinates()[0]),A!=0){let T=E.slice(A,w+1),g=E[A-1].slice();E[w]=g;for(let s=A,O=s+T.length;s<O;s++)E[s-1]=T[s-A];w<A?i.setTextarea(E.join(`
`),i.textarea.selectionEnd-g.length-1,i.textarea.selectionStart-g.length-1):i.setTextarea(E.join(`
`),i.textarea.selectionStart-g.length-1,i.textarea.selectionEnd-g.length-1),y()}}}i.debounceLint()}function f(m){if(i.textarea.selectionStart==i.textarea.selectionEnd){m.preventDefault();let E=i.textarea.value.split(`
`),A=i.getCurrentLine(),w=E.slice(0,A).join(`
`).length,T=w+E[A].length+1;i.textarea.setSelectionRange(w,T),i.lastTextareaValue=i.textarea.value,document.execCommand("cut"),i.updateCaret()}}function h(m){if(i.textarea.selectionStart==i.textarea.selectionEnd){m.preventDefault();let E=i.textarea.value.split(`
`),A=i.getCurrentLine(),w=E.slice(0,A).join(`
`).length,T=w+E[A].length+1;i.textarea.setSelectionRange(w,T),document.execCommand("copy")}}function b(m){m.preventDefault();let E=m.clipboardData.getData("text").replace(new RegExp(/\r/g),""),A=i.textarea.value.slice(0,i.textarea.selectionStart),w=i.textarea.value.slice(i.textarea.selectionEnd),T=A+E+w,g=i.textarea.selectionStart+E.length;if(A+w==""||i.textarea.selectionStart==0&&i.textarea.selectionEnd==T.length-1)try{JSON.parse(T),Array.isArray(T)&&T.map(I=>Array.isArray(T)).indexOf(!1)==-1&&T.map(I=>I.map(D=>!Array.isArray(D)&&(typeof I!="object"||I==null)).indexOf(!1)==-1).indexOf(!1)==-1?i.setTextarea(i.damonUtils.jsonToDamonTable(T)):i.setTextarea(i.damon.jsonToDamon(T)),y(),i.updateCaret(),i.debounceLint();return}catch{try{i.damon.damonToMap(T)}catch{let $=T,U=/\r\n/.test($)?`\r
`:`
`,F=$.split(U);if(U==`
`&&/\\*\n/.test($)){if(/[^\\]\\(\\\\)*\n/.test($)){let J=$.split(/[^\\]\\(\\\\)*\n/)[0].split(`
`).length,Le=new Error("Error line "+J+": oddly escaped newline");console.log(Le)}F=$.split("").reverse().join("").split(/\n/).map(J=>J.split("").reverse().join("")).reverse()}try{i.setTextarea(i.damonUtils.csvToDamonTable(T)),y(),i.updateCaret(),i.debounceLint();return}catch(z){console.log(z)}}}let s=T.split(`
`),O=g,C=0,_=0;for(let I=0,D=s.length;I<D;I++)if(C+s[I].length+I<O)C+=s[I].length;else{C+=I,_=I;break}let k=[_,g-C],P=s[_].slice(0);if(T=i.formatIndentation(T),s=T.split(`
`),i.textarea.value!==T){let I=s.slice(0,_+1).join(`
`).length-P.length+k[1];i.setTextarea(T,I),y()}i.updateCaret(),i.debounceLint()}i.textarea.addEventListener("input",y),i.editor.addEventListener("scroll",x);function y(){document.activeElement==i.textarea&&(i.update(),i.debounceHistoryUpdate(),i.updateCurrentLine(),i.updateHorizontalScroll(),i.updateCaret(),i.debounceLint())}function x(m){i.virtualScroller.scrollHandler()}window.spaceResizeTimeout=null;function S(m){spaceResizeTimeout&&clearTimeout(spaceResizeTimeout),window.spaceResizeTimeout=setTimeout(function(){let E=i.editor.scrollTop;i.gutter.innerHTML="",i.overlay.firstElementChild.innerHTML="",i.initialized=!1,i.virtualScroller.inputHandler(),i.initialized=!0,i.editor.scrollTop=E},100)}}});var zr=oe((ti,Jr)=>{var ht=Ut(),Mn=Nr(),Pn=at(),Un=Ur();Jr.exports=class{constructor(e,r,n){let t=this;t.dom=e,t.innerHTML="",t.editor={},t.gutter={},t.container={},t.overlay={},t.textarea={},t.caretPadding={},t.caret={},t.statusBar={},t.copyButton={},t.diffButton={},t.prism=r,t.indentation="    ",t.currentLine=0,t.history=[],t.historyPosition=0,t.historyUpdateTimeoutId,t.lintTimeoutId,t.lastTextareaValue="",t.lastSelection="",t.initialized=!1,t.virtualScroller={},t.damon=new Mn,t.damonUtils=new Un(t.damon),t.utils=ht}init(){let e=this;e.statusBarHTML=ht.html`
<div>
    Spaces: <a href="https://github.com/adrianturcev/space/blob/master/bindings.md"><kbd>SPACE</kbd></a>
</div>
<a href="https://github.com/adrianturcev/damon/blob/master/language_reference.md">
    DAMON
    <svg
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg">
        <title>help-circle</title>
        <circle
            style="fill:#FEFEFE;stroke-width:1.04312;fill-opacity:1"
            cx="12"
            cy="12"
            r="9.6854191" />
        <path
            fill="#FEFEFE"
            d="M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"
            style="fill:#4169e1;fill-opacity:1" />
    </svg>
</a>
<button class="space-copyButton">
    JSON
    <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg">
        <title>content-copy</title>
        <path
            fill="#FEFEFE"
            d="M 4,21 H 15 V 7 H 4 M 4,5 h 11 a -2,2 0 0 1 2,2 v 14 a -2,2 0 0 1 -2,2 H 4 A -2,2 0 0 1 2,21 V 7 A -2,2 0 0 1 4,5 M 7,1 h 12 a -2,2 0 0 1 2,2 V 17 H 19 V 3 H 7 Z"/>
    </svg>
</button>
<button class="space-diffButton">
    Diff
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <title>set-left-right</title>
        <path
            fill="#FEFEFE"
            d="M9,5C10.04,5 11.06,5.24 12,5.68C12.94,5.24 13.96,5 15,5A7,7 0 0,1 22,12A7,7 0 0,1 15,19C13.96,19 12.94,18.76 12,18.32C11.06,18.76 10.04,19 9,19A7,7 0 0,1 2,12A7,7 0 0,1 9,5M9,12C9,14.22 10.21,16.16 12,17.2C13.79,16.16 15,14.22 15,12C15,9.78 13.79,7.84 12,6.8C10.21,7.84 9,9.78 9,12Z" />
    </svg>
</button>`,e.innerHTML=ht.html`
<div class="space-editor" data-state="js-off">
    <div class="space-gutter"></div>
    <div class="space-container">
<pre class="space-dummyTextarea"><span class="space-caretPadding"></span><span class="space-caret">&nbsp;</span></pre>
        <pre class="space-overlay" aria-hidden="true" tabindex="-1">
            <code class="language-damon"></code>
        </pre>
        <textarea
            class="space-textarea"
            placeholder="Paste JSON/CSV or write DAMON"
            spellcheck="false"
            aria-labelledby=""
            aria-controls="space-statusBar0"
            maxlength="500000">
        </textarea>
        <ul class="space-suggestions"></ul>
    </div>
</div>
<div class="space-statusBar" id="space-statusBar0" role="log" aria-live="polite">${e.statusBarHTML}</div>
        `;let r="";e.dom.innerHTML!==e.innerHTML&&(e.dom.getElementsByTagName("textarea")[0]!==void 0&&(r=e.dom.getElementsByTagName("textarea")[0].innerHTML),e.dom.innerHTML=e.innerHTML),e.editor=e.dom.getElementsByClassName("space-editor")[0],e.gutter=e.dom.getElementsByClassName("space-gutter")[0],e.container=e.dom.getElementsByClassName("space-container")[0],e.overlay=e.dom.getElementsByClassName("space-overlay")[0],e.textarea=e.dom.getElementsByClassName("space-textarea")[0],e.textarea.innerHTML=r,e.caretPadding=e.dom.getElementsByClassName("space-caretPadding")[0],e.caret=e.dom.getElementsByClassName("space-caret")[0],e.statusBar=e.dom.getElementsByClassName("space-statusBar")[0],e.copyButton=e.dom.getElementsByClassName("space-copyButton")[0],e.diffButton=e.dom.getElementsByClassName("space-copyButton")[0],e.virtualScroller=new Pn(this),e.editor.dataset.state="",e.textarea.value=e.formatIndentation(e.textarea.value.replaceAll(/\r/g,"")),e.routes=Br()(this),e.lint()}update(){let e=this;e.initialized&&e.lastTextareaValue==e.textarea.value||(e.gutter.children.length==0?e.virtualScroller.init(0):e.virtualScroller.inputHandler(),e.initialized&&(e.lastTextareaValue=e.textarea.value))}updateHorizontalScroll(){let e=this;if(document.activeElement==e.textarea){let r=e.textarea.value.split(`
`),n=0,t=e.gutter.children[0].children[0].getBoundingClientRect().width;for(let l=0,o=r.length;l<o&&n+r[l].length<e.textarea.selectionEnd;l++)n+=r[l].length+1;(e.textarea.selectionEnd-n)*t-e.gutter.clientWidth<=e.editor.scrollLeft&&(e.editor.scrollLeft=0)}}getCurrentLine(){let e=this,r=e.textarea.value.split(`
`),n=0,t=0,l=0;(e.textarea.selectionDirection=="forward"||e.textarea.selectionStart==e.textarea.selectionEnd)&&(n=e.textarea.selectionEnd),e.textarea.selectionDirection=="backward"&&(n=e.textarea.selectionStart);for(let o=0,u=r.length;o<u;o++)if(t+r[o].length+o<n)t+=r[o].length;else{l=o;break}return l}getSelectionStartCoordinates(){let e=this,r=e.textarea.value.split(`
`),n=e.textarea.selectionStart,t=0,l=0;for(let o=0,u=r.length;o<u;o++)if(t+r[o].length+o<n)t+=r[o].length;else{t+=o,l=o;break}return[l,e.textarea.selectionStart-t]}getSelectionEndCoordinates(){let e=this,r=e.textarea.value.split(`
`),n=e.textarea.selectionEnd,t=0,l=0;for(let o=0,u=r.length;o<u;o++)if(t+r[o].length+o<n)t+=r[o].length;else{t+=o,l=o;break}return[l,e.textarea.selectionEnd-t]}setCarretAt(e,r){let n=this;if(r==null&&(r=n.textarea.value.split(`
`)[e].length),e==0)n.textarea.selectionStart=r;else{let t=Math.min(r,n.textarea.value.split(`
`)[e].length);n.textarea.selectionStart=n.textarea.value.split(`
`).slice(0,e).reduce(function(l,o){return l+o}).length+e+r}n.textarea.selectionEnd=n.textarea.selectionStart,n.textarea.focus()}getTextareaSelection(){let e=this;return e.textarea.selectionStart<e.textarea.selectionEnd?e.textarea.value.slice(e.textarea.selectionStart,e.textarea.selectionEnd):e.textarea.selectionStart<e.textarea.selectionEnd?e.textarea.value.slice(e.textarea.selectionEnd,e.textarea.selectionStart):void 0}updateCurrentLine(e){let r=this,n=r.currentLine;if(r.currentLine=r.getCurrentLine(),n!=r.currentLine||!r.initialized||e||r.lastSelection!=null&&r.getTextareaSelection()==null){for(let l=0,o=r.gutter.children.length;l<o;l++)r.gutter.children[l].classList.remove("currentLine"),r.gutter.children[l].classList.remove("selectionEnd");r.gutter.children[r.currentLine-r.gutter.children[0].textContent.trim()+1]&&(r.textarea.selectionEnd==r.textarea.selectionStart?r.gutter.children[r.currentLine-r.gutter.children[0].textContent.trim()+1].classList.add("currentLine"):r.gutter.children[r.currentLine-r.gutter.children[0].textContent.trim()+1].classList.add("selectionEnd"))}}historyUpdate(){let e=this;if(e.history.length==0||e.textarea.value!=e.history[e.historyPosition-1][0]){let n=function(t,l){return t+l[0]+l[1]};var r=n;if(e.history.length==1){let t=e.textarea.selectionStart-(e.textarea.value.length-e.history[0][0].length);e.history[0][0].length>e.textarea.value.length&&(t=e.textarea.selectionStart-(e.history[0][0].length-e.textarea.value.length)),e.history.push([e.history[0][0],t]),e.historyPosition++}if(e.historyPosition!=e.history.length&&(e.history=e.history.slice(0,e.historyPosition)),e.history.push([e.textarea.value,e.textarea.selectionStart]),e.history.reduce(n,"").length*4>1e8){let t=0;for(;e.history.reduce(n,"").length*4>1e8;)t++,e.history.shift();e.historyPosition-=t}e.historyPosition++}}debounceHistoryUpdate(){var e=this,r=arguments;clearTimeout(this.historyUpdateTimeoutId),this.historyUpdateTimeoutId=setTimeout(function(){e.historyUpdateTimeoutId=null,e.historyUpdate.apply(e,r)},200)}formatIndentation(e){let r=this,n=e.split(`
`);for(let t=0,l=n.length;t<l;t++){if(/^ *(\t)+/.test(n[t])){let o=n[t].match(/^ *(\t)+/)[0].length;for(let u=0,d=o;u<d;u++)n[t]=n[t].replace("	","    ")}if(/^( )+/.test(n[t])&&n[t].match(/^( )+/)[0].length%4!==0){for(let o=n[t].match(/^( )+/)[0].length;0<=o;o--)if(o%4==0){n[t].trimStart(),n[t]=" ".repeat(o)+n[t];break}}}return n.join(`
`)}formatHyphens(e){let r=this,n=e.split(`
`);for(let t=0,l=n.length;t<l;t++)if(!/^ *- /.test(n[t])){let o="";/^ /.test(n[t])&&(o=n[t].match(/^( )+/)[0]),n[t]=o+"- "+n[t].slice(o.length)}return n.join(`
`)}updateCaret(){let e=this;e.textarea.selectionDirection=="forward"||e.textarea.selectionStart==e.textarea.selectionEnd?e.caretPadding.textContent=e.textarea.value.slice(0,e.textarea.selectionEnd):e.caretPadding.textContent=e.textarea.value.slice(0,e.textarea.selectionStart)}setTextarea(e,r,n=r){let t=this;t.lastTextareaValue=t.textarea.value,t.textarea.value=e,r!==null&&t.textarea.setSelectionRange(r,n)}lint(){let e=this;try{e.damon.damonToMap(e.textarea.value),e.statusBar.innerHTML=e.statusBarHTML}catch(r){r.language=="JSON"?e.statusBar.innerHTML="<span>( ! ) Error line number "+r.line+": "+r.type+" not JSON-compliant</span>"+e.statusBarHTML:e.statusBar.innerHTML="<span>( ! ) "+r.message+"</span>"+e.statusBarHTML,console.error(r)}e.copyButton=e.dom.getElementsByClassName("space-copyButton")[0],e.copyButton.addEventListener("click",function(r){let n=document.createElement("textarea");n.style.opacity="0";try{n.value=e.damon.damonToJSON(e.textarea.value)}catch{setTimeout(function(){e.copyButton.classList.remove("error")},1100),e.copyButton.classList.add("error");return}document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy")&&(setTimeout(function(){e.copyButton.classList.remove("success")},1100),e.copyButton.classList.add("success"))}catch(t){console.error(t.name,t.message)}document.body.removeChild(n)}),e.diffButton=e.dom.getElementsByClassName("space-diffButton")[0],e.diffButton.addEventListener("click",function(r){try{e.damon.damonToMap(e.textarea.value)}catch{alert("Invalid initial value.");return}e.diff(r)})}diff(e){let r=this;if(r.dom.getElementsByTagName("form").length||r.dom.getElementsByClassName("space-diff").length)return;let n=document.createElement("form"),t=document.createElement("div"),l=document.createElement("input"),o=document.createElement("label"),u=document.createElement("textarea"),d=document.createElement("button");l.type="checkbox",l.id="spaceDiffSortCheckbox",l.name="sort",o.textContent="Sort",o.setAttribute("for","spaceDiffSortCheckbox"),u.className="space-diffTextarea",n.style.position="absolute",u.placeholder="Paste DAMON or JSON.",d.textContent="Close",d.addEventListener("click",function(a){n.remove()}),t.appendChild(l),t.appendChild(o),n.appendChild(t),n.appendChild(u),n.appendChild(d),r.dom.appendChild(n),u.focus(),u.addEventListener("paste",function(a){let p=r.formatIndentation(a.clipboardData.getData("text").replace(new RegExp(/\r/g),"")),c="",f,h;try{f=r.damon.damonToMap(r.textarea.value)}catch{n.remove(),alert("Invalid initial value.");return}try{JSON.parse(p),h=r.damon.jsonToMap(p)}catch{try{h=r.damon.damonToMap(p)}catch{n.remove(),alert("Invalid clipboard value.");return}}l.checked&&(h=r.damonUtils.sortMap(f,h)),c=r.damonUtils.renderDiff(f,h);let b=document.createElement("div"),y=document.createElement("button");b.className="space-diff",b.innerHTML=c.innerHTML,y.textContent="Close",r.damonUtils.wrapListContentsForStyling(b.getElementsByTagName("li")),b.appendChild(y),r.dom.append(b),y.addEventListener("click",function(x){b.remove()}),r.damonUtils.addLineNumbers(r.textarea.value,b),n.remove()})}debounceLint(){var e=this,r=arguments;clearTimeout(this.lintTimeoutId),this.lintTimeoutId=setTimeout(function(){e.lintTimeoutId=null,e.lint.apply(e,r)},200)}}});(function(){window.Space=zr()})();})();
/*! Bundled license information:

dompurify/dist/purify.cjs.js:
  (*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE *)
*/
